# Narrative Simulator - í”„ë¡œì íŠ¸ ê°€ì´ë“œ

## í˜„ì¬ ì§„í–‰ í˜„í™© (2026-02-26)

### ì‚¬ìš©ì ì—­í•  ì •ì˜
**PD (Producer/Director)**: ì „ì²´ì ì¸ ì†Œì„¤ì˜ ì§‘í•„ê³¼ ì„¸ê³„ê´€, ë°°ê²½, ë“±ì¥ì¸ë¬¼, ìƒí™©, ì—í”¼ì†Œë“œ ì „ì²´ë¶€ë¶„ì˜ ë””í…Œì¼í•œ ë””ë ‰íŒ…

### ì™„ë£Œëœ ì‘ì—…
1. âœ… **ì—”í„°í‚¤ ì´ìŠˆ ìˆ˜ì •** - í•œêµ­ì–´ IME ì…ë ¥ ì‹œ onKeyUp ì‚¬ìš©
2. âœ… **íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥** - JSON/TXT íŒŒì¼ë¡œ ë ˆì´ì–´ ë°ì´í„° ì ìš©/ì°¸ì¡°
3. âœ… **ì„¸ê³„ê´€ ë””í…Œì¼ í•„ë“œ í™•ì¥** - RegionDetail, ClimateInfo, EnvironmentInfo, SensoryPalette íƒ€ì… ì¶”ê°€
4. âœ… **ìºë¦­í„° ì¶”ê°€ ê¸°ëŠ¥** - ì‚¬ì´ë“œ íŒ¨ë„ì—ì„œ ì‹ ê·œ ìºë¦­í„° ì¶”ê°€ ëª¨ë‹¬
5. âœ… **ì‹œë®¬ë ˆì´ì…˜ NPC ìŠ¹ê²©** - ë¹„ì¤‘ ë†’ì€ NPCë¥¼ ì£¼ìš” ìºë¦­í„°ë¡œ ìŠ¹ê²©
6. âœ… **API í”„ë¡¬í”„íŠ¸ ì—…ë°ì´íŠ¸** - write-episodeì— ì„¸ê³„ê´€/ìºë¦­í„° ì„¸ë¶€ í•„ë“œ ë°˜ì˜
7. âœ… **ì‚¬ì´ë“œ íŒ¨ë„ ì„¸ê³„ê´€ íƒ­ í™•ì¥** - RegionDetail, ClimateInfo ë“± í‘œì‹œ UI
8. âœ… **ì—í”¼ì†Œë“œ ë ˆë²¨ ë””ë ‰íŒ… ì‹œìŠ¤í…œ** - PD ë””ë ‰íŒ… ê¸°ëŠ¥ ì™„ë£Œ
9. âœ… **ì„¸ê³„ ì—­ì‚¬ íƒ€ì„ë¼ì¸ í¸ì§‘** - ì‹œëŒ€/10ë…„ ë‹¨ìœ„ ì—­ì‚¬ í¸ì§‘ ê¸°ëŠ¥
10. âœ… **ëª¨ë°”ì¼ íŒŒì¼ ì—…ë¡œë“œ í˜¸í™˜ì„±** - TXT/JSON ëª¨ë°”ì¼ ì—…ë¡œë“œ ê°œì„ 
11. âœ… **ë‹¤ì¤‘ ì‘ê°€ AI ì‹œìŠ¤í…œ** - ì¥ë¥´/í†¤/ë¶„ìœ„ê¸° ì¡°í•© + 6ë‹¨ê³„ ì§‘í•„ + 3ì¸ ê²€í†  ì‹œìŠ¤í…œ
12. âœ… **ì´ì›í™” ì‹œë®¬ë ˆì´ì…˜ ì‹œìŠ¤í…œ** - ì„¸ê³„ ì—­ì‚¬(A) + ì£¼ì¸ê³µ ì‹œì (B) ë¶„ë¦¬ ì‹œë®¬ë ˆì´ì…˜
13. âœ… **ì´ì›í™” ì‹œë®¬ë ˆì´ì…˜ UI ë²„íŠ¼ ì—°ê²°** - ì—­ì‚¬A/ì£¼ì¸ê³µB íƒ­ ë²„íŠ¼ì— API í˜¸ì¶œ ì—°ê²°
14. âœ… **ì„¤ì • ëª¨ìˆœ ìˆ˜ì • ìš”ì²­ ê¸°ëŠ¥** - íŒ©íŠ¸ì²´í¬ ëª¨ìˆœ ë°œê²¬ ì‹œ ìë™ ìˆ˜ì • ë° ë¹„êµ UI
15. âœ… **ì§‘í•„ í”„ë¡¬í”„íŠ¸ 4-Tier ì•„í‚¤í…ì²˜ ë¦¬íŒ©í† ë§** - LLM ê·œì¹™ ì¤€ìˆ˜ìœ¨ í–¥ìƒ + ë™ì  ì œì•½ ìƒì„±
16. âœ… **Direction ë¯¸ë°˜ì˜ ë²„ê·¸ ìˆ˜ì •** - author-chat ë ˆì´ì–´ ìƒì„± ì‹œ ì´ˆê¸° ì•„ì´ë””ì–´ ë°˜ì˜ ê°•í™” + write-episodeì— projectDirection ì¶”ê°€
17. âœ… **Supabase author_config ë°©ì–´ ì½”ë“œ** - DB ì»¬ëŸ¼ ëˆ„ë½ ì‹œ í•´ë‹¹ í•„ë“œ ì œì™¸ í›„ ì¬ì‹œë„ ë¡œì§ ì¶”ê°€
18. âœ… **ì—í”¼ì†Œë“œ ì´ˆê¸°í™”/í”„ë¡œì íŠ¸ ë¦¬ì…‹ ê¸°ëŠ¥** - resetEpisodes(), resetProject() ìŠ¤í† ì–´ í•¨ìˆ˜ + í”„ë¡œì íŠ¸ ê´€ë¦¬ ë“œë¡­ë‹¤ìš´ UI
19. âœ… **buildUserPrompt ì¤‘ë³µ ì œê±°** - ìºë¦­í„° í˜„ì¬ ìƒíƒœ/ê¸°ì–µ ì”ìƒ ì¤‘ë³µ ì„¹ì…˜ ì‚­ì œ (ë ˆê±°ì‹œ ëª¨ë“œ)

### ë‹¤ìŒ ì‘ì—…
- ì¶”ê°€ ê¸°ëŠ¥ ê°œì„  ë° ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜

### ë°°í¬ ì •ë³´
- **í”Œë«í¼**: Railway
- **URL**: https://narrative-simulator-production.up.railway.app
- **í™˜ê²½ë³€ìˆ˜**: ANTHROPIC_API_KEY, NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY

---

## ì‘ì—… ê·œì¹™ (í•„ìˆ˜)
- **ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ë°˜ë“œì‹œ ì´ CLAUDE.md íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•  ê²ƒ.** ìƒˆë¡œìš´ ê¸°ëŠ¥, ì•„í‚¤í…ì²˜ ë³€ê²½, íŒŒì¼ ì¶”ê°€/ìˆ˜ì • ë‚´ì—­ì„ ë°˜ì˜í•˜ì—¬ ë‹¤ìŒ ì„¸ì…˜ì—ì„œ ì¦‰ì‹œ ì´ì–´ì„œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
- **ì‘ì—… ì™„ë£Œ í›„ ìë™ ë°°í¬**: ì½”ë“œ ë³€ê²½ ì™„ë£Œ ì‹œ `git add` â†’ `git commit` â†’ `git push` ìë™ ì‹¤í–‰. ì‚¬ìš©ìê°€ ë³„ë„ë¡œ ìš”ì²­í•˜ì§€ ì•Šì•„ë„ ê¸°ë³¸ìœ¼ë¡œ ìˆ˜í–‰í•œë‹¤.
- í”„ë¡œì íŠ¸ ì •ì²´ì„œ(`project-identity.md`)ì™€ ìµœìƒìœ„ ì›ì¹™(`supreme-principles.md`)ì„ ëª¨ë“  ì„¤ê³„/êµ¬í˜„ íŒë‹¨ì˜ ê¸°ì¤€ìœ¼ë¡œ ì‚¼ëŠ”ë‹¤.

### ìµœê·¼ ì—…ë°ì´íŠ¸
- **2026-02-26**: PROMPT-REFACTOR-INSTRUCTIONS4 êµ¬í˜„
  - **ì—í”¼ì†Œë“œ ì´ˆê¸°í™”/í”„ë¡œì íŠ¸ ë¦¬ì…‹ ê¸°ëŠ¥ (ì‘ì—… 9)**:
    - `resetEpisodes()`: ì—í”¼ì†Œë“œë§Œ ì‚­ì œ (ì„¸ê³„ê´€/ìºë¦­í„° ì„¤ì • ìœ ì§€)
    - `resetProject()`: í”„ë¡œì íŠ¸ ì™„ì „ ë¦¬ì…‹ (ì„¸ê³„ê´€ë¶€í„° ë‹¤ì‹œ)
    - í”„ë¡œì íŠ¸ í˜ì´ì§€ í—¤ë”ì— âš™ï¸ í”„ë¡œì íŠ¸ ê´€ë¦¬ ë“œë¡­ë‹¤ìš´ ì¶”ê°€
  - **buildUserPrompt ì¤‘ë³µ ì œê±° (ì‘ì—… 4)**:
    - ë ˆê±°ì‹œ ëª¨ë“œì—ì„œ "ìºë¦­í„° í˜„ì¬ ìƒíƒœ", "ê¸°ì–µ ì”ìƒ" ì¤‘ë³µ ì„¹ì…˜ ì‚­ì œ
  - **ì´ë¯¸ ì™„ë£Œëœ ì‘ì—… í™•ì¸**:
    - ì‘ì—… 1-3 (buildSystemPrompt 4-Tier êµ¬ì¡°): ì´ì „ ì„¸ì…˜ì—ì„œ ì™„ë£Œ
    - ì‘ì—… 5 (EpisodeLog ì¶”ì  í•„ë“œ): ì´ì „ ì„¸ì…˜ì—ì„œ ì™„ë£Œ
    - ì‘ì—… 6 (generate-episode-log í”„ë¡¬í”„íŠ¸): ì´ì „ ì„¸ì…˜ì—ì„œ ì™„ë£Œ
    - ì‘ì—… 7 (direction ë¯¸ë°˜ì˜ ë²„ê·¸): ì´ì „ ì„¸ì…˜ì—ì„œ ì™„ë£Œ
    - ì‘ì—… 8 (Supabase ë°©ì–´ ì½”ë“œ): ì´ë²ˆ ì„¸ì…˜ ì‹œì‘ ì‹œ ì™„ë£Œ
  - **ìˆ˜ì • íŒŒì¼**:
    - `lib/store/project-store.ts`: resetEpisodes, resetProject í•¨ìˆ˜ ì¶”ê°€
    - `app/projects/[id]/page.tsx`: í”„ë¡œì íŠ¸ ê´€ë¦¬ ë“œë¡­ë‹¤ìš´ UI
    - `app/api/write-episode/route.ts`: ì¤‘ë³µ ì„¹ì…˜ ì œê±°
- **2026-02-26**: Supabase author_config ë°©ì–´ ì½”ë“œ ì¶”ê°€
  - `saveProjectToSupabase()` í•¨ìˆ˜ì— ë°©ì–´ ë¡œì§ ì¶”ê°€
  - `author_config` ì»¬ëŸ¼ì´ DBì— ì—†ì„ ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ í•¸ë“¤ë§
  - ì—ëŸ¬ ë©”ì‹œì§€ì— 'author_config' í¬í•¨ ì‹œ í•´ë‹¹ í•„ë“œ ì œì™¸í•˜ê³  ì¬ì‹œë„
  - **ìˆ˜ì • íŒŒì¼**: `lib/supabase/db.ts`
- **2026-02-26**: Direction ë¯¸ë°˜ì˜ ë²„ê·¸ ìˆ˜ì • + í”„ë¡¬í”„íŠ¸ ê°•í™”
  - **author-chat API direction ë²„ê·¸ ìˆ˜ì •**:
    - ì‚¬ìš©ìê°€ í”„ë¡œì íŠ¸ ìƒì„± ì‹œ ì…ë ¥í•œ "ë°©í–¥(direction)"ì´ ë ˆì´ì–´ ìƒì„±ì— ì œëŒ€ë¡œ ë°˜ì˜ë˜ì§€ ì•Šë˜ ë¬¸ì œ í•´ê²°
    - ê° ë ˆì´ì–´(world, coreRules, seeds, heroArc, villainArc, ultimateMystery) í”„ë¡¬í”„íŠ¸ì˜ "ì„ë¬´" ì„¹ì…˜ì— direction ëª…ì‹œì  ì‚½ì…
    - íŒ¨í„´: `í™˜ë‹˜ì˜ ì´ˆê¸° ì•„ì´ë””ì–´ë¥¼ ë°˜ë“œì‹œ ë°˜ì˜í•´: "${direction}"`
  - **write-episode API projectDirection ì¶”ê°€**:
    - `buildUserPrompt`ì— `projectDirection` íŒŒë¼ë¯¸í„° ì¶”ê°€
    - ë§¤ í™” ì§‘í•„ ì‹œ "ì´ ì†Œì„¤ì˜ ê¸°ë³¸ ì „ì œ" ì„¹ì…˜ìœ¼ë¡œ project.direction ì£¼ì…
    - Active Context ëª¨ë“œì™€ ë ˆê±°ì‹œ ëª¨ë“œ ëª¨ë‘ì— ì ìš©
  - **ìˆ˜ì • íŒŒì¼**:
    - `app/api/author-chat/route.ts`: 6ê°œ ë ˆì´ì–´ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
    - `app/api/write-episode/route.ts`: buildUserPrompt íŒŒë¼ë¯¸í„° ë° í”„ë¡¬í”„íŠ¸ í™•ì¥
- **2026-02-25**: ì§‘í•„ í”„ë¡¬í”„íŠ¸ 4-Tier ì•„í‚¤í…ì²˜ ë¦¬íŒ©í† ë§
  - **4-Tier í”„ë¡¬í”„íŠ¸ êµ¬ì¡°** (PROMPT-REFACTOR-INSTRUCTIONS.md ê¸°ë°˜):
    - TIER 0: ì ˆëŒ€ ê·œì¹™ (MUST - ìœ„ë°˜ ì‹œ ì „ì²´ ë¬´íš¨)
    - TIER 1: ì´ë²ˆ í™” ì»¨í…ìŠ¤íŠ¸ (í™”ìˆ˜, ë…ë°± í†¤, í´ë¦¬í”„í–‰ì–´ ì¶”ì²œ)
    - TIER 2: ì‘ê°€ DNA (í˜ë¥´ì†Œë‚˜, ì‹œì , ë¬¸ì²´ í•µì‹¬)
    - TIER 3: ì°¸ê³  ê·œì¹™ (ë¹Œë“œì—…, ìºë¦­í„°, ì—°ì¶œ, ê²€ì¦)
  - **MUST 3ê°œ ê·œì¹™**:
    - MUST-1: ì„¤ëª… ê¸ˆì§€ (ìºë¦­í„°ê°€ ì„¤ì •ì„ ëŒ€ì‚¬ë¡œ ì„¤ëª… ê¸ˆì§€)
    - MUST-2: ëŠ¥ë ¥ ê³µê°œ ì†ë„ ì œí•œ (ì—í”¼ì†Œë“œ ë²ˆí˜¸ ê¸°ë°˜ ë™ì  ìƒì„±)
    - MUST-3: íŒ¨í„´ ë°˜ë³µ ê¸ˆì§€ (ì´ì „ í™” ë¡œê·¸ ê¸°ë°˜ ë™ì  ìƒì„±)
  - **ë™ì  ì œì•½ ìƒì„±**:
    - `getAbilityConstraint(episodeNumber)`: í™”ìˆ˜ì— ë”°ë¥¸ ëŠ¥ë ¥ ê³µê°œ ì œí•œ
    - `getPatternBanList(recentLogs)`: ìµœê·¼ 3í™” ë¡œê·¸ ê¸°ë°˜ ê¸ˆì§€ ëª©ë¡
  - **buildUserPrompt ì¤‘ë³µ ì œê±°**:
    - Active Context ìˆìœ¼ë©´ ì••ì¶• ëª¨ë“œ (ì¤‘ë³µ ì„¹ì…˜ ì œê±°)
    - ì—†ìœ¼ë©´ ë ˆê±°ì‹œ ëª¨ë“œ ìœ ì§€
  - **EpisodeLog ì¶”ì  í•„ë“œ ì¶”ê°€**:
    - `abilitiesShown[]`: ì´ë²ˆ í™”ì—ì„œ ë“œëŸ¬ë‚œ ëŠ¥ë ¥
    - `emotionsDominant[]`: ì£¼ì¸ê³µ ì£¼ìš” ê°ì •
    - `narrativePatterns[]`: ì‚¬ìš©í•œ ì„œì‚¬ íŒ¨í„´
    - `villainActions[]`: ì ì´ í•œ í–‰ë™
  - **ìˆ˜ì • íŒŒì¼**:
    - `app/api/write-episode/route.ts`: buildSystemPrompt 4-Tier êµ¬ì¡°ë¡œ ì „ë©´ êµì²´
    - `app/api/generate-episode-log/route.ts`: ì¶”ì  í•„ë“œ ì¶”ì¶œ ì¶”ê°€
    - `lib/types/index.ts`: EpisodeLog íƒ€ì… í™•ì¥
- **2026-02-25**: ì„¤ì • ëª¨ìˆœ ìˆ˜ì • ìš”ì²­ ê¸°ëŠ¥ êµ¬í˜„
  - **íŒ©íŠ¸ì²´í¬ ëª¨ìˆœ ë°œê²¬ ì‹œ "ìˆ˜ì • ìš”ì²­" ë²„íŠ¼ ë™ì‘**:
    1. `/api/revise-episode` APIì— `mode: 'contradiction'` ì¶”ê°€
    2. ëª¨ìˆœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ AIê°€ í•´ë‹¹ ë¶€ë¶„ë§Œ ìˆ˜ì •
    3. ìˆ˜ì • ì „/í›„ ë¹„êµ ëª¨ë‹¬ í‘œì‹œ (ë³€ê²½ ë¶€ë¶„ í•˜ì´ë¼ì´íŠ¸)
    4. [ìˆ˜ì •ë³¸ ì±„íƒ] ë˜ëŠ” [ì›ë³¸ ìœ ì§€] ì„ íƒ
    5. World Bible ì—…ë°ì´íŠ¸ ì œì•ˆ ê¸°ëŠ¥ (ì„ íƒì‚¬í•­)
  - **"ë¬´ì‹œí•˜ê³  ì§„í–‰" ë²„íŠ¼**:
    - ë¬´ì‹œí•œ ëª¨ìˆœ ë¡œê¹… (`ignoredContradictions` ìƒíƒœ)
    - ì½˜ì†”ì— ë¬´ì‹œ ê¸°ë¡ ì¶œë ¥
  - **ìˆ˜ì • íŒŒì¼**:
    - `app/api/revise-episode/route.ts`: contradiction ëª¨ë“œ ì¶”ê°€
    - `app/projects/[id]/page.tsx`: ìˆ˜ì • ë¹„êµ ëª¨ë‹¬ UI + í•¸ë“¤ëŸ¬
  - **ìƒˆ ìƒíƒœ ë³€ìˆ˜**:
    - `revisionComparison`: ì›ë³¸/ìˆ˜ì •ë³¸/ë³€ê²½ë¶€ë¶„/World Bible ì œì•ˆ
    - `showRevisionModal`: ë¹„êµ ëª¨ë‹¬ í‘œì‹œ
    - `isFixingContradiction`: ìˆ˜ì • ì¤‘ ë¡œë”© ìƒíƒœ
    - `ignoredContradictions`: ë¬´ì‹œëœ ëª¨ìˆœ ë¡œê·¸
- **2026-02-25**: ì´ì›í™” ì‹œë®¬ë ˆì´ì…˜ UI ë²„íŠ¼ API ì—°ê²° ì™„ë£Œ
  - ì—­ì‚¬A íƒ­: ì„¸ê³„ ì—­ì‚¬ ìƒì„± ë²„íŠ¼ â†’ `handleGenerateWorldHistory()` ì—°ê²°
  - ì£¼ì¸ê³µB íƒ­: ì „ì‚¬/ì„±ì¥ê¸° ë²„íŠ¼ â†’ `handleSimulatePrehistory()`/`handleSimulateGrowth()` ì—°ê²°
  - ì…ë ¥ í•„ë“œë¥¼ defaultValueì—ì„œ controlled input (value + onChange)ë¡œ ë³€ê²½
  - ëª¨ë°”ì¼ ë°”í…€ ì‹œíŠ¸ì—ë„ ë™ì¼í•œ ë²„íŠ¼ ì—°ê²° ì ìš©
  - ë¡œë”© ìƒíƒœ(isSimulating)ì— ë”°ë¥¸ ë²„íŠ¼ ë¹„í™œì„±í™” ë° í…ìŠ¤íŠ¸ ë³€ê²½
- **2026-02-25**: ì´ì›í™” ì‹œë®¬ë ˆì´ì…˜ ì‹œìŠ¤í…œ êµ¬í˜„
  - **Simulation A (ì„¸ê³„ ì—­ì‚¬)**: ì„¸ê³„ ì—­ì‚¬ë¥¼ ì‚¬ìš©ì ì§€ì • ë²”ìœ„ì™€ ë‹¨ìœ„ë¡œ ì‹œë®¬ë ˆì´ì…˜
    - `startYearsBefore`, `endYearsBefore`, `unit` ì„¤ì • ê°€ëŠ¥
    - ë“œë¦´ë‹¤ìš´ ê¸°ëŠ¥: íŠ¹ì • ì‹œëŒ€ë¥¼ ë” ì„¸ë¶„í™”ëœ ë‹¨ìœ„ë¡œ ìƒì„¸í™”
    - `/api/generate-world-history` API í™•ì¥ (ë“œë¦´ë‹¤ìš´ ëª¨ë“œ ì§€ì›)
  - **Simulation B (ì£¼ì¸ê³µ ì‹œì )**: ì£¼ì¸ê³µì˜ ì¼ëŒ€ê¸°ë¥¼ 3êµ¬ê°„ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜
    - êµ¬ê°„ 1: ì „ì‚¬(å‰å²) - ì£¼ì¸ê³µ ì¶œìƒ ì „ ë¶€ëª¨/ìŠ¤ìŠ¹ ì„¸ëŒ€
    - êµ¬ê°„ 2: ì„±ì¥ê¸° - 0ì„¸ë¶€í„° ì†Œì„¤ ì‹œì‘ ì‹œì ê¹Œì§€
    - êµ¬ê°„ 3: ì†Œì„¤ ì§„í–‰ - ì‹œê°„ ì í”„ ì‹œë®¬ë ˆì´ì…˜
  - **ìƒˆ API**:
    - `/api/simulate-prehistory`: ì£¼ì¸ê³µ ì „ì‚¬ ì‹œë®¬ë ˆì´ì…˜
    - `/api/advance-timeline`: ì†Œì„¤ ì¤‘ ì‹œê°„ ì í”„ ì‹œë®¬ë ˆì´ì…˜
  - **ìƒˆ íƒ€ì…**:
    - `DualSimulationConfig`, `WorldHistorySimulationConfig`, `ProtagonistSimulationConfig`
    - `PrehistoryEvent`, `ProtagonistPrehistory`, `TimelineAdvance`, `WorldHistorySubEra`
  - **ìŠ¤í† ì–´ í™•ì¥**:
    - `setDualSimulationConfig`, `updateDualSimulationConfig`
    - `setProtagonistPrehistory`, `addTimelineAdvance`, `updateTimelineAdvance`
  - **UI íƒ­ ë³€ê²½**: [ì„¸ê³„] [ì—­ì‚¬] [ìºë¦­í„°] [ì›ê³ ] â†’ [ì„¸ê³„] [ì—­ì‚¬A] [ì£¼ì¸ê³µB] [ì›ê³ ]
  - **ìˆ˜ì • íŒŒì¼**:
    - `lib/types/index.ts`: ì´ì›í™” ì‹œë®¬ë ˆì´ì…˜ íƒ€ì… ì¶”ê°€
    - `lib/store/project-store.ts`: ìŠ¤í† ì–´ ì•¡ì…˜ ì¶”ê°€
    - `lib/supabase/types.ts`, `lib/supabase/db.ts`: Supabase ì €ì¥/ë¡œë“œ ì§€ì›
    - `app/api/generate-world-history/route.ts`: ì‚¬ìš©ì ì„¤ì • ë²”ìœ„ + ë“œë¦´ë‹¤ìš´ ì§€ì›
    - `app/api/simulate-prehistory/route.ts`: ì‹ ê·œ
    - `app/api/advance-timeline/route.ts`: ì‹ ê·œ
    - `app/projects/[id]/page.tsx`: íƒ­ UI ë³€ê²½ + ì‹œë®¬ë ˆì´ì…˜ ì»¨íŠ¸ë¡¤
- **2026-02-25**: ë‹¤ì¤‘ ì‘ê°€ AI ì‹œìŠ¤í…œ êµ¬í˜„
  - ê¸°ì¡´ 4ì¢… ì‘ê°€ í˜ë¥´ì†Œë‚˜ ì„ íƒ â†’ **ì¥ë¥´ + í†¤ + ë¶„ìœ„ê¸° ì¡°í•©** ë°©ì‹ìœ¼ë¡œ ë³€ê²½
  - 5ê°œ ì¥ë¥´ DNA: ë¬´í˜‘, íŒíƒ€ì§€, í˜„ëŒ€íŒíƒ€ì§€, ë¡œë§¨ìŠ¤, íšŒê·€/í™˜ìƒ
  - í†¤ ë°€ë„ 3ë‹¨ê³„: ë¼ì´íŠ¸, ë¯¸ë””ì—„, ë”¥
  - ë¶„ìœ„ê¸° 6ì¢… (ë³µìˆ˜ ì„ íƒ): ìœ ë¨¸/ìì¡°, ì„œì •ì , ê±´ì¡°/í•˜ë“œë³´ì¼ë“œ, ì² í•™ì , ë‹¤í¬/ê·¸ë¦¬í‹°, ì—´í˜ˆ
  - ëŒ€ì‚¬ ìŠ¤íƒ€ì¼ 4ì¢…: ì§§ê³  ê°•ë ¬, í˜„ì‹¤ì , ë¬¸ì–´ì²´, í˜¼í•©
  - ë¬˜ì‚¬ ë°€ë„ 3ë‹¨ê³„: ìµœì†Œí•œ, ê· í˜•, í’ë¶€
  - **ì§‘í•„ í”„ë¡œì„¸ìŠ¤ 4ë‹¨ê³„ â†’ 6ë‹¨ê³„ ì¬êµ¬ì„±**:
    - 1ë‹¨ê³„: í˜ë¥´ì†Œë‚˜ ì¥ì°© (ì¥ë¥´ DNA + í†¤ ë¡œë“œ)
    - 2ë‹¨ê³„: ì„¤ê³„ê´€ ì‚¬ì „ ê²€í†  (ê°œì—°ì„±/í”„ë¡œí•„/ì—°ì†ì„±)
    - 3ë‹¨ê³„: ì—°ì¶œê´€ ì„¤ê³„ (ì¥ë©´/í˜¸í¡/í´ë¦¬í”„í–‰ì–´/ì”í–¥)
    - 4ë‹¨ê³„: ì´ˆê³  ì§‘í•„
    - 5ë‹¨ê³„: 3ì¸ í•©ë™ ê²€í†  (ì„¤ê³„ê´€+ì—°ì¶œê´€+ì‹œì¥ê´€)
    - 6ë‹¨ê³„: ìµœì¢… ìˆ˜ì •
  - **3ì¸ ê²€í†  ì²´ê³„**:
    - ì„¤ê³„ê´€ (ë…¼ë¦¬): ìºë¦­í„° í–‰ë™ ì¼ì¹˜, í˜ ë°¸ëŸ°ìŠ¤, ì´ì „ í™” ëª¨ìˆœ, ì„¸ê³„ê´€ ê·œì¹™
    - ì—°ì¶œê´€ (ëª°ì…): ì²« ë¬¸ë‹¨, ë¬¸ì¥ í˜¸í¡, ê°ê° ë²ˆì—­, ì”í–¥, í´ë¦¬í”„í–‰ì–´
    - ì‹œì¥ê´€ (ìƒì—…ì„±): 500ì í›…, ë¶„ëŸ‰, ë³´ìƒ ì§€ì—°, ë…ì ë°˜ì‘, ëª°ì… 4ìš”ì†Œ
  - í•˜ìœ„ í˜¸í™˜: `inferConfigFromPersonaId()` í•¨ìˆ˜ë¡œ ê¸°ì¡´ authorPersonaId ìë™ ë³€í™˜
  - ìˆ˜ì • íŒŒì¼:
    - `lib/types/index.ts`: GenreType, ToneDensity, MoodType, DialogueStyle, DescriptionDensity, AuthorConfig, GenrePersonaDNA íƒ€ì… ì¶”ê°€
    - `lib/presets/genre-personas.ts`: ì‹ ê·œ - ì¥ë¥´ DNA, ê°€ì´ë“œ, í”„ë¡¬í”„íŠ¸ ë¹Œë”
    - `app/projects/new/page.tsx`: ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± UI ì „ë©´ ë³€ê²½
    - `lib/store/project-store.ts`: authorConfig ì§€ì›
    - `lib/supabase/types.ts`, `lib/supabase/db.ts`: author_config í•„ë“œ ì¶”ê°€
    - `app/api/write-episode/route.ts`: 6ë‹¨ê³„ + 3ì¸ ê²€í†  í”„ë¡¬í”„íŠ¸
- **2026-02-24**: ëª¨ë°”ì¼ íŒŒì¼ ì—…ë¡œë“œ í˜¸í™˜ì„± ê°œì„ 
  - ìˆ¨ê²¨ì§„ íŒŒì¼ ì¸í’‹ì„ sr-only íŒ¨í„´ìœ¼ë¡œ ë³€ê²½ (position: absolute, clip)
  - accept ì†ì„±ì— MIME íƒ€ì… ì¶”ê°€ (`application/json`, `text/plain`, `text/*`)
  - ìºë¦­í„° ì—…ë¡œë“œì—ì„œ TXT, JSON íŒŒì¼ ëª¨ë‘ ì§€ì›
  - `parseCharacterJson()` í•¨ìˆ˜ ì¶”ê°€ (JSON ìºë¦­í„° íŒŒì¼ íŒŒì‹±)
  - ì˜¤ë¥˜ ì²˜ë¦¬ ê°œì„  ë° íŒŒì¼ í¬ê¸° ì œí•œ (10MB)
  - ë²„íŠ¼ ë ˆì´ë¸” "TXT ì—…ë¡œë“œ" â†’ "íŒŒì¼ ì—…ë¡œë“œ" ë³€ê²½
- **2026-02-24**: ì„¸ê³„ ì—­ì‚¬ íƒ€ì„ë¼ì¸ í¸ì§‘ ê¸°ëŠ¥ ì¶”ê°€
  - `components/world/TimelineEditor.tsx` - íƒ€ì„ë¼ì¸ í¸ì§‘ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸
  - ì‹œëŒ€(Era) íƒ­: ì´ë¦„, ì—°ë„ ë²”ìœ„, ì„¤ëª…, ì„¸ë ¥ ë³€í™”, ë¶„ìœ„ê¸°, í•µì‹¬ ì‚¬ê±´, ì£¼ìš” ì¸ë¬¼, ë¯¸ìŠ¤í„°ë¦¬ íŒíŠ¸, ìœ ì‚°
  - 10ë…„ ë‹¨ìœ„(Decade) íƒ­: ì—°ë„ ë²”ìœ„, ê¸´ì¥ë„, ì„¸ê³„ ìƒíƒœ, ì£¼ìš” ì´ë²¤íŠ¸, ë³µì„ /íŒíŠ¸
  - ì‚¬ì´ë“œ íŒ¨ë„ ì—­ì‚¬ íƒ­ì— "ğŸ“… ì—­ì‚¬ íƒ€ì„ë¼ì¸ í¸ì§‘" ë²„íŠ¼ ì¶”ê°€
  - ì‹œëŒ€/10ë…„ ë‹¨ìœ„ ì¶”ê°€/ì‚­ì œ/í¸ì§‘ ê¸°ëŠ¥
  - ì„¤ì •ì— ë”°ë¼ ì²œë…„ ì „ ì¸ë¬¼ì´ í˜„ì¬ì˜ ì£¼ì¸ê³µì¼ ìˆ˜ë„ ìˆê³ , í˜„ì¬ íƒœì–´ë‚œ ì£¼ì¸ê³µì¼ ìˆ˜ë„ ìˆìŒ
  - ë³€ê²½ì‚¬í•­ì€ `setWorldHistory()`ë¡œ ì €ì¥, ë‹¤ìŒ í™” ì§‘í•„ ì‹œ ìë™ ë°˜ì˜
- **2026-02-24**: ì—í”¼ì†Œë“œ ë ˆë²¨ ë””ë ‰íŒ… ì‹œìŠ¤í…œ ì™„ë£Œ
  - `EpisodeDirection` íƒ€ì… ì •ì˜ (ê°ì • í†¤, ê°•ì œ ì¥ë©´, ìºë¦­í„° ì§€ì‹œ, ë–¡ë°¥ ì§€ì‹œ, í˜ì´ìŠ¤, í´ë¦¬í”„í–‰ì–´ ë“±)
  - `EpisodeDirectionModal` ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (ê°ì • ê·¸ë¦¬ë“œ, ì¥ë©´ í¸ì§‘ê¸°, ìºë¦­í„° ì§€ì‹œ ë“±)
  - `write-episode` APIì— `buildEpisodeDirectionSection()` í•¨ìˆ˜ ì¶”ê°€ - PD ë””ë ‰íŒ…ì„ í”„ë¡¬í”„íŠ¸ì— ìµœìš°ì„  ë°˜ì˜
  - ì—í”¼ì†Œë“œ ì±„íƒ í›„ "ğŸ¬ ë””ë ‰íŒ… ì„¤ì •" ì˜µì…˜ ì¶”ê°€
  - ì„¸ê³„ê´€/ìºë¦­í„° ì„¸ë¶€ ì •ë³´(`worldLayer`, `seedsLayer`)ë¥¼ write-episode APIì—ì„œ í™œìš©
- **2026-02-24**: ìºë¦­í„° TXT íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€
  - `lib/utils/character-txt-parser.ts` - TXT íŒŒì¼ íŒŒì‹± ìœ í‹¸ë¦¬í‹°
  - ì§€ì› í˜•ì‹: `=== ìºë¦­í„°: ì´ë¦„ ===` ë¸”ë¡ í˜•ì‹ ë˜ëŠ” `ì´ë¦„ - ì—­í•  - ì„¤ëª…` ê°„ë‹¨ í˜•ì‹
  - íŒŒì‹± í•„ë“œ: ì—­í• , ìœ„ì¹˜, ì„±ê²©, ìˆ¨ê²¨ì§„ ë™ê¸°, ì™¸ëª¨, ë§íˆ¬, ë°°ê²½, ì†Œì†, ë¹„ì¤‘, ê´€ê³„, ì„œì‚¬
  - ì‚¬ì´ë“œ íŒ¨ë„ ìºë¦­í„° íƒ­ì— "ğŸ“„ TXT ì—…ë¡œë“œ" ë²„íŠ¼ ì¶”ê°€
  - ì—…ë¡œë“œ ê²°ê³¼ ëª¨ë‹¬: ìºë¦­í„° ë¯¸ë¦¬ë³´ê¸°, ì„ íƒì  ì¶”ê°€
  - ì˜ˆì‹œ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ (`character-template.txt`)
- **2026-02-24**: ì„¸ê³„ê´€/ìºë¦­í„° í¸ì§‘ ê¸°ëŠ¥ ì¶”ê°€
  - `components/world/WorldSettingsEditor.tsx` - ì„¸ê³„ê´€ í¸ì§‘ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸
  - ì£¼ì¸ê³µ íƒ­: ì´ë¦„, ë‚˜ì´, íƒœìƒ, ì†Œì†, í™˜ê²½, í˜„ì¬ ìƒíƒœ, í•µì‹¬ ì„œì‚¬, ëª©í‘œ, ìš•ë§/ê²°í•, ì•½ì 
  - ë¹ŒëŸ° íƒ­: ì´ë¦„, ë‚˜ì´, íƒœìƒ, ì†Œì†, í‘œë©´ì  ëª©í‘œ, ë™ê¸°, ìê¸° ì •ë‹¹í™”, í•µì‹¬ ì„œì‚¬, ê´€ê³„
  - NPC íƒ­: ê° NPC ì ‘ê¸°/í¼ì¹˜ê¸°ë¡œ ëª¨ë“  í•„ë“œ í¸ì§‘ ê°€ëŠ¥
  - ì‚¬ì´ë“œ íŒ¨ë„ ì„¸ê³„/ìºë¦­í„° íƒ­ì— "ğŸ› ï¸ ì„¸ê³„ê´€/ìºë¦­í„° í¸ì§‘" ë²„íŠ¼ ì¶”ê°€
  - ë³€ê²½ì‚¬í•­ì€ ë ˆì´ì–´ì— ì €ì¥ë˜ì–´ ë‹¤ìŒ í™” ì§‘í•„ ì‹œ ìë™ ë°˜ì˜
- **2026-02-23**: ìºë¦­í„° ì¶”ê°€ ë° ì‹œë®¬ë ˆì´ì…˜ NPC ìŠ¹ê²© ê¸°ëŠ¥ ì¶”ê°€
  - ì‚¬ì´ë“œ íŒ¨ë„ ìºë¦­í„° íƒ­ì— ë“±ë¡ëœ NPC ëª©ë¡ í‘œì‹œ (ì£¼ì—°/ì¡°ì—°/ë‹¨ì—­ ë°°ì§€)
  - ìºë¦­í„° ì¶”ê°€ ëª¨ë‹¬: ì´ë¦„, ì—­í• , ìœ„ì¹˜, ì„±ê²©, ìˆ¨ê²¨ì§„ ë™ê¸°, ì„¸ë¶€ ì„¤ì •
  - ì‹œë®¬ë ˆì´ì…˜ ë°œìƒ NPC í‘œì‹œ (ì¤‘ìš”ë„ 50ì  ì´ìƒ, ë“±ì¥ íšŸìˆ˜, ì²« ë“±ì¥ ì—°ë„)
  - NPC ìŠ¹ê²© ê¸°ëŠ¥: ì‹œë®¬ë ˆì´ì…˜ NPCë¥¼ ì£¼ìš” ìºë¦­í„°ë¡œ ì „í™˜
  - `handleAddCharacter()`, `handlePromoteSimulationNPC()` í•¸ë“¤ëŸ¬
  - `NPCSeedInfo`, `SimulationNPC`, `SeedsLayer` íƒ€ì… í™œìš©
- **2026-02-23**: í”„ë¡œì íŠ¸ íƒìƒ‰ ë° ê³µê°œ ì„¤ì • ê¸°ëŠ¥ ì¶”ê°€
  - `/explore` í˜ì´ì§€: ëª¨ë“  ê³µê°œ í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
  - `/shared/[projectId]`: ì½ê¸° ì „ìš© í”„ë¡œì íŠ¸ ë·°ì–´ (ìŠ¤í¬ì¼ëŸ¬ ì œì™¸)
  - `is_public` ì»¬ëŸ¼ ì¶”ê°€ (Supabase projects í…Œì´ë¸”)
  - í”„ë¡œì íŠ¸ ì¹´ë“œì— ê³µê°œ/ë¹„ê³µê°œ í† ê¸€ ë²„íŠ¼ (ğŸŒ/ğŸ”’)
  - í”„ë¡œì íŠ¸ ëª©ë¡ì— [íƒìƒ‰] ë²„íŠ¼ ì¶”ê°€
  - `loadPublicProjects()`, `updateProjectVisibility()` í•¨ìˆ˜ ì¶”ê°€
- **2026-02-23**: SSE ìŠ¤íŠ¸ë¦¬ë° ì „í™˜ + ë ˆì´ì–´ ì§„í–‰ ë°©ì‹ ë³€ê²½
  - `author-chat`, `write-episode`, `generate-world-bible` APIë¥¼ SSE ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì „í™˜
  - `maxDuration = 60` ì¶”ê°€ (Vercel Fluid Compute í™œì„±í™”)
  - Vercel Hobby í”Œëœ 10ì´ˆ íƒ€ì„ì•„ì›ƒ ë¬¸ì œ í•´ê²°
  - ë ˆì´ì–´ ì§„í–‰: AI ì œì•ˆ ìš°ì„  â†’ ì‚¬ìš©ì ì…ë ¥ ìš°ì„ ìœ¼ë¡œ ë³€ê²½
  - ìƒˆ ë ˆì´ì–´ ì‹œì‘ ì‹œ ê°€ì´ë“œ ë©”ì‹œì§€ í‘œì‹œ (`waitingForUserInput` í”Œë˜ê·¸)
  - í”„ë¡ íŠ¸ì—”ë“œì— `streamingFetch` í—¬í¼ í•¨ìˆ˜ ì¶”ê°€
- **2026-02-23**: ì„¸ê³„ê´€ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥ ì¶”ê°€
  - ëŒ€ì‹œë³´ë“œì— "ğŸ“š ì„¸ê³„ê´€ ë¶ˆëŸ¬ì˜¤ê¸°" ë²„íŠ¼ ì¶”ê°€
  - `data/` í´ë”ì˜ JSON íŒŒì¼ë“¤ì„ ë¶ˆëŸ¬ì™€ ìƒˆ í”„ë¡œì íŠ¸ ìë™ ìƒì„±
  - world-config.json â†’ WorldLayer + CoreRulesLayer ë³€í™˜
  - characters.json + factions-*.json â†’ SeedsLayer ë³€í™˜
  - ì„¸ê³„ê´€/ê·œì¹™/ì”¨ì•— ë ˆì´ì–´ ìë™ í™•ì •, heroArcë¶€í„° ì‹œì‘
  - `lib/utils/world-data-loader.ts` ìœ í‹¸ë¦¬í‹° ì¶”ê°€
- **2026-02-23**: ì²œì¶”ì˜ê°•í˜¸ ì„¸ê³„ê´€ ë°ì´í„° JSON êµ¬ì¡°í™” (`data/` í´ë” ì¬êµ¬ì„±)
  - 10ê°œ JSON íŒŒì¼ë¡œ ì„¸ê³„ê´€ ë°ì´í„° ì²´ê³„í™”
  - ì£¼ì¸ê³µ(4ì‹ ), ì „ì„¤(1ì‹ ~4ì¡´), 5ì™•, 6ê´´, 7ê·€, 8ì„±, 9ë§ˆ, 10ì„  ìºë¦­í„°
  - 5ëŒ€ ì„¸ë ¥ + ë°°í›„ì„¸ë ¥(í˜„ê¸°ì›) ì¡°ì§ êµ¬ì¡°
  - ì§€ì—­/ì¶©ëŒì§€ëŒ€/êµí†µë¡œ ë°ì´í„°

---

## í”„ë¡œì íŠ¸ ì •ì²´ì„œ (project-identity.md)

> **ì´ í”„ë¡œì íŠ¸ì˜ ì¡´ì¬ ì´ìœ ë¥¼ ì •ì˜í•œë‹¤. ëª¨ë“  ì§€ì‹œì„œëŠ” ì´ ë¬¸ì„œì— ë´‰ì‚¬í•œë‹¤.**

### í•µì‹¬ ëª©ì 
```
í¥í–‰í•˜ëŠ” ì›¹ì†Œì„¤ì„ ë§Œë“œëŠ” ì‹œìŠ¤í…œì´ë‹¤.
ì¡°íšŒìˆ˜ê°€ ë†’ê³ , ì—°ë…ìœ¨ì´ ë†’ì€ ì›¹ì†Œì„¤.

ì‹œë®¬ë ˆì´ì…˜, ì‘ê°€ AI, ì„¸ê³„ê´€, ìºë¦­í„° ì‹œìŠ¤í…œ â€”
ì´ ëª¨ë“  ê²ƒì€ "ì¬ë¯¸ìˆëŠ” ì›¹ì†Œì„¤"ì„ ë§Œë“¤ê¸° ìœ„í•œ ë„êµ¬ì¼ ë¿ì´ë‹¤.
ë„êµ¬ê°€ ëª©ì ì´ ë˜ë©´ ì•ˆ ëœë‹¤.
```

### ì‹œë®¬ë ˆì´ì…˜ì˜ ëª©ì 
- ìºë¦­í„°ì—ê²Œ **"ì§„ì§œ ì¸ìƒ"**ì„ ë¶€ì—¬í•˜ëŠ” ë„êµ¬
- 0ì„¸ë¶€í„° ì‹œë ¨ê³¼ ì„±ì¥ì„ ì‚´ì•„ì˜¨ ìºë¦­í„° = ë” ì…ì²´ì 
- ìºë¦­í„°ê°€ ë§¤ë ¥ì ì´ë©´ ì„±ê³µ, í‰ë©´ì ì´ë©´ ì‹¤íŒ¨

### ì›Œí¬í”Œë¡œìš°
```
í™˜ë‹˜ (ì‚¬ìš©ì)
  â”‚ í° í‹€ì˜ ì£¼ì œ + í•µì‹¬ ì›Œë”© ì œê³µ
  â–¼
ì‘ê°€ AI (í˜ë¥´ì†Œë‚˜)
  â”‚ â”œâ”€ ì„¸ê³„ê´€ êµ¬ì¶•
  â”‚ â”œâ”€ ìºë¦­í„° ì„œì‚¬ ì•„í¬ ì„¤ê³„
  â”‚ â”œâ”€ ì‹œë®¬ë ˆì´ì…˜ ì§€íœ˜
  â”‚ â”œâ”€ ìŠ¤í† ë¦¬ êµ¬ì¡° ì„¤ê³„
  â”‚ â””â”€ ì§‘í•„
  â–¼
í¥í–‰í•˜ëŠ” ì›¹ì†Œì„¤ (ê²°ê³¼ë¬¼)
  â–¼
í™˜ë‹˜ ê²€í† /í”¼ë“œë°± â†’ ì‘ê°€ ìˆ˜ì • â†’ ë°˜ë³µ
```

### ê° ì‹œìŠ¤í…œì˜ ì—­í•  (ë„êµ¬ë¡œì„œ)
| ì‹œìŠ¤í…œ | ì—­í•  | ë´‰ì‚¬í•˜ëŠ” ëª©ì  |
|--------|------|--------------|
| ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„ | ìºë¦­í„°ì—ê²Œ ì‚´ì•„ì˜¨ ì¸ìƒì„ ë¶€ì—¬ | ë§¤ë ¥ì ì¸ ìºë¦­í„° |
| ê²½í—˜ ë ˆì´ì–´ | ì”¨ì•—ì—ì„œ ì„±ê²©/ëŠ¥ë ¥ì´ ìì—° ë°œí˜„ | ìºë¦­í„°ì˜ ì…ì²´ì„± |
| NPC ìì—° ë°œìƒ | ë™ë£Œ/ì¡°ë ¥ì/ë¹ŒëŸ°ì´ ì„œì‚¬ì—ì„œ íƒ„ìƒ | ê´€ê³„ì˜ ìì—°ìŠ¤ëŸ¬ì›€ |
| ì„œì‚¬ ì•„í¬ | ìºë¦­í„°ì˜ ì—¬ì • í° ê·¸ë¦¼ ì„¤ê³„ | ì´ì•¼ê¸°ì˜ êµ¬ì¡° |
| ì‘ê°€ ë””ë ‰ì…˜ | ì‹œë ¨/ì„±ì¥/ë§Œë‚¨ì„ ì ì¬ì ì†Œì— | ìŠ¤í† ë¦¬ì˜ ì¬ë¯¸ |
| ìŠ¤í† ë¦¬ë¼ì¸ ëª¨ë‹ˆí„° | ë°©í–¥ ì´íƒˆ/íŒ¨í„´ ë°˜ë³µ ê°ì§€ | í’ˆì§ˆ ìœ ì§€ |
| ì§‘í•„ ì—”ì§„ | ì‹¤ì œ ì›¹ì†Œì„¤ í…ìŠ¤íŠ¸ ìƒì„± | ìµœì¢… ì‚°ì¶œë¬¼ |
| ìµœìƒìœ„ ì›ì¹™ | ëª¨ë“  ì‹œìŠ¤í…œì˜ í–‰ë™ ê·œë²” | **ì¬ë¯¸ > ë‚˜ë¨¸ì§€ ì „ë¶€** |

### ì§€ì‹œì„œ ê³„ì¸µ êµ¬ì¡°
```
í”„ë¡œì íŠ¸ ì •ì²´ì„œ (ìµœìƒìœ„)
  â”œâ”€ ìµœìƒìœ„ ì›ì¹™ (supreme-principles.md)
  â”œâ”€ í†µí•© ì§€ì‹œì„œ (MASTER-INSTRUCTION-FINAL.md)
  â””â”€ ì¶”ê°€ ì§€ì‹œì„œë“¤ (ì”¨ì•—, ìŠ¤í† ë¦¬ë¼ì¸, ì‘ê°€ AI ë“±)

â€» ìƒìœ„ ë¬¸ì„œì™€ í•˜ìœ„ ë¬¸ì„œ ì¶©ëŒ ì‹œ â†’ ìƒìœ„ ë¬¸ì„œ ìš°ì„ 
```

---

## ìµœìƒìœ„ ì›ì¹™ (supreme-principles.md)

> **ì´ ì›ì¹™ì€ ëª¨ë“  ì§€ì‹œì„œÂ·ì„¤ê³„ í—Œë²•Â·ì½”ë“œ êµ¬í˜„ë³´ë‹¤ ìš°ì„ í•œë‹¤.**

### ì›ì¹™ 1: ìºë¦­í„°ì˜ ììœ¨ì„±
- ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜ì€ ììœ¨ì ìœ¼ë¡œ ì§„í–‰ëœë‹¤.
- ì²˜ìŒë¶€í„° ë‚˜ìœ ë†ˆì€ ì—†ë‹¤. ì„¸ìƒì´, í™˜ê²½ì´ ê·¸ë¦¬ ë§Œë“¤ì—ˆì„ ë¿ì´ë‹¤.
- ì•…ì¸ë„ ì•…ì¸ì´ ëœ ì´ìœ ê°€ ìˆê³ , ì˜ì›…ë„ ë‚˜ì•½í–ˆë˜ ì‹œì ˆì´ ìˆë‹¤.
- ëª¨ë“  ìºë¦­í„°ëŠ” ìì‹ ì˜ ê²½í—˜ì´ ë§Œë“  ì¡´ì¬ë‹¤.

### ì›ì¹™ 2: ì‘ê°€ì˜ ì—­í• 
- ì‘ê°€ëŠ” ìºë¦­í„°ì—ê²Œ ì‹œë ¨ê³¼ ì„±ì¥ì˜ ê³„ê¸°ë¥¼ ë¶€ì—¬í•˜ëŠ” "ì‹ (God)".
- ì‘ê°€ëŠ” ìƒí™©ì„ ë§Œë“¤ê³ , ìºë¦­í„°ëŠ” ììœ¨ì ìœ¼ë¡œ ë°˜ì‘í•œë‹¤.
- ìºë¦­í„°ì˜ ë°˜ì‘ì„ í•˜ë“œì½”ë”©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### ì›ì¹™ 3: ë°˜ë³µì˜ ê²½ê³„
- ì‹œë ¨â†’ì„±ì¥â†’ì‹œë ¨â†’ì„±ì¥ ë‹¨ìˆœ ë°˜ë³µ ê¸ˆì§€.
- ê¸°ì—°â†’ê°ì„±â†’ê¸°ì—°â†’ê°ì„± ë‹¨ìˆœ ë°˜ë³µ ê¸ˆì§€.
- íŒ¨í„´ì„ ê¹¨ë¼: ì„±ì¥ì¸ ì¤„ ì•Œì•˜ëŠ”ë° í•¨ì •, ì‹œë ¨ì´ ì˜¤íˆë ¤ ê¸°íšŒ, ê¸°ì—°ì˜ ëŒ€ê°€ê°€ ë„ˆë¬´ í¼, í‰ì˜¨ì´ ê°€ì¥ ìœ„í—˜, ì ì´ ìœ ì¼í•œ ì•„êµ°.
- ë…ìê°€ "ë‹¤ìŒì— ë­ê°€ ì˜¬ì§€" ì˜ˆì¸¡í•˜ëŠ” ìˆœê°„ ì´ì•¼ê¸°ëŠ” ì£½ëŠ”ë‹¤.

### ì›ì¹™ 4: ì„íŒ©íŠ¸ ìˆëŠ” ì§‘í•„
- ì¬ë¯¸ê°€ ìµœìš°ì„ . ë¬¸í•™ì„±Â·êµ¬ì¡°Â·ê¹Šì´ ì „ë¶€ ì¤‘ìš”í•˜ì§€ë§Œ ì¬ë¯¸ë³´ë‹¤ ìš°ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë§¤ í™” ì²« ë¬¸ì¥ì´ ë…ìë¥¼ ì¡ê³ , ë§ˆì§€ë§‰ ë¬¸ì¥ì´ ë‹¤ìŒ í™”ë¥¼ í´ë¦­í•˜ê²Œ ë§Œë“ ë‹¤.
- ê°ì •ì€ ì„¤ëª…í•˜ì§€ ì•Šê³  ë³´ì—¬ì¤€ë‹¤ (Show, Don't Tell).
- ëŒ€ì‚¬ëŠ” ì§§ê³  ê°•ë ¬í•˜ê²Œ. 70%ë§Œ ë³´ì—¬ì£¼ê³  30%ëŠ” ìƒìƒí•˜ê²Œ.

### ì ìš© ë²”ìœ„
| ì‹œìŠ¤í…œ | ì ìš© ë‚´ìš© |
|--------|----------|
| ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„ | ìºë¦­í„° ë°˜ì‘ ììœ¨ì„± ë³´ì¥, í•˜ë“œì½”ë”©ëœ ì´ë²¤íŠ¸ ìœ í˜•/ë‚˜ì´ë³„ ê°€ì´ë“œ ê¸ˆì§€ |
| ì‘ê°€ AI | íŒ¨í„´ ë°˜ë³µ íšŒí”¼, ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ì „ê°œ, ì„íŒ©íŠ¸ ìˆëŠ” ë¬¸ì²´ |
| ìŠ¤í† ë¦¬ë¼ì¸ ëª¨ë‹ˆí„° | íŒ¨í„´ ë°˜ë³µ ê°ì§€ ê²½ê³ (`repetitive`), í¥ë¯¸ë„ ì €í•˜ ê°ì§€ ê²½ê³ (`interest`) |
| ì„¸ê³„ê´€/ì—°ëŒ€ê¸° | ì„¸ìƒì´ ìºë¦­í„°ë¥¼ ë§Œë“ ë‹¤ëŠ” ì „ì œ, í™˜ê²½ì´ ì„ íƒì„ ì´ëˆë‹¤ |
| ì„¤ê³„ í—Œë²• | ìµœìƒìœ„ ì›ì¹™ > ì„¤ê³„ í—Œë²• (ë‹¨, í•˜ë“œì½”ë”© ê¸ˆì§€ ì›ì¹™ì€ ìœ ì§€) |

---

## í”„ë¡œì íŠ¸ ê°œìš”
ë¬´í˜‘/íŒíƒ€ì§€ ì›¹ì†Œì„¤ì˜ ì„œì‚¬ë¥¼ AIë¡œ ìƒì„±í•˜ëŠ” ì‹œë®¬ë ˆì´í„°. ìºë¦­í„°ê°€ ì„¸ê³„ê´€ ì•ˆì—ì„œ í•´ë§ˆë‹¤ ì´ë²¤íŠ¸ë¥¼ ê²ªê³ , ê·¸ ì´ë²¤íŠ¸ë¥¼ í¸ì§‘í•´ ì†Œì„¤ë¡œ ì™„ì„±í•˜ëŠ” ë„êµ¬.

## ê¸°ìˆ  ìŠ¤íƒ
- **í”„ë ˆì„ì›Œí¬**: Next.js 16.1.6 (Turbopack, App Router)
- **UI**: React 19 + Tailwind CSS v4 (`@theme inline` in globals.css, NOT tailwind.config.ts)
- **ìƒíƒœê´€ë¦¬**: Zustand 5 + localStorage persist
- **AI**: @anthropic-ai/sdk
  - ì‹œë®¬ë ˆì´ì…˜: `claude-haiku-4-5-20251001` (ì €ë¹„ìš©)
  - ì„¸ë°€ ì¥ë©´: `claude-sonnet-4-5-20250929` (ê³ í’ˆì§ˆ)
- **ë‚´ë³´ë‚´ê¸°**: `docx` npm íŒ¨í‚¤ì§€ (DOCX), ìì²´ TXT/HTML
- **TypeScript**: strict mode

## ì•Œë ¤ì§„ ì´ìŠˆ & í•´ê²° ì´ë ¥
- í•œêµ­ì–´ ê²½ë¡œ `ì›¹ì†Œì„¤` â†’ Turbopack panic â†’ `next.config.ts`ì— `turbopack.root: "."` ë¡œ í•´ê²°
- `--no-turbopack` í”Œë˜ê·¸ ì—†ìŒ (Next.js 16ì—ì„œ turbopack ê¸°ë³¸)
- `CharacterStats` â†’ `Record<string, number>` ë³€í™˜ ì‹œ `unknown` ì¤‘ê°„ ìºìŠ¤íŠ¸ í•„ìš”
- `Packer.toBuffer()`ëŠ” `Uint8Array` ë°˜í™˜ â†’ `as unknown as BodyInit`
- Faction íƒ€ì… ìºìŠ¤íŠ¸: spread íŒ¨í„´ `{ ...updated[idx], [field]: val }` ì‚¬ìš©
- **ì”¨ì•— ëª¨ë“œ ìºë¦­í„° ìƒì„± ë²„ê·¸ (ìˆ˜ì •ì™„ë£Œ)**: `/create` ë§ˆë²•ì‚¬ì—ì„œ `CharacterBuilder`ì— `onSeedsChange` prop ë¯¸ì „ë‹¬ â†’ seedsê°€ storeì— ì €ì¥ ì•ˆ ë¨. `TimelineSetup`ì—ì„œë„ `setSeeds()`/`setWorldEvents()`/`setStoryDirectorConfig()` ë¯¸í˜¸ì¶œ. 3ê³³ ìˆ˜ì •ìœ¼ë¡œ í•´ê²°

## íŒŒì¼ êµ¬ì¡° (UNIFIED-INSTRUCTION ê¸°ë°˜ ì¬êµ¬í˜„ - 2026-02-10)

```
app/
â”œâ”€â”€ page.tsx                    # ë£¨íŠ¸ â†’ /projects ë¦¬ë‹¤ì´ë ‰íŠ¸
â”œâ”€â”€ layout.tsx                  # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”œâ”€â”€ globals.css                 # Tailwind v4 @theme inline + ì»¤ìŠ¤í…€ í…Œë§ˆ
â”œâ”€â”€ projects/
â”‚   â”œâ”€â”€ page.tsx                # í”„ë¡œì íŠ¸ ëª©ë¡
â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â””â”€â”€ page.tsx            # ìƒˆ í”„ë¡œì íŠ¸ (ì¥ë¥´/í†¤/ì‹œì /ì‘ê°€ ì„ íƒ)
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ page.tsx            # ì‘ê°€ ëŒ€í™” (í•µì‹¬ í™”ë©´ - ë ˆì´ì–´ êµ¬ì¶•)
â”‚       â””â”€â”€ result/
â”‚           â””â”€â”€ page.tsx        # ê²°ê³¼ë¬¼ (ì—í”¼ì†Œë“œ ë·°ì–´ + ë‚´ë³´ë‚´ê¸°)
â””â”€â”€ api/
    â”œâ”€â”€ author-chat/route.ts    # ë ˆì´ì–´ êµ¬ì¶• + ì‘ê°€ ëŒ€í™” í†µí•© (Sonnet)
    â”œâ”€â”€ generate-world-history/route.ts # ì„¸ê³„ ì—­ì‚¬ ìƒì„± (Haiku)
    â”œâ”€â”€ detail-era/route.ts     # ì‹œëŒ€ ìƒì„¸í™” (Haiku)
    â”œâ”€â”€ simulate/
    â”‚   â”œâ”€â”€ route.ts            # SSE ìŠ¤íŠ¸ë¦¬ë° ì‹œë®¬ë ˆì´ì…˜
    â”‚   â””â”€â”€ control/route.ts    # ì‹œë®¬ë ˆì´ì…˜ ì œì–´ (pause/resume/abort)
    â”œâ”€â”€ write-episode/route.ts  # ì—í”¼ì†Œë“œ ì§‘í•„ (Sonnet)
    â”œâ”€â”€ revise-episode/route.ts # ì—í”¼ì†Œë“œ ìˆ˜ì • (Sonnet)
    â”œâ”€â”€ generate-detail/route.ts # ì„¸ë°€ ì¥ë©´ ìƒì„± (Sonnet)
    â”œâ”€â”€ generate-chronology/route.ts # AI ì—°ëŒ€ê¸° ìë™ ìƒì„± (Haiku)
    â”œâ”€â”€ export/route.ts         # TXT/HTML/DOCX ë‚´ë³´ë‚´ê¸°
    â”œâ”€â”€ structure-world/route.ts # AI ì„¸ê³„ê´€ êµ¬ì¡°í™” (Haiku)
    â””â”€â”€ structure-character/route.ts # AI ìºë¦­í„° êµ¬ì¡°í™” (Haiku)

lib/
â”œâ”€â”€ types/index.ts              # ëª¨ë“  íƒ€ì… ì •ì˜ (Project, 7 Layers, WorldHistoryEra, Message, Choice ë“±)
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ project-store.ts        # ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ìŠ¤í† ì–´ (projects[], layers, messages, episodes)
â”‚   â”œâ”€â”€ simulation-store.ts     # ê¸°ì¡´ ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœ (í•˜ìœ„ í˜¸í™˜)
â”‚   â”œâ”€â”€ timeline-store.ts       # ë””í…Œì¼ ì”¬
â”‚   â””â”€â”€ editor-store.ts         # í”„ë¡œì íŠ¸/ì±•í„°
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ simulation-engine.ts    # í•µì‹¬ ì—”ì§„ (V1/V2/V3)
â”‚   â”œâ”€â”€ storyline-analyzer.ts   # ìŠ¤í† ë¦¬ë¼ì¸ ë¶„ì„
â”‚   â”œâ”€â”€ story-director.ts       # ìŠ¤í† ë¦¬ ë””ë ‰í„°
â”‚   â”œâ”€â”€ profile-calculator.ts   # í”„ë¡œí•„ ê³„ì‚°ê¸°
â”‚   â””â”€â”€ npc-detector.ts         # NPC íƒì§€
â”œâ”€â”€ presets/
â”‚   â””â”€â”€ author-personas.ts      # ì‘ê°€ í˜ë¥´ì†Œë‚˜ í”„ë¦¬ì…‹ 4ì¢…
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ simulation-prompt.ts    # V1 í”„ë¡¬í”„íŠ¸
â”‚   â”œâ”€â”€ simulation-prompt-v2.ts # V2 í”„ë¡¬í”„íŠ¸
â”‚   â””â”€â”€ detail-prompt.ts        # ì„¸ë°€ ì¥ë©´ í”„ë¡¬í”„íŠ¸
â””â”€â”€ utils/
    â”œâ”€â”€ api-client.ts           # Anthropic SDK ë˜í¼
    â”œâ”€â”€ simulation-sessions.ts  # ì„œë²„ ì‚¬ì´ë“œ ì„¸ì…˜ ê´€ë¦¬
    â”œâ”€â”€ export-txt.ts           # TXT ë‚´ë³´ë‚´ê¸°
    â”œâ”€â”€ export-html.ts          # HTML ë‚´ë³´ë‚´ê¸°
    â””â”€â”€ export-docx.ts          # DOCX ë‚´ë³´ë‚´ê¸°

components/                     # ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ (í•˜ìœ„ í˜¸í™˜ìš©)
â”œâ”€â”€ layout/        Header, Sidebar
â”œâ”€â”€ common/        ClientProviders, Toast
â”œâ”€â”€ characters/    CharacterPanel, CharacterAvatar
â”œâ”€â”€ simulation/    SimulationControl, StorylineMonitor
â””â”€â”€ ...
```

## í•µì‹¬ ì•„í‚¤í…ì²˜ (UNIFIED-INSTRUCTION ê¸°ë°˜)

### ë¼ìš°íŠ¸ êµ¬ì¡°
| ë¼ìš°íŠ¸ | ìš©ë„ |
|--------|------|
| `/` | `/projects`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ |
| `/projects` | í”„ë¡œì íŠ¸ ëª©ë¡ |
| `/projects/new` | ìƒˆ í”„ë¡œì íŠ¸ (ì¥ë¥´/í†¤/ì‹œì /ì‘ê°€ ì„ íƒ) |
| `/projects/[id]` | ì‘ê°€ ëŒ€í™” (í•µì‹¬ í™”ë©´) |
| `/projects/[id]/result` | ê²°ê³¼ë¬¼ (ì—í”¼ì†Œë“œ ë·°ì–´) |

### 7 ë ˆì´ì–´ ì‹œìŠ¤í…œ
1. **ì„¸ê³„ (World)** - ëŒ€ë¥™, ë„ì‹œ, ì§€í˜•
2. **í•µì‹¬ ê·œì¹™ (Core Rules)** - í˜ì˜ ì²´ê³„, ì¢…ì¡±, ì—­ì‚¬
3. **ì”¨ì•— (Seeds)** - ì„¸ë ¥, ì¢…ì¡±, ìœ„í˜‘, NPC
4. **ì£¼ì¸ê³µ ì„œì‚¬ (Hero Arc)** - ì£¼ì¸ê³µì˜ íƒœìƒ, í•µì‹¬ ì„œì‚¬, ëª©í‘œ
5. **ë¹ŒëŸ° ì„œì‚¬ (Villain Arc)** - ë¹ŒëŸ°ì˜ ë™ê¸°, ì„œì‚¬, ê´€ê³„
6. **ê¶ê·¹ì˜ ë–¡ë°¥ (Ultimate Mystery)** - í‘œë©´/ì§„ì‹¤, íŒíŠ¸ë“¤
7. **ì†Œì„¤ (Novel)** - ì‹œë®¬ë ˆì´ì…˜ + ì§‘í•„

### ì„¸ê³„ ì‹œë®¬ë ˆì´ì…˜ 3ë‹¨ê³„
1. **ì„¸ê³„ ì—­ì‚¬** - ìˆ˜ë°±~ì²œ ë…„ì„ ì‹œëŒ€ ë‹¨ìœ„ë¡œ ìƒì„±
2. **ì‹œëŒ€ ìƒì„¸í™”** - ì£¼ì¸ê³µ ì‹œëŒ€ 50ë…„ì„ 10ë…„ ë‹¨ìœ„ë¡œ ìƒì„¸í™”
3. **ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜** - ê¸°ì¡´ ì—”ì§„ìœ¼ë¡œ ì—°ë„ë³„ ì‹œë®¬ë ˆì´ì…˜

### í•µì‹¬ íë¦„
```
[í”„ë¡œì íŠ¸ ëª©ë¡] â†’ [ìƒˆ í”„ë¡œì íŠ¸] â†’ ì¥ë¥´/í†¤/ì‹œì /ì‘ê°€ ì„ íƒ
                                       â†“
[ì‘ê°€ ëŒ€í™”] â† 7ê°œ ë ˆì´ì–´ ìˆœì°¨ êµ¬ì¶• (ëŒ€í™”í˜•)
     â†“
ì„¸ê³„ ì—­ì‚¬ ìƒì„± â†’ ì‹œëŒ€ ìƒì„¸í™” â†’ ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜
     â†“
[ì—í”¼ì†Œë“œ ì§‘í•„] â† ì‘ê°€ì™€ í™˜ë‹˜ í”¼ë“œë°± ë£¨í”„
     â†“
[ê²°ê³¼ë¬¼] â†’ ì½ê¸°/ë‚´ë³´ë‚´ê¸°
```

### ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ì§€ì›
- `lib/store/project-store.ts` - ìƒˆ Zustand ìŠ¤í† ì–´
- `projects[]` ë°°ì—´ë¡œ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ ê´€ë¦¬
- ê° í”„ë¡œì íŠ¸ë³„ ë…ë¦½ì ì¸ layers, messages, episodes
    â”œâ”€â”€ export-txt.ts
    â”œâ”€â”€ export-html.ts
    â”œâ”€â”€ export-docx.ts
    â”œâ”€â”€ timeline-utils.ts
    â””â”€â”€ mock-data.ts

data/                              # ì²œì¶”ì˜ê°•í˜¸ ì„¸ê³„ê´€ ë°ì´í„° (JSON)
â”œâ”€â”€ index.json                     # ë°ì´í„° ì¸ë±ìŠ¤ ë° êµ¬ì¡° ê°€ì´ë“œ
â”œâ”€â”€ world-config.json              # ì„¸ê³„ê´€ ê¸°ë³¸ ì„¤ì •, ë“±ê¸‰ ì²´ê³„(1ì‹ ~10ì„ )
â”œâ”€â”€ characters.json                # ì£¼ì¸ê³µ(4ì‹ ), ì „ì„¤(1ì‹ ~4ì¡´), 5ì™•, 6ê´´
â”œâ”€â”€ locations.json                 # ì§€ì—­, ì „ëµ ê±°ì , ì¶©ëŒì§€ëŒ€
â”œâ”€â”€ factions-jeongdomaeng.json     # ì •ë„ë§¹ (êµ¬íŒŒì¼ë°©, 10ì„ )
â”œâ”€â”€ factions-palgahoe.json         # íŒ”ê°€íšŒ (8ëŒ€ ì„¸ê°€, 8ì„±)
â”œâ”€â”€ factions-heukdoryeon.json      # í‘ë„ë ¨ (7ì¶• ì‚¬íŒŒ, 7ê·€)
â”œâ”€â”€ factions-magyo.json            # ë§ˆêµ (êµì£¼, 9ë§ˆ, 6ëŒ€ ë¬´ë ¥ëŒ€)
â”œâ”€â”€ factions-seoe.json             # ì„¸ì™¸ì„¸ë ¥ (5ì™•, ë¶í•´ë¹™ê¶ ë“±)
â””â”€â”€ antagonist-hyungiwon.json      # ë°°í›„ì„¸ë ¥ í˜„ê¸°ì› (í™©ì‹¤ ë¹„ë°€ì¡°ì§)
```

---

## ì²œì¶”ì˜ê°•í˜¸ ì„¸ê³„ê´€ ë°ì´í„° êµ¬ì¡° (2026-02-23 ì¶”ê°€)

`data/` í´ë”ì— ë¬´í˜‘ ì†Œì„¤ "ì²œì¶”ì˜ê°•í˜¸" ì„¸ê³„ê´€ì´ JSON í˜•íƒœë¡œ êµ¬ì¡°í™”ë˜ì–´ ìˆë‹¤.

### ë°ì´í„° íŒŒì¼ ì„¤ëª…

| íŒŒì¼ | ë‚´ìš© |
|------|------|
| `index.json` | ì „ì²´ ë°ì´í„° ì¸ë±ìŠ¤, íŒŒì¼ ê°„ ì°¸ì¡° ê´€ê³„, ì‚¬ìš©ë²• |
| `world-config.json` | ì„¸ê³„ê´€ ê¸°ë³¸ ì •ë³´, ë“±ê¸‰ ì²´ê³„(1ì‹ ~10ì„ ), 5ëŒ€ ì„¸ë ¥ ê°œìš” |
| `characters.json` | ì£¼ì¸ê³µ 4ì¸(ì²œì¶”ë‹¨ ì‚¬ì‹ ), ì „ì„¤(1ì‹ ~4ì¡´), 5ì™•, 6ê´´ |
| `locations.json` | ì„¸ë ¥ë³„ ì˜í† , ì¶©ëŒì§€ëŒ€, ì£¼ìš” êµí†µë¡œ(ìœ¡ë¡œ/ìˆ˜ë¡œ/í•´ë¡œ) |
| `factions-*.json` | ê° ì„¸ë ¥ë³„ ìƒì„¸ ë°ì´í„° (êµ¬ì„±ì›, ì¡°ì§ êµ¬ì¡°, ê´€ê³„) |
| `antagonist-hyungiwon.json` | ë°°í›„ì„¸ë ¥ í˜„ê¸°ì› (ì¡°ì§, ì‘ì „ í”„ë¡œí† ì½œ, ì¹¨íˆ¬ ì „ëµ) |

### ë“±ê¸‰ ì²´ê³„ (1ì‹ ~10ì„ )

```
1ì‹ (ç¥)  â†’ ì ˆëŒ€ì  ê²½ì§€, ì „ì„¤ (ì²œê·¹ë¬´ì‹ )
2í™©(çš‡)  â†’ í™©ì œê¸‰ ì ˆëŒ€ì (ë§ˆí™©, ë¹™í™©)
3ì œ(å¸)  â†’ ì œì™•ê¸‰ ê³ ìˆ˜ (ê²€ì œ, í˜ˆì œ, ë¬´ì œ)
4ì¡´(å°Š)  â†’ ì¡´ì¹­ê¸‰ ì „ì„¤ (ê²€ì¡´, ë„ì¡´, ì°½ì¡´, ì•”ì¡´)
5ì™•(ç‹)  â†’ í˜„ì„¸ëŒ€ ì ˆëŒ€ì (ë¶ë¹™ì™•, ì„œë²•ì™•, ë‚¨ë…ì™•, ë™ì²œì™•, ì¤‘ë‘ì™•)
6ê´´(æ€ª)  â†’ ê´´ìƒí•œ ì ˆëŒ€ ì „ë ¥ (ì£¼ê´´, ë³‘ê´´, í­ê´´, ì‹ê´´, í˜ˆê´´, ìŒê´´)
7ê·€(é¬¼)  â†’ í‘ë„ë ¨ 7ì¶• ëŒ€í‘œ (í˜ˆê·€, ìˆ˜ê·€, ì‚´ê·€, ì˜¤ê·€, ëª¨ê·€, ì˜ê·€, ë„ê·€)
8ì„±(è–)  â†’ íŒ”ê°€íšŒ 8ì¶• ëŒ€í‘œ (ê²€ì„±, ì•”ì„±, ì§€ì„±, ì°½ì„±, ë„ì„±, ê¶Œì„±, ë§Œì„±, ê´‘ì„±)
9ë§ˆ(é­”)  â†’ ë§ˆêµ í•µì‹¬ ê°„ë¶€ (í˜ˆë§ˆ, ë…ë§ˆ, ê´‘ë§ˆ, ê²€ë§ˆ, ë„ë§ˆ, ë¹„ë§ˆ, ìŒë§ˆ, ê·€ë§ˆ, ìš”ë§ˆ)
10ì„ (ä»™) â†’ ì •ë„ë§¹ ì¥ë¬¸ì¸ (ë¶ˆì„ , ë„ì„ , í™”ì„ , ì°½ì„ , ì¼ì„ , ë‚¨ì„ , ê°•ì„ , í˜œì„ , ë²½ì„ , ì·¨ì„ )
```

### ì£¼ì¸ê³µ â€” ì²œì¶”ë‹¨ ì‚¬ì‹ (å››ç¥)

| ìƒì§• | ì´ë¦„ | íŠ¹ì§• |
|------|------|------|
| í˜„ë¬´ | ê°•í˜„(å§œç„) | ì²œì¶”ë‹¨ ì°½ë¦½ì, í˜„ì²œë¬¸ ê³„ìŠ¹ì, ë¬´ì‹ ì˜ ê³„ë³´ |
| ì²­ë£¡ | ì—¬ìš´ì²­(é¤˜é›²é‘) | ë¶ë³€ ì¥êµ°ê°€ ì¶œì‹ , ì˜ë¦¬ì˜ ì¤‘ì‹¬ |
| ì£¼ì‘ | ì§„í™(è¾°ç´…) | ê´‘ë§ˆì˜ ì•„ë“¤, ë¶€ì ëŒ€ë¦½ ì„œì‚¬ |
| ë°±í˜¸ | ì„¤ë¬´ë°±(è–›æ­¦ç™½) | ë°°í›„ì„¸ë ¥ ì‹¤í—˜ì²´ íƒˆì¶œ, ì˜ë¦¬íŒŒ |

### 5ëŒ€ ì„¸ë ¥ êµ¬ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ê°•í˜¸ ì„¸ë ¥ êµ¬ë„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì •ë„ë§¹(æ­£é“ç›Ÿ)          vs          í‘ë„ë ¨(é»‘é“è¯)        â”‚
â”‚  â”œâ”€ êµ¬íŒŒì¼ë°©                        â”œâ”€ 7ê·€ (ì‚¬íŒŒ 7ì¶•)      â”‚
â”‚  â””â”€ 10ì„  ì¥ë¬¸ì¸                     â””â”€ ë ¨ì£¼: í˜ˆê·€ ê³½ì²œë¥œ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  íŒ”ê°€íšŒ(å…«å®¶æœƒ)          vs           ë§ˆêµ(é­”æ•)          â”‚
â”‚  â”œâ”€ 8ëŒ€ ì„¸ê°€ (8ì„±)                  â”œâ”€ êµì£¼: íŒŒì²œë§ˆí™©      â”‚
â”‚  â””â”€ íšŒì£¼: ê´‘ì„± ëª¨ìš©ì²œíœ˜              â””â”€ 9ë§ˆ + 6ëŒ€ ë¬´ë ¥ëŒ€   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               ì„¸ì™¸ì„¸ë ¥ (5ì™•) â€” ì¤‘ì› ë°”ê¹¥                   â”‚
â”‚  ë¶ë¹™ì™•(ë¶í•´ë¹™ê¶) / ì„œë²•ì™•(ì„œì—­ë°€êµ) / ë‚¨ë…ì™•(ë‚¨ë§Œì—°í•©)     â”‚
â”‚  ë™ì²œì™•(ë™í•´êµ°ë„) / ì¤‘ë‘ì™•(íŒ¨ì²œë‘ë¶€)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          ë°°í›„ì„¸ë ¥ â€” í˜„ê¸°ì›(ç„æ©Ÿé™¢) â€” í™©ì‹¤ ë¹„ë°€ì¡°ì§          â”‚
â”‚  ëª©í‘œ: ë¬´ë¦¼ì„ ì œë„ê¶Œìœ¼ë¡œ í¡ìˆ˜                              â”‚
â”‚  ìˆ˜ë‹¨: í•©ë²•í™” â†’ ë¶„ì ˆí™” â†’ ëŒ€ë¦¬ì „ ìœ ë„                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° í™œìš©

- **ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„**: ìºë¦­í„°/ì„¸ë ¥ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì´ë²¤íŠ¸ ìƒì„±
- **ì‘ê°€ AI**: ì„¸ê³„ê´€ ì„¤ì •ì„ ì°¸ì¡°í•˜ì—¬ ì¼ê´€ëœ ì†Œì„¤ ì§‘í•„
- **ì¼ê´€ì„± ê²€ì¦**: ìºë¦­í„° ê´€ê³„, ì„¸ë ¥ êµ¬ë„, ë“±ê¸‰ ì²´ê³„ ê²€ì¦

---

## í•µì‹¬ ì•„í‚¤í…ì²˜

### ìºë¦­í„° ì‹œìŠ¤í…œ (V1 + V2 ê³µì¡´)

**V1 (ê¸°ì¡´):** `Character` íƒ€ì…ìœ¼ë¡œ í•˜ë“œì½”ë”©ëœ í”„ë¡œí•„. CHARACTERS ìƒìˆ˜ì—ì„œ ì‹œì‘.

**V2 (ê²½í—˜ ë ˆì´ì–´):** `CharacterSeed` â†’ `Memory` ì¶•ì  â†’ `EmergentProfile` ë°œí˜„.
- `seeds[]`ê°€ ì¡´ì¬í•˜ë©´ V2 íŒŒì´í”„ë¼ì¸ ìë™ í™œì„±í™” (`isV2` getter)
- `ProfileCalculator.computeProfile(seed, memories)` â†’ EmergentProfile
- `ProfileCalculator.toCharacter(seed, memories, year)` â†’ Character (í•˜ìœ„ í˜¸í™˜ ë¸Œë¦¿ì§€)
- í•˜ìœ„ ì‹œìŠ¤í…œ(í¸ì§‘ê¸°, ë‚´ë³´ë‚´ê¸°, í†µê³„)ì€ Character íƒ€ì…ë§Œ ì†Œë¹„í•˜ë¯€ë¡œ ë³€ê²½ ë¶ˆí•„ìš”

### ë°ì´í„° íë¦„
```
1. í”„ë¦¬ì…‹ ë¡œë“œ / /create ë§ˆë²•ì‚¬ (6ë‹¨ê³„)
   â†’ setCharacters() + setSeeds() + setWorldEvents()
   â†’ setStoryDirectorConfig()  [ìŠ¤í† ë¦¬ ë””ë ‰í„°]
   â†’ setMonitorConfig()        [ëª¨ë‹ˆí„°ë§ ì„¤ì •]
   â†’ localStorageì— projectConfig ì €ì¥

2. ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘
   â†’ POST /api/simulate (config, characters, seeds?, memoryStacks?,
      grammarConfig?, characterArcs?, npcPool?,
      storyDirectorConfig?, worldSettingsFull?, monitorConfig?)
   â†’ ì„¸ì…˜ ìƒì„± (sessionId, AbortController, pauseFlag)
   â†’ SSE: session_init â†’ progress â†’ storyline_preview â†’ integrated_storyline â†’ auto_paused â†’ events â†’ final_state

3. ì‹œë®¬ë ˆì´ì…˜ ì œì–´
   â†’ POST /api/simulate/control { sessionId, action: 'pause'|'resume'|'abort' }
   â†’ activeSessions Mapì—ì„œ ì„¸ì…˜ ì¡°íšŒ â†’ pauseFlag/abortController ì¡°ì‘

4. SSE ì´ë²¤íŠ¸ ìˆ˜ì‹  (SimulationControl)
   â†’ session_init â†’ setSessionId()
   â†’ completed â†’ addEvents()
   â†’ storyline_preview â†’ setStorylinePreview()
   â†’ integrated_storyline â†’ setIntegratedStoryline()
   â†’ auto_paused â†’ setSimulationStatus('paused') + setPendingWarning()
   â†’ final_state â†’ setCharacters/Memories/Profiles/Arcs/NPC + addSimulationRun()
   â†’ done â†’ setRunning(false) + ì´ë ¥ ê¸°ë¡

5. ì„¸ë°€ ì¥ë©´ ìƒì„±
   â†’ POST /api/generate-detail (character, event, worldContext,
      authorPersona?, worldSettings?)
   â†’ buildDetailPromptì— í˜ë¥´ì†Œë‚˜/ê°ê°ì •ë³´ ì£¼ì…

6. UI ë Œë”ë§
   â†’ StorylineMonitor: ê±´ê°•ë„ ë°” + ìºë¦­í„°ë³„ ì§€í‘œ + ê²½ê³  + êµì°¨ë¶„ì„
   â†’ StorylineWarningPopup: Critical ì‹œ ìë™ íŒì—… (ë¬´ì‹œ/ì •ì§€/ì¤‘ë‹¨)
   â†’ SimulationHistory: ì´ë ¥ ëª©ë¡ + ìŠ¤ëƒ…ìƒ· í™•ì¸
   â†’ CharacterPanel: profile/memories/role props
   â†’ TimelineView: imprints ì•„ì´ì½˜ ë°°ì§€
   â†’ StatsOverview: í…ì…˜ ì»¤ë¸Œ + ìŠ¤í† ë¦¬ ë””ë ‰í„° í†µê³„
   â†’ Dashboard: ë¡œê·¸ë¼ì¸, ì—­í•  ë°°ì§€, NPC ìœ„ì ¯, ì—°ëŒ€ê¸° ë°”
```

### ìŠ¤í† ì–´ êµ¬ì¡° (simulation-store)
```typescript
// V1 (ê¸°ì¡´)
isRunning, currentYear, progress, characters[], events[], worldEvents[]

// V2 (ê²½í—˜ ë ˆì´ì–´)
seeds: CharacterSeed[]
memoryStacks: Record<string, Memory[]>  // characterId â†’ memories
profiles: Record<string, EmergentProfile>  // characterId â†’ profile

// ì„œì‚¬ ë¬¸ë²•
grammarConfig: NarrativeGrammarConfig
characterArcs: CharacterArc[]
masterArc: MasterArc | null

// NPC
npcPool: NPCPool  // { npcs: NPC[], maxSize: 30 }

// ìŠ¤í† ë¦¬ ë””ë ‰í„°
storyDirectorConfig?: StoryDirectorConfig  // Aì¤‘ì‹¬ì„œì‚¬ + í˜ë¥´ì†Œë‚˜

// ì”¨ì•— ìˆ˜ì •
seedEditHistory: SeedEditLog[]

// ìŠ¤í† ë¦¬ë¼ì¸ ëª¨ë‹ˆí„°ë§
simulationStatus: SimulationStatus  // 'idle'|'running'|'paused'|'completed'|'aborted'
sessionId: string | null
storylinePreviews: Record<string, StorylinePreview>
integratedStoryline: IntegratedStoryline | null
monitorConfig: StorylineMonitorConfig  // { previewFrequency, autoPauseOnCritical, integratedAnalysisEnabled }
simulationHistory: SimulationRun[]
pendingWarning: IntegratedStoryline | null  // non-null â†’ ê²½ê³  íŒì—… í‘œì‹œ

// ëª¨ë‘ localStorage persist ëŒ€ìƒ
```

### ì‹œë®¬ë ˆì´ì…˜ ì œì–´ ë©”ì»¤ë‹ˆì¦˜

**Pause/Resume:**
- ì„œë²„ ì—”ì§„ ë‚´ë¶€ì— `pauseFlag: { paused: boolean }` ë®¤í„°ë¸” ê°ì²´
- `lib/utils/simulation-sessions.ts`ì— `activeSessions` Mapìœ¼ë¡œ ì„¸ì…˜ ê´€ë¦¬
- SSE routeì™€ control routeê°€ ê°™ì€ ëª¨ë“ˆ import â†’ ê°™ì€ Map ì°¸ì¡°
- ì—”ì§„ ë£¨í”„ê°€ ë§¤ yearë§ˆë‹¤ `pauseFlag.paused`ë¥¼ í´ë§ (500ms ê°„ê²©)
- í´ë¼ì´ì–¸íŠ¸ â†’ POST `/api/simulate/control` â†’ Mapì—ì„œ ì„¸ì…˜ ì¡°íšŒ â†’ pauseFlag í† ê¸€

**Abort:**
- `AbortController` + `AbortSignal`
- SSE routeì—ì„œ ìƒì„±, ì—”ì§„ì— signal ì „ë‹¬
- ì—”ì§„ ë£¨í”„ê°€ ë§¤ yearë§ˆë‹¤ `abortSignal.aborted` ì²´í¬
- ReadableStreamì˜ `cancel()` ì½œë°±ì—ì„œë„ abort íŠ¸ë¦¬ê±°

**ìŠ¤í† ë¦¬ë¼ì¸ ëª¨ë‹ˆí„°ë§:**
- `StorylineAnalyzer` â€” Haiku(`generateStructure`, temp 0.2, max 1024)ë¡œ í”„ë¦¬ë·° ìƒì„±
- `shouldGeneratePreview()` â€” auto: turning_point ì´ë²¤íŠ¸, semi_auto: 5ë…„ë§ˆë‹¤, manual/off: false
- í”„ë¦¬ë·° â†’ SSE `storyline_preview` â†’ í†µí•© ë¶„ì„ â†’ SSE `integrated_storyline`
- `storyHealth === 'critical' && autoPauseOnCritical` â†’ ìë™ ì¼ì‹œì •ì§€ + ê²½ê³  íŒì—…

### ê¸°ì–µ ê°ì¸ ì‹œìŠ¤í…œ (ImprintType)
| íƒ€ì… | ì•„ì´ì½˜ | ì„¤ëª… |
|------|--------|------|
| insight | ğŸ§  | ê¹¨ë‹¬ìŒ |
| emotion | ğŸ’­ | ê°ì • ê°ì¸ |
| skill | âš”ï¸ | ê¸°ìˆ  ìŠµë“ |
| speech | ğŸ’¬ | ë§íˆ¬/í™”ë²• |
| name | ğŸ“› | ì´ë¦„/ì´ëª… íšë“ |
| relationship | ğŸ¤ | ê´€ê³„ í˜•ì„± |
| trauma | ğŸ©¸ | íŠ¸ë¼ìš°ë§ˆ |
| belief | âœ¨ | ì‹ ë…/ê°€ì¹˜ê´€ |

### ê¸°ë³¸ ìºë¦­í„° (ì„œë¬¸ëŒ€ë¥™ í”„ë¦¬ì…‹)
| ID | ì½”ë“œëª… | ì´ë¦„(V1) | ìƒ‰ìƒ | birthYear |
|----|--------|----------|------|-----------|
| yoon-seojin | ê¸ˆì„œê³ ì˜ ì•„ì´ | ìœ¤ì„œì§„ | #7B6BA8 | -3 |
| ha-yeonhwa | ë…í™”ì˜ ì•„ì´ | í•˜ì—°í™” | #C74B50 | -2 |
| baek-muhan | ì„œì | ë°±ë¬´í•œ | #D4D0E0 | -5 |

### SimulationEngine ëª¨ë“œ
| ëª¨ë“œ | ì¡°ê±´ | V1 ë©”ì„œë“œ | V2 ë©”ì„œë“œ |
|------|------|-----------|-----------|
| ê°œë³„ | !batchMode | runYear() | runYearV2() |
| ë¬¶ìŒ | batchMode | runYearBatched() | runYearBatchedV2() |
| ìœ ë…„ê¸° | ëª¨ë‘ 0~5ì„¸ | runYearRange() | runYearRangeV2() |

### SimulationEngine í™•ì¥ íŒŒë¼ë¯¸í„°
```typescript
constructor(
  config, existingEvents?, existingCharacters?, seeds?, memoryStacks?,
  grammarConfig?, existingCharacterArcs?, existingMasterArc?, npcPool?,
  storyDirectorConfig?, worldSettingsFull?,
  abortSignal?, pauseFlag?, monitorConfig?, theme?
)
```

### ìŠ¤í† ë¦¬ ë””ë ‰í„° ì‹œìŠ¤í…œ

**4ë ˆì´ì–´ ì„¸ê³„ê´€ êµ¬ì¶•:**
- Layer 1: `WorldCoreRule` â€” í•µì‹¬ ë²•ì¹™ (law, cost, implication)
- Layer 2: `WorldHistoricalWound` â€” ì—­ì‚¬ì  ìƒì²˜ (event, consequence, livingMemory)
- Layer 3: `WorldCurrentTension` â€” í˜„ì¬ ê°ˆë“± (faction, desire, method, blocked)
- Layer 4: ê°ê°/ì‚¬íšŒ/ì¼ìƒ (sensoryDetails[], socialNorms[], dailyLife[])

**ì‘ê°€ í˜ë¥´ì†Œë‚˜:** `lib/presets/author-personas.ts`
| í”„ë¦¬ì…‹ | ì½”ë“œ | íŠ¹ì§• |
|--------|------|------|
| ì—´í˜ˆì „íˆ¬í˜• | PERSONA_BATTLE | ì§§ì€ ë¬¸ì¥, ì˜ì„±ì–´, íŒŒì›Œì—… |
| ë‹¤í¬ì„œì‚¬í˜• | PERSONA_DARK | ë‚´ë©´ ë…ë°±, ë„ë•ì  ëª¨í˜¸í•¨ |
| ê°ì„±ì„œì •í˜• | PERSONA_LYRICAL | ìì—° ë¬˜ì‚¬, ê°ì • ì€ìœ  |
| ì‹ ë¬´í˜‘ì •í†µí˜• | PERSONA_CLASSIC | í•œë¬¸ í˜¼ìš©, ì ˆì œëœ ê°ì • |

**Aì¤‘ì‹¬ ì„œì‚¬ êµ¬ì¡°:**
- `StoryDirectorConfig` â€” protagonistId, ratio(A:B:C ê¸°ë³¸ 6:2:2), characterRoles, logline
- `StoryDirector.buildADirective()` â†’ A ì¤‘ì‹¬ í”„ë¡¬í”„íŠ¸ ë£° ìƒì„±
- `StoryDirector.composeStory()` â†’ A-relevance ì²´í¬ í›„ ì—í”¼ì†Œë“œ ë¶„í• 
- `ARelevanceCheck` â€” direct_impact / foreshadow / theme_mirror / hidden_truth

**ë°ì´í„° íë¦„:**
```
/create wizard (6ë‹¨ê³„):
  Step 1: WorldBuilder â†’ worldSettings (4ë ˆì´ì–´ ì„¸ê³„ê´€ í¬í•¨)
  Step 1.5: ChronologyBuilder â†’ worldSettings.chronology (ì—°ëŒ€ê¸°)
  Step 2: CharacterBuilder â†’ characters[] + seeds[] (ì”¨ì•— ëª¨ë“œ ì‹œ onSeedsChange)
  Step 3: RelationshipBuilder â†’ relationships[]
  Step 4: StorySetup â†’ storyDirectorConfig (ë¡œê·¸ë¼ì¸, ì—­í• , í˜ë¥´ì†Œë‚˜)
  Step 5: TimelineSetup â†’ storeì— ì¼ê´„ ì €ì¥:
    - setCharacters() + setSeeds() + setWorldEvents() + setStoryDirectorConfig() + setMonitorConfig()
    - localStorageì— projectConfig ì €ì¥ (monitorConfig í¬í•¨)

ì‹œë®¬ë ˆì´ì…˜ ì‹œ:
  â†’ SimulationControl â†’ API request bodyì— monitorConfig í¬í•¨
  â†’ SimulationEngine constructorì— abortSignal, pauseFlag, monitorConfig, theme ì „ë‹¬
  â†’ ë§¤ yearë§ˆë‹¤: abort ì²´í¬ â†’ pause í´ë§ â†’ ì‹œë®¬ â†’ í”„ë¦¬ë·° ìƒì„±(ì¡°ê±´ë¶€) â†’ í†µí•© ë¶„ì„ â†’ auto-pause

UI í‘œì‹œ:
  â†’ CharacterPanel: A/B/C ì—­í•  ë°°ì§€
  â†’ SimulationControl: ì‹œì‘/ì¼ì‹œì •ì§€/ì¬ê°œ/ì¤‘ë‹¨ ë²„íŠ¼ + "ìŠ¤í† ë¦¬ ë””ë ‰í„°" ë°°ì§€
  â†’ StorylineMonitor: ê±´ê°•ë„ ë°” + 4ì§€í‘œ + ê²½ê³  + ìˆ˜ë ´/ë°°ì‹ /ê¶Œì¥
  â†’ StorylineWarningPopup: Critical ê°ì§€ ì‹œ ëª¨ë‹¬
  â†’ SimulationHistory: ì´ë ¥ ëª©ë¡ (ì ‘ê¸°/í¼ì¹˜ê¸° + ìŠ¤ëƒ…ìƒ·)
  â†’ Dashboard: ë¡œê·¸ë¼ì¸ í‘œì‹œ, ì—°ëŒ€ê¸° ë°”
```

### ì‘ê°€ AI v2 ì‹œìŠ¤í…œ
**ê´€ê³„ í™”í•™ì‘ìš©:** `Relationship`ì— `dynamic?`, `frictionPoints?`, `resonancePoints?`, `history?` í•„ë“œ ì¶”ê°€. ê´€ê³„ë„ UIì—ì„œ ê°„ì„ ì— dynamic í‘œì‹œ, í˜¸ë²„ ì‹œ friction/resonance ìƒì„¸.

**ê°ì„± ëª¨ë©˜í…€:** `StorylineMetrics`ì— `awakeningPotential` (0~100) ì¶”ê°€. ì‹œë®¬ë ˆì´ì…˜ í”„ë¡¬í”„íŠ¸ì— ì „í™˜ì  ê·œì¹™ (ì¶•ì â†’í­ë°œ). íƒ€ì„ë¼ì¸ì—ì„œ `turning_point` ì´ë²¤íŠ¸ë¥¼ â˜… + ê³¨ë“œ í…Œë‘ë¦¬ + "TURNING POINT" ë¼ë²¨ë¡œ ê°•ì¡°.

**ë§ˆì¼ìŠ¤í†¤ (Anchor Events):** `AnchorEvent` íƒ€ì…, `WorldSettings.anchorEvents?` í•„ë“œ. ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„ì´ í•´ë‹¹ ì—°ë„ì— ê°•ì œ ì‚¬ê±´ ì£¼ì… (ìƒí™©ë§Œ ê°•ì œ, ë°˜ì‘ì€ ì‹œë®¬ë ˆì´ì…˜). `/create` Step 5ì—ì„œ ì…ë ¥ UI (ì—°ë„, ì‚¬ê±´, ì„¸ê³„ ì˜í–¥, ìºë¦­í„°ë³„ ìƒí™©). íƒ€ì„ë¼ì¸ì— âš“ ì•„ì´ì½˜.

**ì¶œë ¥ í€„ë¦¬í‹°:** ì‹œë®¬ë ˆì´ì…˜ í”„ë¡¬í”„íŠ¸(V2)ì— Show Don't Tell / êµ¬ì²´ì  ê°ê° / ì§§ê³  ê°•ë ¬ / í–‰ë™ìœ¼ë¡œ ì„±ê²© / sensory ì˜¤ê° ê·œì¹™ ì¶”ê°€. ì„¸ë°€ ì¥ë©´ í”„ë¡¬í”„íŠ¸ì— ì¶œë ¥ í€„ë¦¬í‹° ì ˆëŒ€ ê·œì¹™ (ê°ì • ì„¤ëª… ê¸ˆì§€, ë¬˜ì‚¬ì  ì„œìˆ ë§Œ, ëŒ€ì‚¬ ì§§ê²Œ, 70/30 ë²•ì¹™).

### ì„¤ê³„ í—Œë²• (Design Constitution)
í•µì‹¬ ì›ì¹™:
- **í•˜ë“œì½”ë”© í—ˆìš©**: ì„¸ê³„ê´€, ì‹œê°„ì¶•, ì‘ê°€ í˜ë¥´ì†Œë‚˜(ë¬¸ì²´)
- **í•˜ë“œì½”ë”© ê¸ˆì§€**: ìºë¦­í„° ì„±ê²©/ê°€ì¹˜ê´€/ë™ê¸°/ì™¸í˜•/ëŠ¥ë ¥/ëŒ€ì‚¬/ê´€ê³„
- **ì‹œë®¬ë ˆì´ì…˜ì€ ì¤‘ë¦½**: A-directive/charm ì£¼ì… ê¸ˆì§€
- **StoryDirectorëŠ” í¸ì§‘ ë‹¨ê³„ ë„êµ¬ë¡œë§Œ** ì‚¬ìš©

### ì™„ë£Œëœ ê¸°ëŠ¥ ëª©ë¡
1. **í”„ë¡œì íŠ¸ ì„¤ì •**: íƒ€ì…, ìŠ¤í† ì–´, UI (mock data)
2. **Claude API í†µí•©**: ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„ + SSE ìŠ¤íŠ¸ë¦¬ë° + localStorage ì˜ì†
3. **ì„¸ë°€ ì¥ë©´ ìƒì„±**: Sonnet ê¸°ë°˜ + 3ì—´ DnD í¸ì§‘ê¸° + ë„¤ë¹„ê²Œì´ì…˜
4. **ë‚´ë³´ë‚´ê¸°**: TXT/HTML/DOCX + í†µê³„ + ê´€ê³„ë„ + í† ìŠ¤íŠ¸ + ë°ì´í„° ê´€ë¦¬ + ì˜¨ë³´ë”©
5. **ìµœì í™”+ì»¤ìŠ¤í…€ë¹Œë”**: API ëª¨ë¸ ë¶„ë¦¬ + í”„ë¡¬í”„íŠ¸ ì••ì¶• + ë¬¶ìŒ ëª¨ë“œ + /create ë§ˆë²•ì‚¬ + í”„ë¦¬ì…‹
6. **ê²½í—˜ ë ˆì´ì–´**: ì”¨ì•—â†’ê²½í—˜â†’ë°œí˜„ ì‹œìŠ¤í…œ (CharacterSeedâ†’Memoryâ†’EmergentProfile)
7. **ì„œì‚¬ ë¬¸ë²• ì—”ì§„**: ì„œì‚¬ ì•„í¬ + ë¹„íŠ¸ ì¶”ì  + í…ì…˜ ì»¤ë¸Œ + í”„ë¡¬í”„íŠ¸ ìœ ë„
8. **NPC Emergence**: ìì—° ë°œìƒ NPC + lifecycle + í”„ë¡¬í”„íŠ¸ ì£¼ì… + ëŒ€ì‹œë³´ë“œ ìœ„ì ¯
9. **ìŠ¤í† ë¦¬ ë””ë ‰í„°**: 4ë ˆì´ì–´ ì„¸ê³„ê´€ + ì‘ê°€ í˜ë¥´ì†Œë‚˜ 4ì¢… + Aì¤‘ì‹¬ ì„œì‚¬(6:2:2)
10. **ì„¤ê³„ í—Œë²• ê°ì‚¬**: UI í•˜ë“œì½”ë”© ì œê±° + CharmDevice ì‚­ì œ + ì‹œë®¬ ì¤‘ë¦½í™” + NPC role ììœ í™” + ì™¸í˜• í•„ë“œ
11. **ì”¨ì•— ìˆ˜ì •+ì—°ëŒ€ê¸°**: soft_edit/hard_reset + ë˜ê°ê¸° + ì„¸ê³„ ì—°ëŒ€ê¸° CRUD/AIìƒì„± + ëŒ€ì‹œë³´ë“œ ì—°ëŒ€ê¸° ë°”
12. **ìŠ¤í† ë¦¬ë¼ì¸ ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ í”„ë¦¬ë·° + í†µí•© ë¶„ì„ + auto-pause + ê²½ê³  íŒì—… + pause/resume/abort + ì´ë ¥ ê´€ë¦¬
13. **ì‘ê°€ AI v2**: ê´€ê³„ í™”í•™ì‘ìš©(dynamic/friction/resonance) + ê°ì„± ëª¨ë©˜í…€(awakeningPotential+turning_point ê°•ì¡°) + ë§ˆì¼ìŠ¤í†¤(AnchorEvent ê°•ì œ ì£¼ì…+UI) + ì¶œë ¥ í€„ë¦¬í‹°(Show Don't Tell)
14. **ì‘ê°€ AI as God**: ì„œì‚¬ ì•„í¬ ì„¤ê³„ + ë™ì  ë””ë ‰ì…˜ + í•˜ë“œì½”ë”© ì œê±° + ì•„í¬ ê²€í† /ìˆ˜ì • UI
15. **UI ë·° ê°œì„ **: ìºë¦­í„° ì„±ì¥ ë·° (/characters) + ì‘ê°€ ì§‘í•„ ë·° (/author 4íƒ­) + ë„¤ë¹„ê²Œì´ì…˜ í™•ì¥ + ì—í”¼ì†Œë“œ/ì½”ë©˜íŠ¸/ë–¡ë°¥ ì‹œìŠ¤í…œ

> **ëª¨ë“  ì§€ì‹œì„œ ì™„ë£Œ (ì²´í¬í¬ì¸íŠ¸ 1-145).** í”„ë¡œë•ì…˜ ë¹Œë“œ í†µê³¼ í™•ì¸ (2026-02-08).

### ì‘ê°€ AI as God ì‹œìŠ¤í…œ (ì²´í¬í¬ì¸íŠ¸ 99-115 ì™„ë£Œ)

**í•µì‹¬ ê°œë…:** ì‘ê°€ AIê°€ ì‹œë®¬ë ˆì´ì…˜ì˜ "ì‹ (God)"ì´ ë˜ì–´, ì‹œë®¬ë ˆì´ì…˜ ì „ì— ì„œì‚¬ ì•„í¬ë¥¼ ì„¤ê³„í•˜ê³  ë§¤ ì—°ë„ë§ˆë‹¤ ë™ì  ë””ë ‰ì…˜ì„ ìƒì„±. ê¸°ì¡´ í•˜ë“œì½”ë”©ëœ ë‚˜ì´ë³„ ê°€ì´ë“œ ì œê±°.

**íë¦„:**
```
í™˜ë‹˜ â†’ ì£¼ì œ+ë°©í–¥ â†’ ì‘ê°€ AIê°€ ìºë¦­í„°ë³„ ì„œì‚¬ ì•„í¬ ì„¤ê³„ (ì‹œë®¬ ì‹œì‘ ì „)
ë§¤ ì—°ë„: Profile ê³„ì‚° â†’ í•©ì¹œ í”„ë¡¬í”„íŠ¸(ì‘ê°€ ë””ë ‰ì…˜+ì‹œë®¬ë ˆì´ì…˜ 1íšŒ í˜¸ì¶œ) â†’ ìºë¦­í„° ììœ¨ ë°˜ì‘
â†’ AuthorDirectionì˜ phaseTransitionìœ¼ë¡œ ì•„í¬ í˜ì´ì¦ˆ ìë™ ì „í™˜
â†’ turning_point ì´ë²¤íŠ¸ ê°ì§€ ì‹œ ì•„í¬ revision ê¸°ë¡
â†’ validateEvents í•„í„°ë¡œ í‰ì˜¨í•œ ë‚˜ë‚  ì œê±°
```

**íƒ€ì…:**
- `AuthorNarrativeArc` â€” characterId, phases[], currentPhaseIndex, revisions[], designedAt
- `ArcPhase` â€” id, name, estimatedAgeRange, intent, keyMoments[], emotionalArc, endCondition
- `ArcRevision` â€” year, reason, changes
- `AuthorDirection` â€” characterId, year, age, arcPosition, narrativeIntent, worldPressure, avoid, desiredEffect, phaseTransition?

**ìƒˆ íŒŒì¼:**
- `lib/agents/author-ai-engine.ts` â€” AuthorAIEngine í´ë˜ìŠ¤ (ì•„í¬ ì„¤ê³„, ë””ë ‰ì…˜ ì²˜ë¦¬, ì•„í¬ ì¡°ì •, validateEvents)
- `lib/prompts/author-direction-prompt.ts` â€” 4ê°œ í”„ë¡¬í”„íŠ¸ ë¹Œë” (ì•„í¬ ì„¤ê³„, ê°œë³„+í•©ì¹œ, ë¬¶ìŒ+í•©ì¹œ, ìœ ë…„ê¸°+í•©ì¹œ)
- `components/simulation/ArcEditor.tsx` â€” ì„œì‚¬ ì•„í¬ ê²€í† /ìˆ˜ì • UI (ëŒ€ì‹œë³´ë“œ ìœ„ì ¯)

**ë³€ê²½ëœ íŒŒì¼:**
- `lib/types/index.ts` â€” AuthorNarrativeArc, ArcPhase, ArcRevision, AuthorDirection ì¶”ê°€, ProgressUpdateì— arc_designed/author_direction ì¶”ê°€
- `lib/prompts/simulation-prompt-v2.ts` â€” í•˜ë“œì½”ë”© ë‚˜ì´ë³„ ê°€ì´ë“œ(0~5ì„¸, 6~12ì„¸, 13+ì„¸) ì œê±°
- `lib/agents/simulation-engine.ts` â€” AuthorAIEngine í†µí•©, runFullSimulationì— ì•„í¬ ì„¤ê³„ ë‹¨ê³„, V2 ë©”ì„œë“œì— í•©ì¹œ í”„ë¡¬í”„íŠ¸, parseResponseV3WithDirection, parseBatchedResponseV3WithDirection, validateEvents, narrativeArcs íŒŒë¼ë¯¸í„°/getter
- `lib/store/simulation-store.ts` â€” narrativeArcs ìƒíƒœ + setNarrativeArcs/updateNarrativeArc ì•¡ì…˜ + persist
- `app/api/simulate/route.ts` â€” narrativeArcs íŒŒë¼ë¯¸í„° ìˆ˜ì‹  + final_stateì— í¬í•¨
- `components/simulation/SimulationControl.tsx` â€” narrativeArcs ì†¡ìˆ˜ì‹  + arc_designed SSE ì²˜ë¦¬
- `app/page.tsx` â€” ArcEditor ëŒ€ì‹œë³´ë“œ ìœ„ì ¯ í†µí•©

**ê¸°ì¡´ Grammar ì‹œìŠ¤í…œê³¼ì˜ ê´€ê³„:**
- Grammar Engine(ë¹„íŠ¸ ì¶”ì /í…ì…˜ ê´€ë¦¬)ê³¼ Author AI(ë™ì  ë””ë ‰ì…˜)ëŠ” ê³µì¡´
- Author AI ì•„í¬ê°€ ìˆìœ¼ë©´ í•©ì¹œ í”„ë¡¬í”„íŠ¸(ë””ë ‰ì…˜+ì‹œë®¬) ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ì¡´ Grammar í”„ë¡¬í”„íŠ¸ë¡œ fallback
- validateEvents: AuthorAIEngine.validateEvents() ì •ì  ë©”ì„œë“œë¡œ "í‰ì˜¨í•œ ë‚˜ë‚ " í•„í„°ë§

**API ë¹„ìš© ìµœì í™”:**
- ì•„í¬ ì„¤ê³„: Haiku(generateStructure) Ã— ìºë¦­í„° ìˆ˜ (ì‹œë®¬ ì‹œì‘ ì‹œ 1íšŒë§Œ)
- ë§¤ ì—°ë„: ë””ë ‰ì…˜+ì‹œë®¬ë ˆì´ì…˜ì„ í•©ì¹œ 1íšŒ í˜¸ì¶œ (Haiku, generateSimulation) â†’ ê¸°ì¡´ ëŒ€ë¹„ í˜¸ì¶œ ìˆ˜ ë™ì¼

### UI ë·° ê°œì„  (ì²´í¬í¬ì¸íŠ¸ 116-145 ì™„ë£Œ)

**ìºë¦­í„° ì„±ì¥ ë·° (`/characters`):**
- ìºë¦­í„° ì„ íƒ íƒ­ (íƒ­ í´ë¦­ìœ¼ë¡œ ì „í™˜)
- ì¢Œì¸¡ í”„ë¡œí•„ íŒ¨ë„: ì”¨ì•— + ë°œí˜„ í”„ë¡œí•„ + ì ì¬ë ¥ ë°” + ëŠ¥ë ¥ ë ˆë²¨ + ì™¸í˜• ë³€í™” + ê´€ê³„(NPC í¬í•¨) + ì„±í–¥(ë¹›/ì–´ë‘ , ì§ˆì„œ/í˜¼ëˆ)
- ì¤‘ì•™ ì„±ì¥ íƒ€ì„ë¼ì¸: ì„¸ë¡œ ì´ë²¤íŠ¸ ì¹´ë“œ, ì—°ë„ë³„ êµ¬ë¶„, í•„í„°(ì „ì²´/ìœ„ê¸°/ì„±ì¥/ê´€ê³„/ì „í™˜ì ) + ì •ë ¬(ì‹œê°„ìˆœ/ì¤‘ìš”ë„)
- ì´ë²¤íŠ¸ ì•„ì´ì½˜ ìë™ ë§¤í•‘: â˜…(TP) âš¡(ëŠ¥ë ¥) ğŸ‘¤(NPC) ğŸ’€(ìƒì‹¤) âš“(ì•µì»¤) ğŸŒ‘(ì¶œìƒ) ğŸ”’(ë¯¸ìŠ¤í„°ë¦¬) â—‹(ì¼ë°˜)
- TURNING POINT / ANCHOR ì‹œê°ì  ê°•ì¡° (ê³¨ë“œ í…Œë‘ë¦¬, ë¼ë²¨)
- í•˜ë‹¨ ì´ë²¤íŠ¸ ìƒì„¸ ë·°: ê°ê° ê¸°ì–µ + ê°ì¸ ìƒì„¸ + ì‘ê°€ ë””ë ‰ì…˜ + [ì„¸ë°€ ì¥ë©´ ìƒì„±] [í¸ì§‘ê¸°ë¡œ ë³´ë‚´ê¸°] ë²„íŠ¼

**ì‘ê°€ ì§‘í•„ ë·° (`/author`) â€” 4íƒ­:**
- **íƒ­ 1 (ìŠ¤í† ë¦¬ ì „ì²´)**: ì£¼ì œ+ì„¸ê³„ê´€ ìš”ì•½ / ìŠ¤í† ë¦¬ êµ¬ì¡°(MasterArc acts ì‹œê°í™”) / ìºë¦­í„° ì„œì‚¬ íë¦„ ê°€ë¡œ íƒ€ì„ë¼ì¸ / ë–¡ë°¥ í˜„í™©(planted/collected/planned + CRUD) / ì˜ˆìƒ í†µê³„(ì´í™”ìˆ˜, ì§‘í•„ì™„ë£Œ, ì‹œì ë¹„ìœ¨)
- **íƒ­ 2 (ì„œì‚¬ ì•„í¬)**: ìºë¦­í„°ë³„ ì•„í¬ í˜ì´ì¦ˆ ì‹œê°í™”(í˜„ì¬/ì™„ë£Œ/ë¯¸ë˜ êµ¬ë¶„) / í˜ì´ì¦ˆ ìƒì„¸ í¸ì§‘(ì˜ë„, í•µì‹¬ìˆœê°„ ì²´í¬ë¦¬ìŠ¤íŠ¸, ê°ì •íë¦„, ì¢…ë£Œì¡°ê±´) / ìˆ˜ì • ì´ë ¥ / ë‹¤ìŒ ë””ë ‰ì…˜ ë¯¸ë¦¬ë³´ê¸° / í˜ì´ì¦ˆ ì¶”ê°€
- **íƒ­ 3 (ì§‘í•„)**: ì—í”¼ì†Œë“œ ëª©ë¡(planned/drafted/reviewed/final ìƒíƒœ ì•„ì´ì½˜) / 3ë¶„í•  ì§‘í•„ ë·°(ì‹œë®¬ ì†ŒìŠ¤|ë³¸ë¬¸|ì‘ê°€ ë©”ëª¨) / ì´ë²¤íŠ¸ ì—°ê²° / í™” ë í›… / ìƒíƒœ ë³€ê²½+ì‚­ì œ
- **íƒ­ 4 (ì½”ë©˜íŠ¸)**: ì½”ë©˜íŠ¸ ëª©ë¡(í•„í„°: ìœ í˜•ë³„, ë¯¸í•´ê²°ë§Œ) / ì„ íƒì§€ ë²„íŠ¼ + ììœ  ì‘ë‹µ / í•´ê²°/ë¯¸í•´ê²° ìƒíƒœ / í”¼ë“œë°± ì „ì†¡

**ìƒˆ íƒ€ì…:**
- `Episode`: id, number, title, status(planned/drafted/reviewed/final), pov, sourceEventIds, content, charCount, authorNote, endHook
- `AuthorComment`: id, type(suggestion/question/discovery/warning), content, relatedTo, options?, selectedOption?, userResponse?, resolved
- `Foreshadow`: id, content, status(planted/collected/planned), plantedEpisode?, collectedEpisode?, relatedCharacters

**ë³€ê²½ íŒŒì¼:**
- `lib/types/index.ts` â€” Episode, AuthorComment, Foreshadow íƒ€ì… ì¶”ê°€
- `lib/store/simulation-store.ts` â€” episodes/authorComments/foreshadows ìƒíƒœ + CRUD ì•¡ì…˜ + persist
- `components/layout/Header.tsx` â€” [ìºë¦­í„°] [ì‘ê°€] ë„¤ë¹„ê²Œì´ì…˜ íƒ­ ì¶”ê°€
- `app/characters/page.tsx` â€” ìºë¦­í„° ì„±ì¥ ë·° (ìƒˆ íŒŒì¼)
- `app/author/page.tsx` â€” ì‘ê°€ ì§‘í•„ ë·° 4íƒ­ (ìƒˆ íŒŒì¼)

## ê°œë°œ ëª…ë ¹ì–´
```bash
npm run dev    # ê°œë°œ ì„œë²„ (Turbopack)
npx next build # í”„ë¡œë•ì…˜ ë¹Œë“œ + íƒ€ì… ì²´í¬
```

## í™˜ê²½ ë³€ìˆ˜ (.env.local)
```
ANTHROPIC_API_KEY=sk-ant-...
```

## ì§€ì‹œì„œ íŒŒì¼ í˜„í™©
| íŒŒì¼ | ì²´í¬í¬ì¸íŠ¸ | ìœ„ì¹˜ | ìƒíƒœ |
|------|-----------|------|------|
| Phase 1~4 ì§€ì‹œì„œ | 1-24 | `ì§„í–‰ì™„ë£Œ/` | âœ… ì™„ë£Œ |
| instruction-seed-edit-and-chronology.md | 25-42 | `ì§„í–‰ì™„ë£Œ/` | âœ… ì™„ë£Œ |
| instruction-storyline-monitor.md | 43-61 | `ì§„í–‰ì™„ë£Œ/` | âœ… ì™„ë£Œ |
| instruction-author-ai-v2.md | 81-98 | `ì§„í–‰ì™„ë£Œ/` | âœ… ì™„ë£Œ |
| instruction-author-as-god.md | 99-115 | ë£¨íŠ¸ | âœ… ì™„ë£Œ |
| instruction-ui-views.md | 116-145 | ë£¨íŠ¸ | âœ… ì™„ë£Œ |
| instruction-ui-simplified.md | 116-131 | ë£¨íŠ¸ | âœ… ì™„ë£Œ |
| instruction-project-creation-update.md | - | ë£¨íŠ¸ | âœ… ì™„ë£Œ |

---

## UI ì¬ì„¤ê³„ (instruction-ui-simplified) â€” ì²´í¬í¬ì¸íŠ¸ 116-131 ì™„ë£Œ

### í•µì‹¬ ë³€ê²½
ê¸°ì¡´ 8ê°œ í˜ì´ì§€ â†’ **3ê°œ í™”ë©´**ìœ¼ë¡œ ë‹¨ìˆœí™”:
1. `/project` â€” í”„ë¡œì íŠ¸ ìƒì„± (ì£¼ì œ + ìŠ¤í† ë¦¬ë¼ì¸ + ë°©í–¥ì„± + ì‘ê°€ ì„ íƒ)
2. `/conversation` â€” ì‘ê°€ ëŒ€í™” (ì±„íŒ… + ì‚¬ì´ë“œ íŒ¨ë„ 4íƒ­)
3. `/result` â€” ê²°ê³¼ë¬¼ (ì›ê³  ë·°ì–´ + ë‚´ë³´ë‚´ê¸°)

### í•µì‹¬ ë£¨í”„
```
í™˜ë‹˜ì´ ì£¼ì œ+ìŠ¤í† ë¦¬ë¼ì¸ ì…ë ¥ â†’ [ì‘ê°€ì—ê²Œ ë§¡ê¸°ê¸°]
â†’ ì‘ê°€ AIê°€ ìŠ¤í† ë¦¬ë¼ì¸ ë¶„ì„ â†’ ì„¸ê³„ê´€/ìºë¦­í„°/ì•„í¬ ìë™ ìƒì„±
â†’ ì‘ê°€ê°€ 1í™” ì‘ì„± â†’ í™˜ë‹˜ì´ ì½ìŒ â†’ í”¼ë“œë°±(ì—°ì¬ìŠ¹ì¸/ìˆ˜ì •ìš”ì²­/ë°©í–¥ë³€ê²½)
â†’ ë‹¤ìŒ í™” â†’ ë°˜ë³µ
```

### ìƒˆ íƒ€ì… (`lib/types/index.ts`)
- `SimplifiedProjectConfig` â€” ë‹¨ìˆœí™”ëœ í”„ë¡œì íŠ¸ ì„¤ì • (`storyline: string`, `protagonistCount` ì œê±°)
- `ConversationMessage` â€” ëŒ€í™” ë©”ì‹œì§€ (author, author_episode, author_choice, user)
- `ConversationChoice` â€” ì„ íƒì§€ (approve, revise, redirect ë“±)
- `GenerationProgress` â€” ìë™ ìƒì„± ì§„í–‰ ìƒíƒœ

### ìŠ¤í† ì–´ í™•ì¥ (`lib/store/simulation-store.ts`)
```typescript
// SimulationStoreConversation
simplifiedProject: SimplifiedProjectConfig | null
conversationMessages: ConversationMessage[]
generationProgress: GenerationProgress | null
currentEpisodeNumber: number

// ì•¡ì…˜
setSimplifiedProject()
addConversationMessage()
clearConversationMessages()
setGenerationProgress()
updateGenerationStep()
setCurrentEpisodeNumber()
respondToChoice()
```

### ìƒˆ í˜ì´ì§€
- `app/project/page.tsx` â€” ì£¼ì œ+ì›Œë”©+ì‘ê°€ ì„ íƒ í¼ + ìë™ ìƒì„± í”„ë¡œê·¸ë ˆìŠ¤
- `app/conversation/page.tsx` â€” ì±„íŒ… UI + ì‚¬ì´ë“œ íŒ¨ë„ 4íƒ­ (ë¯¸ë¦¬ë³´ê¸°/ìºë¦­í„°/ì„¸ê³„ê´€/ì›ê³ )
- `app/result/page.tsx` â€” ì›ê³  ë·°ì–´ + ë‚´ë³´ë‚´ê¸°

### ìƒˆ API
- `/api/generate-project` â€” SSE ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì„¸ê³„ê´€+ìºë¦­í„°+ì•„í¬+ì‹œë®¬ë ˆì´ì…˜ ìë™ ìƒì„±
- `/api/write-episode` â€” Sonnetìœ¼ë¡œ í™” ì‘ì„± (4000-6000ì)
- `/api/author-respond` â€” í™˜ë‹˜ ë©”ì‹œì§€ì— ì‘ê°€ AI ì‘ë‹µ

### Header ë³€ê²½ (`components/layout/Header.tsx`)
- 3ê°œ íƒ­: í”„ë¡œì íŠ¸ / ì‘ê°€ ëŒ€í™” / ê²°ê³¼ë¬¼
- ê¸°ì¡´ ìƒì„¸ ë·°(/characters, /author ë“±)ëŠ” ì‚¬ì´ë“œ íŒ¨ë„ "ìƒì„¸ ë³´ê¸°"ë¡œ ì ‘ê·¼
- ìƒì„¸ ë·° ì§„ì… ì‹œ "â† ì‘ê°€ ëŒ€í™”ë¡œ ëŒì•„ê°€ê¸°" í‘œì‹œ

### ë¼ìš°íŒ…
- `/` â†’ `/project` ë˜ëŠ” `/conversation` ë¦¬ë‹¤ì´ë ‰íŠ¸ (simplifiedProject ìœ ë¬´ì— ë”°ë¼)
- ê¸°ì¡´ í˜ì´ì§€ë“¤ ìœ ì§€ (Headerì—ì„œ ìˆ¨ê¹€, ì‚¬ì´ë“œ íŒ¨ë„ì—ì„œ ì ‘ê·¼)

### í”„ë¡œë•ì…˜ ë¹Œë“œ
- âœ… ë¹Œë“œ ì„±ê³µ (2026-02-09)

---

## í”„ë¡œì íŠ¸ ìƒì„± ìˆ˜ì • (instruction-project-creation-update.md) â€” ì™„ë£Œ

### í•µì‹¬ ë³€ê²½
**ê¸°ì¡´:** í•µì‹¬ ì›Œë”©ì„ ì—¬ëŸ¬ ì¤„ ì…ë ¥ (`wordings: string[]`)
**ë³€ê²½:** ìŠ¤í† ë¦¬ë¼ì¸ì„ ììœ  í…ìŠ¤íŠ¸ë¡œ ì…ë ¥ (`storyline: string`)

### íƒ€ì… ë³€ê²½ (`lib/types/index.ts`)
```typescript
// ê¸°ì¡´
wordings: string[];
advancedSettings: { protagonistCount?: number; ... }

// ë³€ê²½
storyline: string;  // ììœ  í…ìŠ¤íŠ¸ (í•œ ì¤„ì´ë“  í•œ í˜ì´ì§€ë“ )
advancedSettings: { ... }  // protagonistCount ì œê±° (ìºë¦­í„° ìˆ˜ëŠ” AIê°€ ê²°ì •)
```

### UI ë³€ê²½ (`app/project/page.tsx`)
- ì›Œë”© ì—¬ëŸ¬ ì¤„ ì…ë ¥ â†’ ìŠ¤í† ë¦¬ë¼ì¸ textarea
- ìºë¦­í„° ìˆ˜ ì„¤ì • ì œê±°

### API ë³€ê²½ (`app/api/generate-project/route.ts`)
1. **ìŠ¤í† ë¦¬ë¼ì¸ ë¶„ì„ ë‹¨ê³„ ì¶”ê°€** (`storyline_analysis`)
   - ìŠ¤í† ë¦¬ë¼ì¸ì—ì„œ í•µì‹¬ ì¸ë¬¼, êµ¬ë„, ê°ˆë“±, ê°ì •, í›… í¬ì¸íŠ¸ ì¶”ì¶œ
2. **ì„¸ê³„ê´€ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •**
   - ìŠ¤í† ë¦¬ë¼ì¸ ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„¸ê³„ê´€ êµ¬ì¶•
3. **ìºë¦­í„° í”„ë¡¬í”„íŠ¸ ìˆ˜ì •**
   - ìŠ¤í† ë¦¬ë¼ì¸ì— ì–¸ê¸‰ëœ ì¸ë¬¼ ë°˜ë“œì‹œ í¬í•¨
   - ìºë¦­í„° ìˆ˜ëŠ” AIê°€ ììœ ë¡­ê²Œ ê²°ì • (2~5ëª… ê¶Œì¥)
4. **ì•„í¬ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •**
   - ìŠ¤í† ë¦¬ë¼ì¸ì˜ ì „ê°œì— ë§ì¶° í˜ì´ì¦ˆ ì„¤ê³„
5. **ìŠ¤í† ë¦¬ êµ¬ì¡° í”„ë¡¬í”„íŠ¸ ìˆ˜ì •**
   - ìŠ¤í† ë¦¬ë¼ì¸ ê¸°ë°˜ 3ë¶€ êµ¬ì¡° ì„¤ê³„

### ìƒì„± íë¦„
```
ì‚¬ìš©ì ì…ë ¥:
  - topic: "ì´ë¤„ì§ˆ ìˆ˜ ì—†ëŠ” ì‚¬ë‘, ë‹¤ìŒ ìƒì—ì„  ë‚´ê°€ ê¼­ ì°¾ì•„ê°€ì„œ ë‚´ ì‚¬ë‘ì„ ì´ë£¨ê² ë‹¤"
  - storyline: "ì „ìƒì— ê³µë…€ì˜€ë˜ ì´ì‚¬ë²¨ì„ ê³ì—ì„œ ì§€í‚¤ë˜ ê·¼ìœ„ê¸°ì‚¬ ì•„ë£¬ì€..."
  - genre: "íŒíƒ€ì§€+ë¡œë§¨ìŠ¤"
  - tone: "ê°ì„±ì "

ì‘ê°€ AIê°€ í•˜ëŠ” ê²ƒ:
  1. ìŠ¤í† ë¦¬ë¼ì¸ ë¶„ì„ â†’ í•µì‹¬ ì¸ë¬¼(ì•„ë£¬, ì´ì‚¬ë²¨), êµ¬ë„(ì „ìƒ+ë¹™ì˜+ì¬íšŒ), ê°ˆë“±, ê°ì • ì¶”ì¶œ
  2. ì„¸ê³„ê´€ êµ¬ì¶• â†’ ìŠ¤í† ë¦¬ë¼ì¸ì˜ "ê·¼ìœ„ê¸°ì‚¬", "ê³µêµ­", "ì œêµ­", "í™©ì" ë“± ë°˜ì˜
  3. ìºë¦­í„° ì„¤ê³„ â†’ ì•„ë£¬, ì´ì‚¬ë²¨ + í•„ìš”ì‹œ ì¶”ê°€ ìºë¦­í„° ììœ  ìƒì„±
  4. ì„œì‚¬ ì•„í¬ ì„¤ê³„ â†’ ìŠ¤í† ë¦¬ë¼ì¸ì˜ ì „ê°œ(ë¹™ì˜â†’ì ì‘â†’ì¬íšŒâ†’ê²°ë§) ë°˜ì˜
  5. ìŠ¤í† ë¦¬ êµ¬ì¡° â†’ 3ë¶€ êµ¬ì„± + 1í™” ì˜¤í”„ë‹ ì œì•ˆ
```

---

## í•˜ë“œì½”ë”© ë°ì´í„° ì œê±° (2026-02-09 ì™„ë£Œ)

### ì œê±°ëœ í•˜ë“œì½”ë”© ë°ì´í„°
ëª¨ë“  íŠ¹ì • ì„¸ê³„ê´€/ìºë¦­í„°/ìŠ¤í† ë¦¬ ë°ì´í„°ê°€ ì½”ë“œì—ì„œ ì œê±°ë¨. ì´ì œ ëª¨ë“  ë°ì´í„°ëŠ” generate-project APIì—ì„œ ë™ì  ìƒì„±ë¨.

### ìˆ˜ì •ëœ íŒŒì¼
1. `lib/prompts/character-profiles.ts` â€” CHARACTERS ë°°ì—´ì„ ë¹ˆ ë°°ì—´ë¡œ
2. `lib/prompts/character-seeds.ts` â€” CHARACTER_SEEDS ë°°ì—´ì„ ë¹ˆ ë°°ì—´ë¡œ
3. `lib/utils/mock-data.ts` â€” MOCK_EVENTS ë°°ì—´ì„ ë¹ˆ ë°°ì—´ë¡œ
4. `lib/presets/seomun-preset.ts` â€” ëª¨ë“  í•˜ë“œì½”ë”© ë°ì´í„° ì œê±°, ë¹ˆ ê¸°ë³¸ê°’ìœ¼ë¡œ
5. `data/` â€” ì²œì¶”ì˜ê°•í˜¸ ì„¸ê³„ê´€ JSON ë°ì´í„°ë¡œ êµì²´ (2026-02-23)
6. `lib/prompts/simulation-prompt.ts` â€” "íŒíƒ€ì§€/ë¬´í˜‘" í•˜ë“œì½”ë”© ì œê±°
7. `lib/prompts/simulation-prompt-v2.ts` â€” "íŒíƒ€ì§€/ë¬´í˜‘" í•˜ë“œì½”ë”© ì œê±°, ì˜ˆì‹œ í…ìŠ¤íŠ¸ ì¼ë°˜í™”
8. `lib/prompts/detail-prompt.ts` â€” "íŒíƒ€ì§€/ë¬´í˜‘" í•˜ë“œì½”ë”© ì œê±°
9. `lib/types/index.ts` â€” ì£¼ì„ì˜ íŠ¹ì • ì˜ˆì‹œ ì¼ë°˜í™”
10. `components/create/WorldBuilder.tsx` â€” í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì¼ë°˜í™”
11. `components/create/CharacterBuilder.tsx` â€” í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì¼ë°˜í™”
12. `components/simulation/SimulationControl.tsx` â€” "ì„œë¬¸ëŒ€ë¥™" ì œê±°
13. `components/editor/NovelEditor.tsx` â€” "ì„œë¬¸ëŒ€ë¥™ ì´ì•¼ê¸°" ì œê±°
14. `app/page.tsx` â€” í”„ë¦¬ì…‹ UI ì œê±°/ë¹„í™œì„±í™”

### ë‚¨ì•„ìˆì–´ë„ ë˜ëŠ” ê²ƒ
- UI êµ¬ì¡°, API ë¡œì§, íƒ€ì… ì •ì˜, ì‹œìŠ¤í…œ ê·œì¹™
- ì¥ë¥´/í†¤ ì„ íƒ ì˜µì…˜ (ì‚¬ìš©ìê°€ ì„ íƒí•˜ëŠ” ê²ƒ)
- ì‘ê°€ í˜ë¥´ì†Œë‚˜ (ìŠ¤íƒ€ì¼ í”„ë¦¬ì…‹, ì„¸ê³„ê´€ì´ ì•„ë‹˜)
- CLAUDE.md, docs/ í´ë” (ë¬¸ì„œ)

### ì›ì¹™
ì½”ë“œì— ë‚¨ì•„ìˆì–´ë„ ë˜ëŠ” ê²ƒ: UI êµ¬ì¡°, API ë¡œì§, íƒ€ì… ì •ì˜, ì‹œìŠ¤í…œ ê·œì¹™
ì½”ë“œì— ë‚¨ì•„ìˆìœ¼ë©´ ì•ˆ ë˜ëŠ” ê²ƒ: íŠ¹ì • ì´ì•¼ê¸°ì˜ ë‚´ìš©

---

## ì‘ê°€ ëŒ€í™” ì‹œìŠ¤í…œ ë²„ê·¸ ìˆ˜ì • (2026-02-09 ì™„ë£Œ)

### ìˆ˜ì •ëœ ë²„ê·¸ ëª©ë¡

#### 1. ì—í”¼ì†Œë“œ ë²ˆí˜¸ ë²„ê·¸ (1í™” ìš”ì²­ â†’ 4í™” ìƒì„±)
**ì›ì¸:** `currentEpisodeNumber`ê°€ localStorageì— persistë˜ì–´ ìƒˆ í”„ë¡œì íŠ¸ì—ì„œë„ ì´ì „ ê°’ ìœ ì§€
**ìˆ˜ì •:** `app/project/page.tsx`ì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ ì‹œì‘ ì‹œ `reset()` + `setCurrentEpisodeNumber(0)` í˜¸ì¶œ

#### 2. ìºë¦­í„° 1ëª…ë§Œ ìƒì„±ë˜ëŠ” ë¬¸ì œ
**ì›ì¸:** ìºë¦­í„° í”„ë¡¬í”„íŠ¸ê°€ "2~5ëª… ê¶Œì¥"ìœ¼ë¡œ ì•½í•˜ê²Œ ì„¤ì •ë¨
**ìˆ˜ì •:** `app/api/generate-project/route.ts`ì˜ ìºë¦­í„° í”„ë¡¬í”„íŠ¸ì— "ì ˆëŒ€ ê·œì¹™" ì¶”ê°€
```
**ì ˆëŒ€ ê·œì¹™:**
1. ìŠ¤í† ë¦¬ë¼ì¸ì— ì–¸ê¸‰ëœ ì¸ë¬¼ì€ ë°˜ë“œì‹œ í¬í•¨
2. **ìµœì†Œ 3ëª… ì´ìƒ** ìƒì„±
3. ë‹¤ì–‘í•œ ì¸ë¬¼ ìœ í˜• (ì¡°ë ¥ì, ëŒ€ë¦½ ì¸ë¬¼, ê¶Œë ¥ì ë“±)
```

#### 3. "í‰ì˜¨í•œ ë‚˜ë‚ " íŒ¨ë”© ì‹œì‘ ë¬¸ì œ
**ì›ì¸:** `write-episode` í”„ë¡¬í”„íŠ¸ì— ëŠìŠ¨í•œ ì‹œì‘ ê¸ˆì§€ ê·œì¹™ ì—†ìŒ
**ìˆ˜ì •:** `app/api/write-episode/route.ts`ì— ì ˆëŒ€ ê·œì¹™ ì¶”ê°€
```
## ì ˆëŒ€ ê·œì¹™ (ë°˜ë“œì‹œ ì§€í‚¬ ê²ƒ)
1. **ì²« ë¬¸ì¥ë¶€í„° ì„íŒ©íŠ¸**: "í‰ì˜¨í•œ ë‚˜ë‚ ì´ ê³„ì†ë˜ì—ˆë‹¤" ê°™ì€ ëŠìŠ¨í•œ ì‹œì‘ ê¸ˆì§€
2. **ë§¤ ë‹¨ë½ ê¸´ì¥ ìœ ì§€**: ì¼ìƒ ë¬˜ì‚¬ê°€ 3ë¬¸ì¥ ì´ìƒ ì—°ì†ë˜ë©´ ì•ˆ ë¨
3. **íŒ¨ë”© ê¸ˆì§€**: "ê·¸ í›„ë¡œ ì•„ë¬´ ì¼ ì—†ì´" ê°™ì€ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€
4. **ì²« ì”¬ë¶€í„° ì‚¬ê±´**: 1í™”ë“  10í™”ë“ , ì²« ì¥ë©´ì—ì„œ ë¬´ì–¸ê°€ê°€ ì¼ì–´ë‚˜ì•¼ í•¨
```

#### 4. ì‘ê°€ ì½”ë©˜íŠ¸ ì„ íƒì§€ ë¹ˆì•½ ë¬¸ì œ
**ì›ì¸:** ìŠ¤í† ë¦¬ êµ¬ì¡° APIê°€ `recommendedOpening` í•„ë“œë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠìŒ
**ìˆ˜ì •:**
1. `app/api/generate-project/route.ts` - ìŠ¤í† ë¦¬ êµ¬ì¡°ë¥¼ JSONìœ¼ë¡œ ë°˜í™˜ (part1/2/3, recommendedOpening, openingScene, summary)
2. `app/project/page.tsx` - ì´ˆê¸° ë©”ì‹œì§€ì— ì „ì²´ êµ¬ì¡° + ì˜¤í”„ë‹ ì œì•ˆ í‘œì‹œ
3. `app/conversation/page.tsx` - ëˆ„ë½ëœ ì•¡ì…˜ í•¸ë“¤ëŸ¬ ì¶”ê°€ (alt_opening, view_characters, discuss, revise, redirect)
4. `app/api/author-respond/route.ts` - `alt_opening` ì•¡ì…˜ìš© íŠ¹í™” í”„ë¡¬í”„íŠ¸ ì¶”ê°€

### ì¶”ê°€ ìˆ˜ì • ì‚¬í•­

#### JSON íŒŒì‹± ê°œì„ 
**íŒŒì¼:** `app/api/generate-project/route.ts`
- `tryRepairJson` í•¨ìˆ˜ ê°•í™”: ì˜ë¦° ë¬¸ìì—´ ë‹«ê¸°, ì—´ë¦° ê´„í˜¸ ìë™ ë‹«ê¸°

#### ì—í”¼ì†Œë“œ ì €ì¥ ëˆ„ë½ ìˆ˜ì •
**íŒŒì¼:** `app/conversation/page.tsx`
- `addEpisode(data.episode)` í˜¸ì¶œ ì¶”ê°€ - ì‘ì„±ëœ ì—í”¼ì†Œë“œë¥¼ ìŠ¤í† ì–´ì— ì €ì¥

### ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡
1. `app/project/page.tsx` - ì´ˆê¸°í™” ë¡œì§ + í–¥ìƒëœ ì´ˆê¸° ë©”ì‹œì§€
2. `app/conversation/page.tsx` - ì•¡ì…˜ í•¸ë“¤ëŸ¬ ì¶”ê°€ + ì—í”¼ì†Œë“œ ì €ì¥
3. `app/api/generate-project/route.ts` - ìŠ¤í† ë¦¬ êµ¬ì¡° JSON + JSON ë³µêµ¬ ê°•í™”
4. `app/api/write-episode/route.ts` - íŒ¨ë”© ê¸ˆì§€ ê·œì¹™ (ì´ì „ ì„¸ì…˜)
5. `app/api/author-respond/route.ts` - alt_opening í”„ë¡¬í”„íŠ¸

### í˜„ì¬ ìƒíƒœ
- ê°œë°œ ì„œë²„ ì •ìƒ ì‘ë™ ì¤‘
- ëª¨ë“  ìˆ˜ì •ì‚¬í•­ ì»´íŒŒì¼ ì„±ê³µ
- í…ŒìŠ¤íŠ¸ í•„ìš”: ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± â†’ 1í™” ì‘ì„± í”Œë¡œìš°

---

## 2026-02-10 ë²„ê·¸ ìˆ˜ì •

### ì—í”¼ì†Œë“œ ë²ˆí˜¸ ë²„ê·¸ ì¬ë°œ (1í™” â†’ 4í™”)
**ì¦ìƒ:** ìƒˆ í”„ë¡œì íŠ¸ì—ì„œ 1í™” ì‘ì„±ì„ ìš”ì²­í–ˆëŠ”ë° 4í™”ê°€ ìƒì„±ë¨
**ì›ì¸:** `conversation/page.tsx`ì—ì„œ `currentEpisodeNumber + 1`ë¡œ ì—í”¼ì†Œë“œ ë²ˆí˜¸ë¥¼ ê³„ì‚°í–ˆëŠ”ë°, ì´ ê°’ì´ localStorageì—ì„œ ì´ì „ í”„ë¡œì íŠ¸ì˜ ê°’ì„ ë³µì›í•˜ì—¬ ì”ì¡´í•¨. `reset()` í˜¸ì¶œ í›„ì—ë„ Zustand persist ë¯¸ë“¤ì›¨ì–´ê°€ ê°’ì„ ë³µì›í•˜ëŠ” race condition ë°œìƒ.

**í•´ê²°:**
- `currentEpisodeNumber` ëŒ€ì‹  `episodes.length` ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒ ì—í”¼ì†Œë“œ ë²ˆí˜¸ ê³„ì‚°
- `episodes.length + 1`ì€ í•­ìƒ ì˜¬ë°”ë¥¸ ë‹¤ìŒ í™” ë²ˆí˜¸ë¥¼ ë³´ì¥ (ìŠ¤í† ì–´ì˜ ì‹¤ì œ ì—í”¼ì†Œë“œ ë°°ì—´ ê¸°ì¤€)

**ìˆ˜ì • íŒŒì¼:** `app/conversation/page.tsx`
```typescript
// ë³€ê²½ ì „
episodeNumber: currentEpisodeNumber + 1,

// ë³€ê²½ í›„
const nextEpisodeNumber = episodes.length + 1;
episodeNumber: nextEpisodeNumber,
```

### ìºë¦­í„° í”„ë¡¬í”„íŠ¸ ê°•í™”
**ì¦ìƒ:** ì—¬ì „íˆ ìºë¦­í„°ê°€ 1ëª…ë§Œ ìƒì„±ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒ
**ìˆ˜ì •:** `app/api/generate-project/route.ts`ì˜ ìºë¦­í„° í”„ë¡¬í”„íŠ¸ë¥¼ ë” ê°•í™”
- "ìµœì†Œ 3ëª… ì´ìƒ" â†’ "ë°˜ë“œì‹œ 3ëª… ì´ìƒ ìƒì„± - 1ëª…ì´ë‚˜ 2ëª…ë§Œ ìƒì„±í•˜ë©´ ì‹¤íŒ¨"
- ì—­í•  ë¶„ë°° í•„ìˆ˜ ëª…ì‹œ (protagonist 1ëª…, antagonist ìµœì†Œ 1ëª…, neutral ìµœì†Œ 1ëª…)
- ìœ„ë°˜ ì‹œ ì‹¤íŒ¨ë¼ëŠ” ê°•í•œ ê²½ê³  ì¶”ê°€

### ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡ (2026-02-10)
1. `app/conversation/page.tsx` - ì—í”¼ì†Œë“œ ë²ˆí˜¸ ê³„ì‚° ë¡œì§ ìˆ˜ì • (`episodes.length` ê¸°ë°˜)
2. `app/api/generate-project/route.ts` - ìºë¦­í„° í”„ë¡¬í”„íŠ¸ ê°•í™”

### ê¸°ì¡´ ìˆ˜ì • í™•ì¸ (ì´ë¯¸ ì™„ë£Œë¨)
- âœ… "í‰ì˜¨í•œ ë‚˜ë‚ " íŒ¨ë”© ê¸ˆì§€ ê·œì¹™ (`write-episode/route.ts`)
- âœ… ì‘ê°€ ì½”ë©˜íŠ¸ ì„ íƒì§€ ê°•í™” (`author-respond/route.ts`)
- âœ… í”„ë¡œì íŠ¸ ì´ˆê¸°í™” ì‹œ `reset()` + `setCurrentEpisodeNumber(0)` (`project/page.tsx`)

**ë‹¤ìŒ ì‘ì—…:** ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ í›„ í”¼ë“œë°± ë°˜ì˜

---

## ì§‘í•„ ìŠ¤íƒ€ì¼ ê·œì¹™ êµ¬í˜„ (instruction-writing-style.md, 2026-02-10 ì™„ë£Œ)

### í•µì‹¬ ë³€ê²½

1. **ì‹œì  ì„ íƒ UI ì¶”ê°€** (`app/project/page.tsx`)
   - í”„ë¡œì íŠ¸ ìƒì„± í™”ë©´ì— ì‹œì  ì„ íƒ (1ì¸ì¹­ ì£¼ì¸ê³µ / 3ì¸ì¹­ ì‘ê°€ / ì§ì ‘ ì…ë ¥)
   - `SimplifiedProjectConfig.viewpoint` í•„ë“œì— ì €ì¥

2. **ì‹œì ë³„ ë¬¸ì²´ ê·œì¹™** (`app/api/write-episode/route.ts`)
   - 1ì¸ì¹­: "ë‚˜"ë¡œ ì„œìˆ , ì£¼ì¸ê³µ ì‹œì  ì œí•œ, ë‹¤ë¥¸ ì¸ë¬¼ ì†ë§ˆìŒ ì¶”ì¸¡ë§Œ ê°€ëŠ¥
   - 3ì¸ì¹­: ìºë¦­í„° ì´ë¦„ìœ¼ë¡œ ì„œìˆ , ì‹œì  ì „í™˜ ê°€ëŠ¥, ì¸ë¬¼ ì—†ëŠ” ì¥ë©´ë„ ê°€ëŠ¥

3. **ë§ˆí¬ë‹¤ìš´ ì„œì‹ ê¸ˆì§€** (ì†Œì„¤ ë³¸ë¬¸)
   - ë³¼ë“œ, ì´íƒ¤ë¦­, ì œëª©, ëª©ë¡, ì¸ìš©, ì½”ë“œ ë¸”ë¡, êµ¬ë¶„ì„  ì¼ì²´ ê¸ˆì§€
   - ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ ì‚¬ìš©, ê°•ì¡°ëŠ” ì§§ì€ ë¬¸ì¥/ë‹¨ë… í–‰ìœ¼ë¡œ í‘œí˜„
   - ì¥ë©´ ì „í™˜ì€ ë¹ˆ ì¤„ë¡œë§Œ

4. **ì‘ê°€ ëŒ€í™” í†¤ ë³€ê²½** (`app/api/author-respond/route.ts`)
   - ì¡´ëŒ“ë§ â†’ ë°˜ë§ (ë™ë“±í•œ ì°½ì‘ íŒŒíŠ¸ë„ˆ)
   - ë³´ê³ ì„œ í˜•íƒœ â†’ ì´ì•¼ê¸°í•˜ë“¯ì´
   - "ì œì•ˆë“œë¦½ë‹ˆë‹¤" â†’ "ì´ë ‡ê²Œ ì“¸ ê±°ì•¼"
   - ê¸°ìˆ  ìš©ì–´ ê¸ˆì§€ ("ì‹œë®¬ë ˆì´ì…˜", "ì„œì‚¬ ì•„í¬" ë“±)
   - í™•ì‹  ìˆëŠ” íƒœë„, í—ˆë½ êµ¬í•˜ì§€ ì•ŠìŒ

5. **ì´ˆê¸° ë³´ê³ ì„œ í†¤ ë³€ê²½** (`app/project/page.tsx`)
   - ë§ˆí¬ë‹¤ìš´ ì„œì‹ ì œê±°
   - ì‘ê°€ ë§íˆ¬ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì„¤ëª…

### ìˆ˜ì •ëœ íŒŒì¼
1. `lib/types/index.ts` - `viewpoint` í•„ë“œ ì¶”ê°€
2. `app/project/page.tsx` - ì‹œì  ì„ íƒ UI + ì´ˆê¸° ë³´ê³ ì„œ í†¤ ë³€ê²½
3. `app/api/write-episode/route.ts` - ì‹œì ë³„ ê·œì¹™ + ë§ˆí¬ë‹¤ìš´ ê¸ˆì§€
4. `app/api/author-respond/route.ts` - ì‘ê°€ í†¤ ë³€ê²½

### ë¹Œë“œ ì´ìŠˆ í•´ê²°
- í”„ë¡¬í”„íŠ¸ ë‚´ ë°±í‹±(```)ì´ í…œí”Œë¦¿ ë¦¬í„°ëŸ´ íŒŒì‹± ì—ëŸ¬ ìœ ë°œ
- "ì½”ë“œ ë¸”ë¡(ë°±í‹±) ê¸ˆì§€"ë¡œ í…ìŠ¤íŠ¸ ëŒ€ì²´í•˜ì—¬ í•´ê²°

### í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ (2026-02-10)

---

## ì„¸ê³„ ìš°ì„  ì•„í‚¤í…ì²˜ êµ¬í˜„ (instruction-world-first-architecture.md, 2026-02-10 ì§„í–‰ ì¤‘)

### í•µì‹¬ ë³€ê²½

**ê¸°ì¡´ ë°©ì‹:** í¼ ì…ë ¥ â†’ ìë™ ìƒì„± (generate-project API)
**ìƒˆ ë°©ì‹:** ëŒ€í™”í˜• ë ˆì´ì–´ êµ¬ì¶• (7ê°œ ë ˆì´ì–´ë¥¼ ì‘ê°€ì™€ í•¨ê»˜ í•˜ë‚˜ì”© êµ¬ì¶•)

### 7ê°œ ë ˆì´ì–´
1. **ì„¸ê³„ (World)** - ëŒ€ë¥™, ë„ì‹œ, ì§€í˜•
2. **í•µì‹¬ ê·œì¹™ (Core Rules)** - í˜ì˜ ì²´ê³„, ì¢…ì¡±, ì—­ì‚¬
3. **ì”¨ì•— (Seeds)** - ì„¸ë ¥, ì¢…ì¡±, ëª¬ìŠ¤í„°, NPC
4. **ì£¼ì¸ê³µ ì„œì‚¬ (Hero Arc)** - ì£¼ì¸ê³µì˜ íƒœìƒ, í•µì‹¬ ì„œì‚¬, ëª©í‘œ
5. **ë¹ŒëŸ° ì„œì‚¬ (Villain Arc)** - ë¹ŒëŸ°ì˜ ë™ê¸°, ì„œì‚¬, ì£¼ì¸ê³µê³¼ì˜ ê´€ê³„
6. **ê¶ê·¹ì˜ ë–¡ë°¥ (Ultimate Mystery)** - í‘œë©´/ì§„ì‹¤, íŒíŠ¸ë“¤
7. **ì†Œì„¤ (Novel)** - ì‹œë®¬ë ˆì´ì…˜ + ì§‘í•„

### ìƒˆ íƒ€ì… (`lib/types/index.ts`)
- `WorldFirstProject` - ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°
- `WorldLayer`, `CityInfo` - ì„¸ê³„ ë ˆì´ì–´
- `CoreRulesLayer` - ê·œì¹™ ë ˆì´ì–´
- `SeedsLayer`, `FactionSeedInfo`, `RaceInfo`, `ThreatInfo`, `NPCSeedInfo` - ì”¨ì•— ë ˆì´ì–´
- `HeroArcLayer` - ì£¼ì¸ê³µ ë ˆì´ì–´
- `VillainArcLayer` - ë¹ŒëŸ° ë ˆì´ì–´
- `UltimateMysteryLayer` - ë–¡ë°¥ ë ˆì´ì–´
- `LayerName`, `LayerStatus`, `LayerBuildMessage`, `LayerChoice` - ë ˆì´ì–´ êµ¬ì¶• ê´€ë ¨

### ìƒˆ ìŠ¤í† ì–´ ìƒíƒœ (`lib/store/simulation-store.ts`)
- `worldFirstProject: WorldFirstProject | null`
- `layerBuildMessages: LayerBuildMessage[]`
- ë ˆì´ì–´ë³„ ì—…ë°ì´íŠ¸ ì•¡ì…˜ë“¤ (updateWorldLayer, updateCoreRulesLayer, ë“±)
- `confirmLayer()`, `setCurrentLayer()`, `initWorldFirstProject()` ë“±

### ìƒˆ API (`app/api/layer-build/route.ts`)
- ê° ë ˆì´ì–´ë³„ AI ì œì•ˆ ìƒì„±
- ì‘ê°€ í†¤ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”

### UI ë³€ê²½

1. **í”„ë¡œì íŠ¸ ì‹œì‘ í˜ì´ì§€ (`app/project/page.tsx`)**
   - ê¸°ì¡´ "ì£¼ì œ+ìŠ¤í† ë¦¬ë¼ì¸ í¼" â†’ "ì¥ë¥´/í†¤/ì‹œì /ì‘ê°€ + ì´ˆê¸° ì•„ì´ë””ì–´(ì„ íƒ)"
   - [ì„¸ê³„ ë§Œë“¤ê¸° ì‹œì‘] ë²„íŠ¼ â†’ ëŒ€í™” í™”ë©´ìœ¼ë¡œ ì´ë™

2. **ëŒ€í™” í™”ë©´ (`app/conversation/page.tsx`)** - ì „ë©´ ì¬ì‘ì„±
   - ìƒë‹¨: ë ˆì´ì–´ ì§„í–‰ í‘œì‹œ (â— í™•ì • / â— ì§„í–‰ ì¤‘ / â—‹ ëŒ€ê¸°)
   - ì¤‘ì•™: ì‘ê°€ì™€ ëŒ€í™” (ë ˆì´ì–´ ì œì•ˆ â†’ í”¼ë“œë°± â†’ í™•ì •)
   - í•˜ë‹¨: [ë ˆì´ì–´ í™•ì •] [ë‹¤ì‹œ ì œì•ˆ] ë²„íŠ¼
   - ì‚¬ì´ë“œ íŒ¨ë„: 7ê°œ ë ˆì´ì–´ë³„ íƒ­ (í™•ì •ëœ ë‚´ìš© í‘œì‹œ)

3. **ëŒ€í™” íë¦„**
   - ì²« ì§„ì… ì‹œ ìë™ìœ¼ë¡œ "ì„¸ê³„" ë ˆì´ì–´ ì œì•ˆ ìƒì„±
   - í™˜ë‹˜ì´ í”¼ë“œë°± â†’ ì‘ê°€ê°€ ìˆ˜ì •ì•ˆ ì œì•ˆ
   - [í™•ì •] í´ë¦­ â†’ ë‹¤ìŒ ë ˆì´ì–´ë¡œ ìë™ ì§„í–‰
   - ëª¨ë“  ë ˆì´ì–´ í™•ì • â†’ 1í™” ìë™ ì§‘í•„ ì‹œì‘

### ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡
1. `lib/types/index.ts` - 7ê°œ ë ˆì´ì–´ íƒ€ì… ì¶”ê°€
2. `lib/store/simulation-store.ts` - WorldFirst ìƒíƒœ + ì•¡ì…˜ ì¶”ê°€
3. `app/api/layer-build/route.ts` - ìƒˆ API (ë ˆì´ì–´ë³„ ì œì•ˆ ìƒì„±)
4. `app/project/page.tsx` - ê°„ì†Œí™”ëœ ì‹œì‘ í¼
5. `app/conversation/page.tsx` - ë ˆì´ì–´ êµ¬ì¶• ëŒ€í™” UI

### í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ (2026-02-10)

---

## UNIFIED-INSTRUCTION2 ê¸°ë°˜ ë³´ê°• (2026-02-10)

UNIFIED-INSTRUCTION2.md ìŠ¤í™ì— ë§ì¶° íƒ€ì…, ìŠ¤í† ì–´, API, UIë¥¼ ë³´ê°•í–ˆë‹¤.

### íƒ€ì… ë³´ê°• (`lib/types/index.ts`)

**ìƒˆ íƒ€ì…:**
- `SimulationEvent` - ê°ê° ë””í…Œì¼, ê°ì • ì„íŒ©íŠ¸, ê²°ê³¼, ì¤‘ìš”ë„, ì „í™˜ì  ì—¬ë¶€
- `EpisodeHooks` - ì˜¤í”„ë‹/í´ë¡œì§• í›…
- `ProjectPhase` - í”„ë¡œì íŠ¸ ì§„í–‰ ë‹¨ê³„ (`'setup' | 'worldbuilding' | 'simulation' | 'writing'`)
- `CharacterProfileV2` - UNIFIED2 ìŠ¤í™ì˜ ìƒì„¸ ìºë¦­í„° í”„ë¡œí•„

**ê¸°ì¡´ íƒ€ì… í™•ì¥:**
- `CharacterSeed` - `name`, `birthCondition`, `initialEnvironment`, `innateTraits[]`, `latentPotentials[]`, `roleTendency` ì¶”ê°€
- `WorldHistoryEra` - `period`, `events[]`, `worldMood`, `mysteryHint`, `legacy` ì¶”ê°€
- `DetailedDecade` - `period`, `factionStatus`, `tension`, `worldState`, `events[]` ì¶”ê°€
- `Episode` - `viewpointCharacter`, `wordCount`, `hooks` ì¶”ê°€
- `Project` - `currentPhase` ì¶”ê°€

### ìŠ¤í† ì–´ ë³´ê°• (`lib/store/project-store.ts`)

- `setCurrentPhase(phase: ProjectPhase)` ì•¡ì…˜ ì¶”ê°€
- í”„ë¡œì íŠ¸ ìƒì„± ì‹œ `currentPhase: 'setup'`ìœ¼ë¡œ ì´ˆê¸°í™”

### ì§‘í•„ API ë³´ê°•

**write-episode (`app/api/write-episode/route.ts`):**
- ë‚˜ë ˆì´ì…˜ ìœ„ì£¼ ê·œì¹™ ì¶”ê°€:
  - ëŒ€í™”ë³´ë‹¤ ì„œìˆ ì´ í›¨ì”¬ ë§ì•„ì•¼ í•¨
  - í•œ í™”ì— ëŒ€í™” 5~10íšŒ ë¯¸ë§Œ
  - ì§§ì€ ì™•ë³µ ëŒ€í™” (í•‘í ëŒ€í™”) ê¸ˆì§€
  - ëŒ€í™” ì—†ì´ ê¸´ì¥ê° ë§Œë“¤ê¸°: í–‰ë™, ê°ê°, ìƒê°ìœ¼ë¡œ ì¥ë©´ ì±„ìš°ê¸°

**revise-episode (`app/api/revise-episode/route.ts`):**
- ë™ì¼í•œ ë‚˜ë ˆì´ì…˜ ê·œì¹™ ì¶”ê°€

### ì„¸ê³„ íƒ€ì„ë¼ì¸ UI (`components/world-timeline/`)

**ìƒˆ ì»´í¬ë„ŒíŠ¸:**
- `WorldTimelineOverview.tsx` - ì¶•ì†Œ ë·° (ì „ì²´ ì—­ì‚¬ ê°€ë¡œ íƒ€ì„ë¼ì¸)
- `DecadeDetailView.tsx` - í™•ëŒ€ ë·° (10ë…„ ë‹¨ìœ„, ì„¸ë ¥ ìƒíƒœ, ê¸´ì¥ë„)
- `WorldTimelinePanel.tsx` - í†µí•© íŒ¨ë„ (3íƒ­: ì „ì²´ ì—­ì‚¬, 10ë…„ ë‹¨ìœ„, ìºë¦­í„°ë³„)

**í”„ë¡œì íŠ¸ í˜ì´ì§€ í†µí•©:**
- `app/projects/[id]/page.tsx`ì— "ì—­ì‚¬" íƒ­ ì¶”ê°€
- ì‚¬ì´ë“œ íŒ¨ë„ì—ì„œ ì„¸ê³„ ì—­ì‚¬ íƒ€ì„ë¼ì¸ í™•ì¸ ê°€ëŠ¥

### íŒŒì¼ ë³€ê²½ ëª©ë¡
1. `lib/types/index.ts` - íƒ€ì… ë³´ê°•
2. `lib/store/project-store.ts` - currentPhase + setCurrentPhase ì¶”ê°€
3. `app/api/write-episode/route.ts` - ë‚˜ë ˆì´ì…˜ ê·œì¹™ ì¶”ê°€
4. `app/api/revise-episode/route.ts` - ë‚˜ë ˆì´ì…˜ ê·œì¹™ ì¶”ê°€
5. `components/world-timeline/WorldTimelineOverview.tsx` - ì‹ ê·œ
6. `components/world-timeline/DecadeDetailView.tsx` - ì‹ ê·œ
7. `components/world-timeline/WorldTimelinePanel.tsx` - ì‹ ê·œ
8. `components/world-timeline/index.ts` - ì‹ ê·œ
9. `app/projects/[id]/page.tsx` - ì—­ì‚¬ íƒ­ ì¶”ê°€
10. `components/characters/SeedEditModal.tsx` - íƒ€ì… ìˆ˜ì •

### ë¹Œë“œ ì„±ê³µ í™•ì¸ ì™„ë£Œ

---

## í”„ë¡œì íŠ¸ ìë™ ì €ì¥ ë° ë‚´ë³´ë‚´ê¸°/ë¶ˆëŸ¬ì˜¤ê¸° (2026-02-10)

### êµ¬í˜„ ë‚´ìš©

#### 1. ì €ì¥ë¨ í‘œì‹œ (`components/common/SaveIndicator.tsx`)
- í”„ë¡œì íŠ¸ ë°ì´í„° ë³€ê²½ ì‹œ í™”ë©´ í•˜ë‹¨ ì¤‘ì•™ì— "âœ“ ì €ì¥ë¨" í† ìŠ¤íŠ¸ í‘œì‹œ
- 2ì´ˆ í›„ ìë™ìœ¼ë¡œ ì‚¬ë¼ì§
- Zustand persist ë¯¸ë“¤ì›¨ì–´ê°€ localStorageì— ìë™ ì €ì¥ (ê¸°ì¡´ ê¸°ëŠ¥)
- ì‹œê°ì  í”¼ë“œë°±ìœ¼ë¡œ ì €ì¥ ì™„ë£Œë¥¼ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼

#### 2. í”„ë¡œì íŠ¸ ëª©ë¡ ê°œì„  (`app/projects/page.tsx`)
- í”„ë¡œì íŠ¸ ì¹´ë“œì— ì´ˆê¸° ë°©í–¥(direction)ì„ ì œëª©ìœ¼ë¡œ í‘œì‹œ (2ì¤„ ì œí•œ)
- ì¥ë¥´, í†¤, ì§„í–‰ ë‹¨ê³„, ë§ˆì§€ë§‰ ì‘ì—… ì‹œê°„ í‘œì‹œ
- í˜¸ë²„ ì‹œ ë‚´ë³´ë‚´ê¸°(â†“) ë° ì‚­ì œ(âœ•) ë²„íŠ¼ í‘œì‹œ

#### 3. ë‚´ë³´ë‚´ê¸°/ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥
**ë‚´ë³´ë‚´ê¸°:**
- ê°œë³„ í”„ë¡œì íŠ¸: ì¹´ë“œ í˜¸ë²„ â†’ â†“ ë²„íŠ¼ â†’ JSON íŒŒì¼ ë‹¤ìš´ë¡œë“œ
- ì „ì²´ í”„ë¡œì íŠ¸: í—¤ë”ì˜ [ì „ì²´ ë‚´ë³´ë‚´ê¸°] ë²„íŠ¼ â†’ ëª¨ë“  í”„ë¡œì íŠ¸ JSON ë‹¤ìš´ë¡œë“œ
- íŒŒì¼ëª…: `narrative-{ì¥ë¥´}-{ë‚ ì§œ}.json` ë˜ëŠ” `narrative-all-projects-{ë‚ ì§œ}.json`

**ë¶ˆëŸ¬ì˜¤ê¸°:**
- í—¤ë”ì˜ [ë¶ˆëŸ¬ì˜¤ê¸°] ë²„íŠ¼ â†’ JSON íŒŒì¼ ì„ íƒ
- ë‹¨ì¼ í”„ë¡œì íŠ¸ ë˜ëŠ” ë³µìˆ˜ í”„ë¡œì íŠ¸ íŒŒì¼ ëª¨ë‘ ì§€ì›
- ë¶ˆëŸ¬ì˜¨ í”„ë¡œì íŠ¸ëŠ” ìƒˆ IDê°€ ë¶€ì—¬ë˜ì–´ ì¤‘ë³µ ë°©ì§€

### íŒŒì¼ ë³€ê²½ ëª©ë¡
1. `components/common/SaveIndicator.tsx` - ì‹ ê·œ (ì €ì¥ë¨ í† ìŠ¤íŠ¸)
2. `components/common/ClientProviders.tsx` - SaveIndicator ì¶”ê°€
3. `app/globals.css` - fade-in ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
4. `app/projects/page.tsx` - ë‚´ë³´ë‚´ê¸°/ë¶ˆëŸ¬ì˜¤ê¸° + ì œëª© í‘œì‹œ

### JSON ë‚´ë³´ë‚´ê¸° í˜•ì‹
```json
{
  "version": "1.0",
  "exportedAt": "2026-02-10T...",
  "project": { ... }  // ë‹¨ì¼ í”„ë¡œì íŠ¸
  // ë˜ëŠ”
  "projects": [ ... ]  // ë³µìˆ˜ í”„ë¡œì íŠ¸
}
```

---

## Hydration ì—ëŸ¬ ìˆ˜ì • (2026-02-10)

### ë¬¸ì œ
- Zustand persist ë¯¸ë“¤ì›¨ì–´ê°€ localStorageì—ì„œ ë°ì´í„°ë¥¼ ë¡œë“œ
- ì„œë²„ ë Œë”ë§ ì‹œ localStorageê°€ ì—†ì–´ì„œ ë¹ˆ ë°ì´í„°
- í´ë¼ì´ì–¸íŠ¸ hydration ì‹œ localStorage ë°ì´í„°ì™€ ë¶ˆì¼ì¹˜ ë°œìƒ

### í•´ê²° ë°©ë²•
ê° í˜ì´ì§€ì— `isHydrated` ìƒíƒœ ì¶”ê°€:

```typescript
const [isHydrated, setIsHydrated] = useState(false);

useEffect(() => {
  setIsHydrated(true);
}, []);

// hydration ì „ì—ëŠ” ë¡œë”© UI ë˜ëŠ” null ë°˜í™˜
if (!isHydrated) {
  return <div>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>;
}
```

### ìˆ˜ì •ëœ íŒŒì¼
1. `app/projects/page.tsx` - í”„ë¡œì íŠ¸ ëª©ë¡
2. `app/projects/[id]/page.tsx` - í”„ë¡œì íŠ¸ ëŒ€í™” í™”ë©´
3. `app/projects/[id]/result/page.tsx` - ê²°ê³¼ë¬¼ í˜ì´ì§€

---

## ì„¸ê³„ ì—­ì‚¬ ìƒì„± ê¸°ëŠ¥ êµ¬í˜„ (2026-02-10)

### ë¬¸ì œ
- [ì‹œì‘í•˜ì] í´ë¦­ ì‹œ "ì„¸ê³„ ì—­ì‚¬ë¥¼ ìƒì„±í•˜ê³  ìˆì–´..." ë©”ì‹œì§€ë§Œ í‘œì‹œë˜ê³  ì‹¤ì œ API í˜¸ì¶œ ì—†ìŒ
- `start_simulation` ì•¡ì…˜ì— TODO ì£¼ì„ë§Œ ìˆì—ˆìŒ

### í•´ê²° ë°©ë²•
`app/projects/[id]/page.tsx`ì˜ `start_simulation` ì•¡ì…˜ì— ì‹¤ì œ êµ¬í˜„ ì¶”ê°€:

1. `/api/generate-world-history` API í˜¸ì¶œ
2. 60ì´ˆ íƒ€ì„ì•„ì›ƒ (AbortController)
3. ì—ëŸ¬ ì‹œ ë©”ì‹œì§€ + [ë‹¤ì‹œ ì‹œë„] ë²„íŠ¼
4. ì„±ê³µ ì‹œ `setWorldHistory()`, `setCurrentPhase('simulation')`
5. [ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘], [ì—­ì‚¬ íƒ­ì—ì„œ í™•ì¸] ë²„íŠ¼ í‘œì‹œ

### ì¶”ê°€ëœ ì•¡ì…˜
- `run_simulation`: ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜ (TODO)
- `view_history`: ì‚¬ì´ë“œ íŒ¨ë„ "ì—­ì‚¬" íƒ­ìœ¼ë¡œ ì „í™˜

---

## ì‘ê°€ ëŒ€í™” AI í˜¸ì¶œ ë²„ê·¸ ìˆ˜ì • (2026-02-10)

### ë¬¸ì œ
- ëª¨ë“  ë ˆì´ì–´ í™•ì • í›„ (`currentLayer === 'novel'`) ì–´ë–¤ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë„ í•˜ë“œì½”ë”©ëœ ì‘ë‹µë§Œ ë°˜í™˜
- APIì—ì„œ `layer === 'novel'`ì¼ ë•Œ Claude API í˜¸ì¶œ ì—†ì´ ë°”ë¡œ ë°˜í™˜

### í•´ê²° ë°©ë²•

#### API ìˆ˜ì • (`app/api/author-chat/route.ts`)
1. `action: 'conversation'` íƒ€ì… ì¶”ê°€
2. `conversationHistory`, `currentPhase` íŒŒë¼ë¯¸í„° ì¶”ê°€
3. `buildConversationPrompt()` í•¨ìˆ˜ ì¶”ê°€:
   - í”„ë¡œì íŠ¸ ì •ë³´ (ì¥ë¥´, í†¤, ì‹œì , í˜„ì¬ ë‹¨ê³„)
   - ì™„ì„±ëœ ì„¸ê³„ ìš”ì•½ (ëŒ€ë¥™, ì£¼ì¸ê³µ, ë¹ŒëŸ°, ë–¡ë°¥)
   - ìµœê·¼ ëŒ€í™” ê¸°ë¡ (ë§ˆì§€ë§‰ 10ê°œ)
   - í™˜ë‹˜ì˜ í˜„ì¬ ë©”ì‹œì§€
4. `layer === 'novel'`ì¼ ë•Œë„ ì‹¤ì œ Claude API í˜¸ì¶œ

#### í´ë¼ì´ì–¸íŠ¸ ìˆ˜ì • (`app/projects/[id]/page.tsx`)
- novel ë‹¨ê³„ì—ì„œ `action: 'conversation'` ì‚¬ìš©
- ëŒ€í™” ê¸°ë¡(`conversationHistory`) ì „ë‹¬
- í˜„ì¬ ë‹¨ê³„(`currentPhase`) ì „ë‹¬

### ì´ì œ ë™ì‘í•˜ëŠ” ê²ƒ
- ì–´ë–¤ ì§ˆë¬¸ì´ë“  ë§¥ë½ì— ë§ëŠ” ì‹¤ì œ AI ì‘ë‹µ
- ì„¸ê³„/ìºë¦­í„°/ìŠ¤í† ë¦¬ì— ëŒ€í•œ ì§ˆë¬¸ì— ë§Œë“  ì„¸ê³„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€
- ì§„í–‰ ìƒí™© ë¬¸ì˜ì— í˜„ì¬ ë‹¨ê³„ì™€ ë‹¤ìŒ í•  ì¼ ì•ˆë‚´

### í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ (2026-02-10)

---

## ì—í”¼ì†Œë“œ í¸ì§‘ ê¸°ëŠ¥ êµ¬í˜„ (2026-02-10)

1í™”ê°€ ì‘ì„±ëì„ ë•Œ í™˜ë‹˜ì´ í•  ìˆ˜ ìˆëŠ” 3ê°€ì§€ ì•¡ì…˜ì„ êµ¬í˜„í–ˆë‹¤.

### êµ¬í˜„ëœ ê¸°ëŠ¥

#### 1. ë¶€ë¶„ ìˆ˜ì • (Partial Edit)
- ë³¸ë¬¸ì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ë“œë˜ê·¸ë¡œ ì„ íƒí•˜ë©´ "ì´ ë¶€ë¶„ ìˆ˜ì •" ë²„íŠ¼ í‘œì‹œ
- ì„ íƒí•œ í…ìŠ¤íŠ¸ + ìˆ˜ì • ë°©í–¥ ì…ë ¥ â†’ `/api/revise-episode` (mode: 'partial')
- í•´ë‹¹ ë¶€ë¶„ë§Œ ìˆ˜ì •ë˜ê³  ë‚˜ë¨¸ì§€ëŠ” ìœ ì§€

#### 2. ì „ì²´ í”¼ë“œë°± (Full Feedback)
- ë³¸ë¬¸ ì•„ë˜ "ì „ì²´ í”¼ë“œë°±" ë²„íŠ¼ â†’ textarea ì…ë ¥
- í”¼ë“œë°± ë‚´ìš© ì „ì†¡ â†’ `/api/revise-episode` (mode: 'full')
- ì „ì²´ ë³¸ë¬¸ì„ í”¼ë“œë°±ì— ë§ì¶° ìˆ˜ì •

#### 3. ì±„íƒ â†’ ë‹¤ìŒ í™” (Adopt)
- "ì±„íƒ â†’ ë‹¤ìŒ í™”" ë²„íŠ¼ í´ë¦­
- í˜„ì¬ ì—í”¼ì†Œë“œ statusë¥¼ 'final'ë¡œ ë³€ê²½
- ë‹¤ìŒ í™” ì‘ì„± ì—¬ë¶€ ì„ íƒì§€ í‘œì‹œ

### ìƒˆ ì»´í¬ë„ŒíŠ¸

**`components/episode/EpisodeViewer.tsx`**
- ì—í”¼ì†Œë“œ ë³¸ë¬¸ í‘œì‹œ (ì†Œì„¤ ìŠ¤íƒ€ì¼ ë Œë”ë§)
- í…ìŠ¤íŠ¸ ì„ íƒ ê°ì§€ (window.getSelection)
- ë¶€ë¶„ ìˆ˜ì • íŒì—… UI
- ì „ì²´ í”¼ë“œë°± ì…ë ¥ UI
- ì±„íƒ ë²„íŠ¼

### API ìˆ˜ì •

**`app/api/revise-episode/route.ts`**
- `mode: 'partial' | 'full'` íŒŒë¼ë¯¸í„° ì¶”ê°€
- `selectedText` íŒŒë¼ë¯¸í„° (partial ëª¨ë“œìš©)
- ë¶€ë¶„ ìˆ˜ì •: ì„ íƒí•œ í…ìŠ¤íŠ¸ë§Œ ìˆ˜ì • í›„ ì „ì²´ ë³¸ë¬¸ì— ë°˜ì˜
- ì „ì²´ ìˆ˜ì •: í”¼ë“œë°± ë°˜ì˜í•˜ì—¬ ì „ì²´ ì¬ì‘ì„±

### í˜ì´ì§€ ìˆ˜ì •

**`app/projects/[id]/page.tsx`**
- `updateEpisode`, `addEpisode` ìŠ¤í† ì–´ í•¨ìˆ˜ ì¶”ê°€
- `editingEpisodeId`, `isRevising` ìƒíƒœ ì¶”ê°€
- `handlePartialEdit`, `handleFullFeedback`, `handleAdopt` í•¸ë“¤ëŸ¬ êµ¬í˜„
- `write_next_episode`, `revert_adopt` ì•¡ì…˜ í•¸ë“¤ëŸ¬ ì¶”ê°€
- EpisodeViewer ì¡°ê±´ë¶€ ë Œë”ë§ (currentLayer === 'novel' && editingEpisodeId)
- ì‚¬ì´ë“œ íŒ¨ë„ ì›ê³  íƒ­ì—ì„œ ì—í”¼ì†Œë“œ í´ë¦­ìœ¼ë¡œ í¸ì§‘ ëª¨ë“œ ì „í™˜

### íë¦„

```
1í™” ì‘ì„± ì™„ë£Œ
  â†“
EpisodeViewer í‘œì‹œ (ë³¸ë¬¸ ì½ê¸°)
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [í…ìŠ¤íŠ¸ ì„ íƒ] â†’ "ì´ ë¶€ë¶„ ìˆ˜ì •" â†’ ë¶€ë¶„ ìˆ˜ì • â”‚
â”‚ [ì „ì²´ í”¼ë“œë°±] â†’ í”¼ë“œë°± ì…ë ¥ â†’ ì „ì²´ ìˆ˜ì •   â”‚
â”‚ [ì±„íƒ â†’ ë‹¤ìŒ í™”] â†’ í™•ì • â†’ ë‹¤ìŒ í™” ì—¬ë¶€   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
[ë‹¤ìŒ í™” ì‘ì„±] â†’ 2í™” ì§‘í•„ ì‹œì‘
```

### í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ (2026-02-10)

---

## ì—í”¼ì†Œë“œ ë¶„ëŸ‰ ë° ë¬¸ì²´ ê°œì„  (2026-02-10)

### ë¬¸ì œ
- ì—í”¼ì†Œë“œ ë¶„ëŸ‰ì´ ì•½ 1,900ìë¡œ ë„ˆë¬´ ì§§ìŒ
- ë„¤ì´ë²„ ì›¹ì†Œì„¤ ì—°ì¬ ê¸°ì¤€ ìµœì†Œ 5,000ì ì´ìƒ í•„ìš”
- "ëŠªì´ë‹¤. ë°œì´ ë¹ ì§„ë‹¤." ê°™ì€ ì§§ì€ ë¬¸ì¥ë§Œ ë‚˜ì—´ë˜ëŠ” ë¬¸ì²´

### í•´ê²°

#### 1. ë¶„ëŸ‰ ì§€ì‹œ ê°•í™” (`app/api/write-episode/route.ts`)
```
ë¶„ëŸ‰ ì ˆëŒ€ ê·œì¹™:
- ë°˜ë“œì‹œ 5,000ì ì´ìƒ 7,000ì ì´í•˜ë¡œ ì‘ì„±
- ì¥ë©´ì„ ì¶©ë¶„íˆ ë¬˜ì‚¬
- ì¸ë¬¼ì˜ ë‚´ë©´ì„ ê¹Šì´ íŒŒê³ ë“¦
- ê°ê°ì  ë””í…Œì¼ì„ í’ë¶€í•˜ê²Œ
- ì„œìˆ ê³¼ ë¬˜ì‚¬ë¥¼ ì¶©ë¶„íˆ ë„£ì„ ê²ƒ
```

#### 2. ë¶„ëŸ‰ ê²€ì¦ ë° ìë™ ì¬ì‹œë„
- ì‘ë‹µ ë°›ì€ í›„ ê¸€ì ìˆ˜ ì²´í¬
- 4,000ì ë¯¸ë§Œì´ë©´ ë³´ê°• ìš”ì²­í•˜ì—¬ ì¬ìƒì„±
- ìµœëŒ€ 2íšŒ ì¬ì‹œë„
- ë³´ê°• í”„ë¡¬í”„íŠ¸:
  - ì¥ë©´ ë¬˜ì‚¬ êµ¬ì²´í™” (ê³µê°„, ë¹›, ì†Œë¦¬, ëƒ„ìƒˆ, ì˜¨ë„)
  - ì¸ë¬¼ ë‚´ë©´ ì‹¬ë¦¬ í™•ì¥
  - ë™ì‘ ì„¬ì„¸í•˜ê²Œ í’€ì–´ì“°ê¸°
  - ë°°ê²½/ë¶„ìœ„ê¸° ë¬˜ì‚¬ ì¶”ê°€
  - ê³¼ê±° íšŒìƒ/ìƒê° ì‚½ì…

#### 3. ë¬¸ì²´ ë¦¬ë“¬ ê·œì¹™ ì¶”ê°€
```
- ì§§ì€ ë¬¸ì¥ê³¼ ê¸´ ì„œìˆ ì„ ë¦¬ë“¬ê° ìˆê²Œ ì„ì„ ê²ƒ
- ì•¡ì…˜ì€ ì§§ê²Œ, ì‹¬ë¦¬/ë¬˜ì‚¬ëŠ” ê¸¸ê²Œ
- í•œ ì¥ë©´ ì•ˆì—ì„œ ì‹œê°/ì²­ê°/ì´‰ê°/í›„ê° ì¤‘ ìµœì†Œ 2ê°€ì§€ ê°ê° í¬í•¨

ì˜ëª»ëœ ì˜ˆ: "ëŠªì´ë‹¤. ë°œì´ ë¹ ì§„ë‹¤. ì§„í™íƒ•ì´ë‹¤."
ì˜¬ë°”ë¥¸ ì˜ˆ: "ëŠªì´ë‹¤. ë°œëª©ê¹Œì§€ ë¹ ì ¸ë“  ì§„í™ì´ ì°¨ê°‘ê²Œ ì‚´ì„ ë¬¼ì—ˆë‹¤.
           ì©ì€ í’€ëƒ„ìƒˆê°€ ì½”ë¥¼ ì°”ë €ê³ , ì–´ë””ì„ ê°€ ë»ê¾¸ê¸°ê°€ ìš¸ì—ˆë‹¤..."
```

#### 4. API ì„¤ì • ë³€ê²½
- `max_tokens`: 8000 â†’ 16000 (ë¶„ëŸ‰ ì¦ê°€ ëŒ€ì‘)
- ìƒìˆ˜ ì •ì˜:
  - `MIN_CHAR_COUNT = 4000` (ì¬ì‹œë„ ê¸°ì¤€)
  - `TARGET_MIN_CHAR = 5000`
  - `TARGET_MAX_CHAR = 7000`
  - `MAX_RETRY = 2`

### ìˆ˜ì •ëœ íŒŒì¼
- `app/api/write-episode/route.ts` - ì „ë©´ ì¬ì‘ì„±

---

## ìƒì—… ì›¹ì†Œì„¤ ì§‘í•„ ê·œì¹™ ì ìš© (instruction-commercial-writing.md, 2026-02-10)

`write-episode` APIì— ìƒì—… ì›¹ì†Œì„¤ ì§‘í•„ ê·œì¹™ ì „ì²´ ë°˜ì˜.

### ì—í”¼ì†Œë“œ ë²ˆí˜¸ë³„ ë¯¸ì…˜ ë¶„ê¸°

| í™” | ë¯¸ì…˜ |
|----|------|
| 1í™” | ìƒí™© + ê°ˆë“± + ë¯¸ìŠ¤í„°ë¦¬. ì‹œì‘ì´ì§€ ëì´ ì•„ë‹˜. |
| 2í™” | ì£¼ì¸ê³µ ëŠ¥ë ¥ íŒíŠ¸. ì™„ì „íˆ ë³´ì—¬ì£¼ì§€ ì•ŠìŒ. |
| 3í™” | ì‚¬ê±´ í­ë°œ. ìŒ“ì€ ê¸´ì¥ì´ í„°ì§. |
| 4í™” | ì—°ê²°ê³¼ í™•ì¥. 5í™” ì¤‘ë… í¬ì¸íŠ¸ í–¥í•´ ì¤€ë¹„. |
| 5í™” | ì¤‘ë… í¬ì¸íŠ¸ í™•ì •. ì •ì²´ì„±/ëª©í‘œ/ë§¤ë ¥/ì„¸ê³„ê·œì¹™ í™•ë¦½. |
| 6í™”+ | ë§¤ í™” ë³´ìƒ + í´ë¦¬í”„í–‰ì–´ ìœ ì§€. |

### ë°˜ì˜ëœ ê·œì¹™

1. **ìºë¦­í„° ìƒí’ˆì„±**
   - íŒ”ë¦¬ëŠ” ì£¼ì¸ê³µ: ëŠ¥ë ¥/ê²°ë‹¨ë ¥/ëª…í™•í•œ ê°ì •/ê°•í•œ ìš•ë§/ì ê·¹ì  í–‰ë™
   - ê¸ˆì§€: ìˆ˜ë™ì /ê³ ë¯¼ë§Œ/í‰ë²”í•¨ ê°•ì¡°/ëŠ¦ì€ ì„±ì¥

2. **íšŒì°¨ ë³´ìƒ êµ¬ì¡°**
   - ì •ë³´/ê°ì •/ëŠ¥ë ¥/ì „ê°œ ë³´ìƒ ì¤‘ 1ê°œ ì´ìƒ í•„ìˆ˜
   - ì•„ë¬´ ì¼ë„ ì•ˆ ì¼ì–´ë‚˜ëŠ” í™” = ë…ì ì´íƒˆ

3. **í´ë¦¬í”„í–‰ì–´ í•„ìˆ˜**
   - ë§ˆì§€ë§‰ 2ì¤„ì´ ë‹¤ìŒ í™” í´ë¦­ ê²°ì •
   - ìœ„ê¸°/ë°œê²¬/ë°˜ì „/ì„ ì–¸ ì¤‘ íƒ1

4. **ì†ë„ê°ê³¼ ë¦¬ë“¬**
   - í•œ ì¥ë©´ 800ì ì´ë‚´
   - ì‚¬ê±´ ì—†ì´ 1,500ì ê¸ˆì§€
   - ê¸´ ë¬˜ì‚¬ â†’ ê¸´ ì‹¬ë¦¬ â†’ ì§§ì€ í–‰ë™ â†’ ì„íŒ©íŠ¸

5. **ëŒ€ì‚¬ ê·œì¹™**
   - ì§§ê³  ì„±ê²© ë“œëŸ¬ë‚˜ê³  ì •ë³´+ê°ì • í¬í•¨
   - ëŒ€ì‚¬ ì „í›„ì— í‘œì •/íƒœë„/ë™ì‘ í•„ìˆ˜

6. **ê°ì • íƒ€ì´ë°**
   - ì‚¬ê±´ â†’ ë°˜ì‘(1ì¤„) â†’ í–‰ë™(1ì¤„)
   - ì‘ê°€ê°€ ìš¸ë©´ ë…ì ì•ˆ ì›€. ì‘ê°€ê°€ ì°¸ìœ¼ë©´ ë…ìê°€ ì›€.

7. **ë°˜ë³µ ì œê±°**
   - í•œ ë¬¸ë‹¨ì— ê°™ì€ ë‹¨ì–´ 2íšŒ ê¸ˆì§€
   - ê°™ì€ ì •ë³´ 2ë²ˆ ì„¤ëª… ê¸ˆì§€

---

## ì§‘í•„ í”„ë¡¬í”„íŠ¸ ê°•í™” + í™˜ë‹˜ ìˆ˜ì • ë°˜ì˜ ì‹œìŠ¤í…œ (2026-02-10)

### 1. ì§‘í•„ ì „ ì„¤ê³„ ê³¼ì •

write-episode APIì— ì¥ë©´ ì„¤ê³„ + ìê°€ ìˆ˜ì • ì§€ì‹œ ì¶”ê°€:

```
## ì§‘í•„ ì „ ì„¤ê³„ ê³¼ì • (ë°˜ë“œì‹œ ë”°ë¥¼ ê²ƒ)

1. ë¨¼ì € ì´ í™”ì˜ ì¥ë©´ êµ¬ì„±ì„ ì„¤ê³„í•˜ì„¸ìš”
2. ê° ì¥ë©´ì—ì„œ ì£¼ì¸ê³µì˜ ì‹¬ë¦¬ ìƒíƒœë¥¼ ì •ë¦¬í•˜ì„¸ìš”
3. ê·¸ ì‹¬ë¦¬ê°€ í–‰ë™ìœ¼ë¡œ ë“œëŸ¬ë‚˜ë„ë¡ ì§‘í•„í•˜ì„¸ìš”

## ìê°€ ìˆ˜ì • (ì‘ì„± í›„ ì ê²€)

ë‹¤ìŒ íŠ¹ì§•ì´ ë³´ì´ë©´ ìŠ¤ìŠ¤ë¡œ ìˆ˜ì •í•˜ì„¸ìš”:
- ë„ˆë¬´ ê· ì¼í•œ ë¬¸ì¥ ê¸¸ì´ â†’ ì§§ê³  ê¸´ ë¬¸ì¥ ì„ê¸°
- ê°ì • ì§ì ‘ ì„œìˆ  â†’ í–‰ë™ê³¼ ê°ê°ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸°
- ì •ëˆëœ ë‚˜ì—´ êµ¬ì¡° â†’ ë¦¬ë“¬ê° ìˆê²Œ ì¬ë°°ì¹˜
- ì„¤ëª…ì  ì„œìˆ  â†’ ì‚¬ê±´ ì†ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ

ì•½ê°„ ê±°ì¹œ ì´ˆê³  ëŠë‚Œì„ ìœ ì§€í•˜ì„¸ìš”.
```

### 2. í™˜ë‹˜ ì§ì ‘ í¸ì§‘ ëª¨ë“œ

**Episode íƒ€ì… í™•ì¥:**
```typescript
interface Episode {
  content: string;           // ì‘ê°€ê°€ ì“´ ì›ë³¸
  editedContent?: string;    // í™˜ë‹˜ì´ ìˆ˜ì •í•œ ë³¸ë¬¸
  // ...
}

// í—¬í¼ í•¨ìˆ˜
getEpisodeFinalContent(episode): string  // editedContent ?? content
```

**EpisodeViewer í¸ì§‘ ê¸°ëŠ¥:**
- ë”ë¸”í´ë¦­ ë˜ëŠ” [ì§ì ‘ í¸ì§‘] ë²„íŠ¼ â†’ textarea ëª¨ë“œ ì „í™˜
- ESCë¡œ ì·¨ì†Œ, [ìˆ˜ì • ì™„ë£Œ] ë²„íŠ¼ìœ¼ë¡œ ì €ì¥
- ìˆ˜ì •ë³¸ì€ `editedContent`ì— ì €ì¥
- í—¤ë”ì— "ìˆ˜ì •ë¨" ë°°ì§€ í‘œì‹œ

### 3. ì´ì „ í™” ìµœì¢…ë³¸ ë°˜ì˜

ë‹¤ìŒ í™” ì§‘í•„ ì‹œ í™˜ë‹˜ ìˆ˜ì •ë³¸ì„ í”„ë¡¬í”„íŠ¸ì— í¬í•¨:

```
## ì´ì „ í™” ìµœì¢…ë³¸ (í™˜ë‹˜ ìˆ˜ì • ë°˜ì˜)

ì•„ë˜ëŠ” {N}í™”ì˜ ì „ì²´ ë³¸ë¬¸ì…ë‹ˆë‹¤.
í™˜ë‹˜ì´ ì§ì ‘ ìˆ˜ì •í•œ ìµœì¢…ë³¸ì…ë‹ˆë‹¤.
ì´ ë¬¸ì²´, í†¤, ë¦¬ë“¬ì„ ìœ ì§€í•˜ë©´ì„œ ë‹¤ìŒ í™”ë¥¼ ì´ì–´ì„œ ì‘ì„±í•˜ì„¸ìš”.
í™˜ë‹˜ì˜ ìˆ˜ì • ë°©í–¥ì„±ì„ ë°˜ì˜í•˜ì„¸ìš”.

{previousEpisodeFinalContent}
```

### ë³€ê²½ëœ íŒŒì¼

1. `lib/types/index.ts`
   - `Episode.editedContent` í•„ë“œ ì¶”ê°€
   - `getEpisodeFinalContent()` í—¬í¼ í•¨ìˆ˜ ì¶”ê°€

2. `app/api/write-episode/route.ts`
   - ì¥ë©´ ì„¤ê³„ + ìê°€ ìˆ˜ì • ì§€ì‹œ ì¶”ê°€
   - ì´ì „ í™” ìµœì¢…ë³¸(3000ì) í”„ë¡¬í”„íŠ¸ì— í¬í•¨
   - `getEpisodeFinalContent` ì‚¬ìš©

3. `components/episode/EpisodeViewer.tsx`
   - `editedContent`, `onDirectEdit` props ì¶”ê°€
   - í¸ì§‘ ëª¨ë“œ (textarea) êµ¬í˜„
   - "ìˆ˜ì •ë¨" ë°°ì§€ í‘œì‹œ

4. `app/projects/[id]/page.tsx`
   - `handleDirectEdit` í•¸ë“¤ëŸ¬ ì¶”ê°€
   - EpisodeViewerì— ìƒˆ props ì „ë‹¬

---

## 4ë‹¨ê³„ ì‚¬ê³  ì‹œìŠ¤í…œ ì ìš© (instruction-writing-system-final.md, 2026-02-10)

`write-episode` APIë¥¼ 4ë‹¨ê³„ ì‚¬ê³  ì‹œìŠ¤í…œìœ¼ë¡œ ì „ë©´ êµì²´.

### í•µì‹¬ ë³€ê²½

**ê¸°ì¡´ ë°©ì‹:** ì—í”¼ì†Œë“œë³„ ë¯¸ì…˜ + ìƒì—… ê·œì¹™ ë‚˜ì—´
**ìƒˆ ë°©ì‹:** 3ëª…ì˜ ì „ë¬¸ê°€ê°€ í˜‘ì—…í•˜ëŠ” ì‘ê°€ì‹¤ ëª¨ë¸

### 4ë‹¨ê³„ ì‚¬ê³  ì‹œìŠ¤í…œ

| ë‹¨ê³„ | ì—­í•  | í•µì‹¬ ì‘ì—… |
|------|------|----------|
| 1ë‹¨ê³„ | ê°ì • ê°ë… (Emotion Director) | ê°ì • ì‹œì‘ì /ë³€í™”ì /í­ë°œì  ì„¤ê³„. ê°ì •ì€ í–‰ë™ìœ¼ë¡œë§Œ ë“œëŸ¬ëƒ„ |
| 2ë‹¨ê³„ | ì¥ë©´ ê°ë… (Scene Director) | ì¹´ë©”ë¼ ì‹œì , ê³µê°„/ì†Œë¦¬/ì›€ì§ì„, ê¸´ì¥ ê³¡ì„  ì„¤ê³„ |
| 3ë‹¨ê³„ | ì´ˆê³  ì§‘í•„ (Writer) | ì„¤ëª… ìµœì†Œ, í–‰ë™ ì¤‘ì‹¬. ë¬¸ì¥ ë¦¬ë“¬ íŒ¨í„´ ì ìš© |
| 4ë‹¨ê³„ | ìˆ˜ì • (Editor) | AI ëŠë‚Œ ì œê±°, ê±°ì¹œ ì´ˆê³  ëŠë‚Œ ìœ ì§€ |

**í•µì‹¬ ê·œì¹™:**
- ì¤‘ê°„ ê³¼ì •(1~4ë‹¨ê³„ ë©”ëª¨)ì€ ì ˆëŒ€ ì¶œë ¥í•˜ì§€ ì•ŠìŒ
- ìµœì¢… ì†Œì„¤ ë³¸ë¬¸ë§Œ ì¶œë ¥

### ìƒˆ í”„ë¡¬í”„íŠ¸ êµ¬ì¡°

```
[ì‘ê°€ í˜ë¥´ì†Œë‚˜]
[ì‹œì ]
[ì„¸ê³„ê´€] - confirmedLayers.world, coreRules, seeds
[ì£¼ì¸ê³µ/ë¹ŒëŸ°] - confirmedLayers.heroArc, villainArc
[ê¶ê·¹ì˜ ë–¡ë°¥] - confirmedLayers.ultimateMystery
[ìºë¦­í„° í˜„ì¬ ìƒíƒœ] - characterProfiles
[ì´ì „ í™” â€” í™˜ë‹˜ ìµœì¢…ë³¸] - previousEpisode.finalContent
[ê¸°ì–µ ì”ìƒ] - characterMemories (í–‰ë™ì—ë§Œ ë°˜ì˜, ì§ì ‘ ì–¸ê¸‰ ê¸ˆì§€)
[ì´ í™” ì •ë³´] - episodeNumber, authorDirection
[ì´ˆë°˜ 5í™” ê°€ì´ë“œë¼ì¸]

=== 1ë‹¨ê³„: ê°ì • ê°ë… ===
=== 2ë‹¨ê³„: ì¥ë©´ ê°ë… ===
=== 3ë‹¨ê³„: ì´ˆê³  ì§‘í•„ ===
=== 4ë‹¨ê³„: ìˆ˜ì • ===

=== ì¶œë ¥ ê·œì¹™ ===
```

### API íŒŒë¼ë¯¸í„° í™•ì¥

```typescript
// POST /api/write-episode
{
  episodeNumber: number;
  projectConfig: {...};
  confirmedLayers?: {
    world?: string;
    coreRules?: string;
    seeds?: string;
    heroArc?: string;
    villainArc?: string;
    ultimateMystery?: string;
  };
  characterProfiles?: string;   // ìºë¦­í„° í˜„ì¬ ìƒíƒœ
  characterMemories?: string;   // ê¸°ì–µ ì”ìƒ (ê²½í—˜ ìš”ì•½)
  previousEpisodes?: Episode[];
  authorDirection?: string;     // ì´ í™” ë°©í–¥
}
```

### ë¬¸ì²´ ê·œì¹™ ìš”ì•½

| ê·œì¹™ | ì„¤ëª… |
|------|------|
| ê°ì • í‘œí˜„ | "ìŠ¬íë‹¤" ê¸ˆì§€ â†’ "ì†ì´ ë–¨ë ¸ë‹¤. ì´ë¥¼ ê¹¨ë¬¼ì—ˆë‹¤." |
| ë¬¸ì¥ ë¦¬ë“¬ | ì§§ì€ 3~5ê°œ ì—°ì† â†’ ê¸´ 1~2ê°œ â†’ ì„íŒ©íŠ¸ ë‹¨ë…í–‰ |
| ëŒ€ì‚¬ | ì§§ê³  ê°•ë ¬, ì „í›„ì— í‘œì •/íƒœë„/ë™ì‘ í•„ìˆ˜ |
| ì™•ë³µ ëŒ€ì‚¬ | A í•œì¤„ B í•œì¤„ ë°˜ë³µ ê¸ˆì§€ |
| ê¸°ì–µ ì”ìƒ | ì´ì „ ê²½í—˜ì„ í–‰ë™/ë§ì„¤ì„ì—ë§Œ ë°˜ì˜ |
| ë§ˆí¬ë‹¤ìš´ | ì ˆëŒ€ ê¸ˆì§€ (ë³¼ë“œ, ì´íƒ¤ë¦­, ì œëª©, ëª©ë¡ ë“±) |
| ë¶„ëŸ‰ | 5,000ì ì´ìƒ 7,000ì ì´í•˜ |
| í´ë¦¬í”„í–‰ì–´ | ë§¤ í™” ë§ˆì§€ë§‰ 2ì¤„ (ìœ„ê¸°/ë°œê²¬/ë°˜ì „/ì„ ì–¸) |
| ë³´ìƒ | ë§¤ í™” 1ê°œ ì´ìƒ (ì •ë³´/ê°ì •/ëŠ¥ë ¥/ì „ê°œ) |

### ë¶„ëŸ‰ ê²€ì¦

- 4,000ì ë¯¸ë§Œ ì‹œ ìë™ ì¬ìƒì„± (ìµœëŒ€ 2íšŒ)
- ì¬ìƒì„± í”„ë¡¬í”„íŠ¸ì— ì¥ë©´ ë¬˜ì‚¬/ë‚´ë©´ ì„œìˆ  ë³´ê°• ì§€ì‹œ

### ë³€ê²½ëœ íŒŒì¼

1. `app/api/write-episode/route.ts` - 4ë‹¨ê³„ ì‚¬ê³  ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ë¡œ ì „ë©´ êµì²´

### í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ (2026-02-10)

---

## í”¼ë“œë°± ëˆ„ì  í•™ìŠµ ì‹œìŠ¤í…œ (2026-02-11 ì™„ë£Œ)

í™˜ë‹˜ì˜ í”¼ë“œë°±ì„ ìë™ ë¶„ë¥˜í•˜ì—¬ ëˆ„ì  ì €ì¥í•˜ê³ , ë‹¤ìŒ í™” ì§‘í•„ ì‹œ ë°˜ì˜í•˜ëŠ” ì‹œìŠ¤í…œ.

### í•µì‹¬ ê°œë…

1. **í”¼ë“œë°± ê°ì§€**: ì‚¬ìš©ì ë©”ì‹œì§€ì—ì„œ í”¼ë“œë°± í‚¤ì›Œë“œ ê°ì§€
2. **í”¼ë“œë°± ë¶„ë¥˜**: 1íšŒì„± vs ëˆ„ì í˜• ìë™ ë¶„ë¥˜
3. **ëˆ„ì  ì €ì¥**: `feedbackHistory` ë°°ì—´ì— ì €ì¥ (localStorage persist)
4. **ì§‘í•„ ë°˜ì˜**: ë‹¤ìŒ í™” í”„ë¡¬í”„íŠ¸ì— ëˆ„ì  í”¼ë“œë°± í¬í•¨

### í”¼ë“œë°± ìœ í˜• (FeedbackType)

| ìœ í˜• | í‚¤ì›Œë“œ ì˜ˆì‹œ | ëˆ„ì  ì—¬ë¶€ |
|------|-------------|----------|
| style | ë¬¸ì²´, í†¤, ìŠ¤íƒ€ì¼, ë§íˆ¬, í‘œí˜„, ë¬˜ì‚¬ | ëŒ€ë¶€ë¶„ ëˆ„ì  |
| character | ìºë¦­í„°, ì¸ë¬¼, ì„±ê²© | ìƒí™©ì— ë”°ë¼ |
| plot | ì „ê°œ, ìŠ¤í† ë¦¬, í”Œë¡¯ | ìƒí™©ì— ë”°ë¼ |
| pacing | ì†ë„, í˜ì´ìŠ¤, ë¹ ë¥´ë‹¤, ëŠë¦¬ë‹¤ | ëŒ€ë¶€ë¶„ ëˆ„ì  |
| general | ê¸°íƒ€ | ìƒí™©ì— ë”°ë¼ |

### ëˆ„ì í˜• vs 1íšŒì„± íŒë‹¨

**ëˆ„ì í˜• í”¼ë“œë°± (isRecurring: true)**
- ë¬¸ì²´/ìŠ¤íƒ€ì¼/í†¤ ê´€ë ¨ í”¼ë“œë°±
- í˜ì´ìŠ¤ ê´€ë ¨ í”¼ë“œë°±
- "í•­ìƒ", "ê³„ì†", "ë§¤ë²ˆ", "ì „ë°˜ì " í‚¤ì›Œë“œ í¬í•¨
- íŠ¹ì • ì¥ë©´ ì–¸ê¸‰ ì—†ìŒ

**1íšŒì„± í”¼ë“œë°± (isRecurring: false)**
- "ì´ ì¥ë©´", "ì—¬ê¸°ì„œ", "ì´ ë¶€ë¶„" ë“± íŠ¹ì • ìœ„ì¹˜ ì–¸ê¸‰
- ì„¤ì • ì˜¤ë¥˜, ëª¨ìˆœ ì§€ì 
- íŠ¹ì • ëŒ€ì‚¬/í–‰ë™ ìˆ˜ì • ìš”ì²­

### í”„ë¡¬í”„íŠ¸ ë°˜ì˜ í˜•ì‹

```
### í™˜ë‹˜ í”¼ë“œë°± (ëˆ„ì  - ë°˜ë“œì‹œ ë°˜ì˜)

[ë¬¸ì²´/ìŠ¤íƒ€ì¼]
- ëŒ€ì‚¬ê°€ ë„ˆë¬´ ê¸¸ì–´. ë” ì§§ê²Œ ì¨ì¤˜.
- í†¤ì´ ë„ˆë¬´ ë°ì•„. ì–´ë‘ìš´ ë¶„ìœ„ê¸° ìœ ì§€í•´.

[í˜ì´ìŠ¤]
- ì „ê°œê°€ ë„ˆë¬´ ë¹¨ë¼. ì—¬ìœ  ìˆê²Œ ì¨ì¤˜.

â€» ìœ„ í”¼ë“œë°±ì€ í™˜ë‹˜ì´ ì´ì „ í™”ì—ì„œ ìš”ì²­í•œ ìˆ˜ì •ì‚¬í•­ì…ë‹ˆë‹¤. ì´ë²ˆ í™”ì—ë„ ë°˜ë“œì‹œ ë°˜ì˜í•˜ì„¸ìš”.
```

### íƒ€ì… ì •ì˜

```typescript
// lib/types/index.ts
export type FeedbackType = 'style' | 'character' | 'plot' | 'pacing' | 'general';

export interface Feedback {
  id: string;
  episodeNumber: number;
  type: FeedbackType;
  content: string;
  isRecurring: boolean;
  timestamp: string;
}

// Project ì¸í„°í˜ì´ìŠ¤ì— ì¶”ê°€
feedbackHistory: Feedback[];
```

### ìŠ¤í† ì–´ ì•¡ì…˜

```typescript
// lib/store/project-store.ts
addFeedback: (feedback: Omit<Feedback, 'id' | 'timestamp'>) => void;
getRecurringFeedback: () => Feedback[];
```

### ìˆ˜ì •ëœ íŒŒì¼

1. `lib/types/index.ts` - Feedback íƒ€ì… ì¶”ê°€ (ì´ì „ ì„¸ì…˜)
2. `lib/store/project-store.ts` - addFeedback, getRecurringFeedback êµ¬í˜„
3. `app/api/author-chat/route.ts`:
   - `classifyFeedback()` - AI ì—†ì´ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ë¥˜
   - `isFeedbackMessage()` - í”¼ë“œë°± ë©”ì‹œì§€ ê°ì§€
   - `buildFeedbackSection()` - ëˆ„ì  í”¼ë“œë°±ì„ í”„ë¡¬í”„íŠ¸ë¡œ ë³€í™˜
   - ì‘ë‹µì— `feedback` í•„ë“œ í¬í•¨ (ë¶„ë¥˜ ì •ë³´)
   - ì§‘í•„ í”„ë¡¬í”„íŠ¸ì— `recurringFeedback` í¬í•¨
4. `app/api/write-episode/route.ts`:
   - `buildFeedbackSection()` - ëˆ„ì  í”¼ë“œë°±ì„ í”„ë¡¬í”„íŠ¸ë¡œ ë³€í™˜
   - `buildUserPrompt`ì— `recurringFeedback` íŒŒë¼ë¯¸í„° ì¶”ê°€
   - POST í•¸ë“¤ëŸ¬ì—ì„œ `recurringFeedback` ì¶”ì¶œ ë° ì „ë‹¬
5. `app/projects/[id]/page.tsx`:
   - `addFeedback`, `getRecurringFeedback` ìŠ¤í† ì–´ í›… ì¶”ê°€
   - API í˜¸ì¶œ ì‹œ `recurringFeedback` ì „ë‹¬
   - ì‘ë‹µì—ì„œ í”¼ë“œë°± ê°ì§€ ì‹œ `addFeedback()` í˜¸ì¶œ
   - `handleFullFeedback`ì—ì„œ ë¬¸ì²´ í”¼ë“œë°± ìë™ ì €ì¥

### ë°ì´í„° íë¦„

```
1. í™˜ë‹˜ì´ í”¼ë“œë°± ë©”ì‹œì§€ ì „ì†¡
   ì˜ˆ: "ëŒ€ì‚¬ê°€ ë„ˆë¬´ ê¸¸ì–´. ì§§ê²Œ ì¨ì¤˜."

2. author-chat APIì—ì„œ ê°ì§€ ë° ë¶„ë¥˜
   â†’ isFeedbackMessage() = true
   â†’ classifyFeedback() = { type: 'style', isRecurring: true }

3. ì‘ë‹µì— feedback í•„ë“œ í¬í•¨
   â†’ { message: "...", feedback: { type: 'style', isRecurring: true, ... } }

4. í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì €ì¥
   â†’ addFeedback({ type: 'style', content: '...', isRecurring: true })
   â†’ localStorageì— persist

5. ë‹¤ìŒ í™” ì§‘í•„ ìš”ì²­ ì‹œ
   â†’ getRecurringFeedback() = [{ type: 'style', content: 'ëŒ€ì‚¬ê°€ ë„ˆë¬´ ê¸¸ì–´...' }]
   â†’ API í˜¸ì¶œì— recurringFeedback í¬í•¨

6. write-episodeì—ì„œ í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜
   â†’ buildFeedbackSection(recurringFeedback) í˜¸ì¶œ
   â†’ "### í™˜ë‹˜ í”¼ë“œë°± (ëˆ„ì )" ì„¹ì…˜ ì¶”ê°€
```

### ì»´íŒŒì¼ ì„±ê³µ í™•ì¸ (2026-02-11)

---

## ë°°í¬ ì¤€ë¹„ (2026-02-11 ì§„í–‰ ì¤‘)

### Git ì»¤ë°‹ ì™„ë£Œ
- ì»¤ë°‹ í•´ì‹œ: `a80f9d0`
- ì»¤ë°‹ ë©”ì‹œì§€: "Initial commit: Narrative Simulator - AI Web Novel Generator"
- 112ê°œ íŒŒì¼, 31,113ì¤„ ì¶”ê°€

### Git ì„¤ì •
```
user.name: ìœ¤ì§€í™˜
user.email: hun3349@gmail.com
```

### ë°°í¬ ëŒ€ê¸° ì¤‘ - Vercel

**ë‹¤ìŒ ë‹¨ê³„:**

1. **GitHub ì €ì¥ì†Œ ìƒì„±**
   - https://github.com/new ì ‘ì†
   - Repository name: `narrative-simulator`
   - Private ì„ íƒ ê¶Œì¥
   - "Create repository" í´ë¦­

2. **ì½”ë“œ í‘¸ì‹œ**
   ```bash
   cd "C:\Users\1\Desktop\ì›¹ì†Œì„¤\narrative-simulator"
   git remote add origin https://github.com/USERNAME/narrative-simulator.git
   git branch -M main
   git push -u origin main
   ```

3. **Vercel ì—°ê²°**
   - https://vercel.com ì ‘ì† â†’ GitHub ë¡œê·¸ì¸
   - "Import Project" â†’ ì €ì¥ì†Œ ì„ íƒ
   - **Environment Variables í•„ìˆ˜ ì„¤ì •:**
     - `ANTHROPIC_API_KEY` = (API í‚¤ ê°’)
   - Deploy í´ë¦­

4. **ë°°í¬ ì™„ë£Œ í›„**
   - Vercelì´ ê³ ì • URL ì œê³µ (ì˜ˆ: `https://narrative-simulator.vercel.app`)
   - ì»¤ìŠ¤í…€ ë„ë©”ì¸ ì—°ê²° ê°€ëŠ¥

### ì£¼ì˜ì‚¬í•­
- `.env.local`ì€ gitignoreì— í¬í•¨ë¨ (API í‚¤ ì•ˆì „)
- Vercelì—ì„œ í™˜ê²½ë³€ìˆ˜ ë³„ë„ ì„¤ì • í•„ìš”
- localStorage ê¸°ë°˜ ë°ì´í„° ì €ì¥ (ë¸Œë¼ìš°ì €ë³„ ë…ë¦½)

---

## ì‹œë®¬ë ˆì´ì…˜ í†µí•© êµ¬í˜„ (2026-02-11 ì™„ë£Œ)

7-ë ˆì´ì–´ í”„ë¡œì íŠ¸ ì‹œìŠ¤í…œê³¼ ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜ ì—”ì§„ ì—°ë™ ì™„ë£Œ.

### êµ¬í˜„ ë‚´ìš©

#### 1. ë ˆì´ì–´ ë°ì´í„° â†’ ìºë¦­í„° ë³€í™˜
- `heroArc` ë ˆì´ì–´ â†’ ì£¼ì¸ê³µ Character + CharacterSeed
- `seeds` ë ˆì´ì–´ì˜ NPCs â†’ NPC Characters + CharacterSeeds
- ëª¨ë“  í•„ìˆ˜ í•„ë“œ ìë™ ìƒì„± (codename, temperament, latentAbility ë“±)

#### 2. ì„¸ê³„ ì—­ì‚¬ â†’ WorldEvent ë³€í™˜
- `worldHistory.eras` â†’ WorldEvent[] ë³€í™˜
- `keyEvents` ë°°ì—´ì„ ìˆœíšŒí•˜ë©° WorldEvent ê°ì²´ ìƒì„±
- `year`, `event`, `impact` í•„ë“œ ë§¤í•‘

#### 3. SSE ìŠ¤íŠ¸ë¦¬ë° ì‹œë®¬ë ˆì´ì…˜
- `/api/simulate` í˜¸ì¶œ (POST)
- SSE ì´ë²¤íŠ¸ íƒ€ì… ì²˜ë¦¬:
  - `progress`: ì§„í–‰ ìƒí™© í‘œì‹œ
  - `completed`: ì´ë²¤íŠ¸ ì¹´ìš´íŠ¸
  - `final_state`: ìºë¦­í„° ë°ì´í„° ì €ì¥
  - `error`: ì—ëŸ¬ ì²˜ë¦¬

#### 4. ì‹œë®¬ë ˆì´ì…˜ í›„ íë¦„
- ì„±ê³µ ì‹œ: `setCurrentPhase('writing')` + `setCurrentLayer('novel')`
- [1í™” ì“°ê¸°] ë²„íŠ¼ í‘œì‹œ
- ì‹¤íŒ¨ ì‹œ: [ë‹¤ì‹œ ì‹œë„] + [ì‹œë®¬ë ˆì´ì…˜ ê±´ë„ˆë›°ê¸°] ë²„íŠ¼

### ìˆ˜ì •ëœ íŒŒì¼

1. `app/projects/[id]/page.tsx`:
   - `setCharacters`, `setSeeds`, `setProfiles` ìŠ¤í† ì–´ í›… ì¶”ê°€
   - `run_simulation` ì•¡ì…˜ í•¸ë“¤ëŸ¬ êµ¬í˜„
   - íƒ€ì… ì˜¤ë¥˜ ìˆ˜ì •:
     - `episodeId` â†’ `episode` (Message íƒ€ì…)
     - `status: 'alive'` â†’ `'childhood'`/`'training'` (CharacterStatus íƒ€ì…)
     - `emotionalState.current` â†’ `emotionalState.primary` (EmotionalState íƒ€ì…)
     - CharacterSeed í•„ìˆ˜ í•„ë“œ ì¶”ê°€
     - WorldEvent í•„ë“œ ìˆ˜ì •

### ì‹œë®¬ë ˆì´ì…˜ íë¦„

```
[ì„¸ê³„ ì—­ì‚¬ ìƒì„± ì™„ë£Œ]
  â†“
[ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘] í´ë¦­
  â†“
ë ˆì´ì–´ ë°ì´í„°ì—ì„œ ìºë¦­í„° ìƒì„± (heroArc + seeds.npcs)
  â†“
WorldEvent ë°°ì—´ ìƒì„± (worldHistory.eras.keyEvents)
  â†“
/api/simulate SSE í˜¸ì¶œ
  â†“
ì§„í–‰ ìƒí™© í‘œì‹œ (Në…„ ì‹œë®¬ë ˆì´ì…˜ ì¤‘...)
  â†“
ì™„ë£Œ â†’ setCharacters() + setCurrentPhase('writing')
  â†“
[1í™” ì“°ê¸°] ë²„íŠ¼ í‘œì‹œ
```

### ë¹Œë“œ ì„±ê³µ í™•ì¸ (2026-02-11)

### ì‹œë®¬ë ˆì´ì…˜ API í…ŒìŠ¤íŠ¸ ì™„ë£Œ (2026-02-11)

**í…ŒìŠ¤íŠ¸ ë°©ë²•:** curlë¡œ `/api/simulate` ì§ì ‘ í˜¸ì¶œ

**ê²°ê³¼:**
- SSE ìŠ¤íŠ¸ë¦¬ë° ì •ìƒ ì‘ë™
- 0~5ë…„ ìœ ë…„ê¸° ì‹œë®¬ë ˆì´ì…˜ ì„±ê³µ
- 4ê°œ ì´ë²¤íŠ¸ ìƒì„± (ì²« ìˆ¨, ë¬´ë„ˆì§„ ê²ƒë“¤ ì‚¬ì´ì—ì„œ, ìŒì„±ì˜ ìš¸ë¦¼, í‰ì˜¨í•œ ë‚˜ë‚ )
- ê¸°ì–µ ìŠ¤íƒì— 4ê°œ ê¸°ì–µ ì €ì¥
- í”„ë¡œí•„ ë°œí˜„ (ì„±ê²© íŠ¹ì„± 5ê°œ, ëŠ¥ë ¥ 2ê°œ)
- ì‘ë‹µ ì‹œê°„: ì•½ 29ì´ˆ

**ìƒì„±ëœ ìºë¦­í„° ê¸°ì–µ ì˜ˆì‹œ:**
- "ì‹¬ì¥ë°•ë™. ì—„ë§ˆì˜ ê°€ìŠ´ ìœ„ì—ì„œ ë“¤ì—ˆë˜ ê·œì¹™ì ì¸ ë‘ë“œë¦¼."
- "ê¸ˆì†ì˜ ì°¨ê°€ì›€. ì†ê°€ë½ ëì´ ëŠê¼ˆë˜ ì˜ˆë¦¬í•œ ë¬´ì–¸ê°€."
- "ëª©ì†Œë¦¬ë“¤. ì–´ë–¤ ê²ƒì€ ì•ˆì •ì ì´ì—ˆê³ , ì–´ë–¤ ê²ƒì€ ë–¨ë ¸ë‹¤."

**ë°œí˜„ëœ ëŠ¥ë ¥:**
- "ë¬´í•œí•œ ì ì¬ë ¥ (ë°œê²¬)"
- "ìŒì„± íŒ¨í„´ ê°ì§€ - ì›ì´ˆì  ì‹ ë¢° íŒë‹¨ (ë°œê²¬)"

---

## ë‹¤ìŒ ì‘ì—… ì˜ˆì • (2026-02-12)

### 1. Vercel ë°°í¬

**ì¤€ë¹„ ìƒíƒœ:**
- âœ… í”„ë¡œë•ì…˜ ë¹Œë“œ ì„±ê³µ
- âœ… Git ì»¤ë°‹ ì™„ë£Œ (a80f9d0)
- â³ GitHub ì €ì¥ì†Œ ìƒì„± í•„ìš”
- â³ Vercel ì—°ê²° í•„ìš”

**ë°°í¬ ì ˆì°¨:**
1. GitHub ì €ì¥ì†Œ ìƒì„± (`narrative-simulator`, Private ê¶Œì¥)
2. ì½”ë“œ í‘¸ì‹œ:
   ```bash
   cd "C:\Users\1\Desktop\ì›¹ì†Œì„¤\narrative-simulator"
   git remote add origin https://github.com/[USERNAME]/narrative-simulator.git
   git branch -M main
   git push -u origin main
   ```
3. Vercel ì—°ê²° (https://vercel.com)
4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •: `ANTHROPIC_API_KEY`
5. Deploy

### 2. ëª¨ë°”ì¼ ìµœì í™”

**í˜„ì¬ ìƒíƒœ:** ë°ìŠ¤í¬í†± ìš°ì„  ì„¤ê³„, ëª¨ë°”ì¼ ë¯¸ìµœì í™”

**ìµœì í™” ëŒ€ìƒ:**

#### 2.1 ë ˆì´ì•„ì›ƒ ë°˜ì‘í˜•
- [ ] ì‚¬ì´ë“œ íŒ¨ë„: ëª¨ë°”ì¼ì—ì„œ ë°”í…€ ì‹œíŠ¸ ë˜ëŠ” í’€ìŠ¤í¬ë¦° ëª¨ë‹¬ë¡œ ë³€ê²½
- [ ] ì±„íŒ… ì˜ì—­: ëª¨ë°”ì¼ ì „ì²´ í™”ë©´ í™œìš©
- [ ] ë ˆì´ì–´ ì§„í–‰ í‘œì‹œ: ê°€ë¡œ ìŠ¤í¬ë¡¤ ë˜ëŠ” ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë³€ê²½

#### 2.2 í„°ì¹˜ ì¸í„°ë™ì…˜
- [ ] ë²„íŠ¼ í¬ê¸° ì¦ê°€ (ìµœì†Œ 44x44px)
- [ ] ì„ íƒì§€ ë²„íŠ¼ ê°„ê²© í™•ë³´
- [ ] ìŠ¤ì™€ì´í”„ ì œìŠ¤ì²˜ ì§€ì› (íƒ­ ì „í™˜)

#### 2.3 í°íŠ¸ ë° ê°€ë…ì„±
- [ ] ë³¸ë¬¸ í°íŠ¸ í¬ê¸° ì¡°ì • (ëª¨ë°”ì¼ ìµœì†Œ 16px)
- [ ] ì—í”¼ì†Œë“œ ë·°ì–´ ì¤„ê°„ê²© ìµœì í™”
- [ ] ì…ë ¥ í•„ë“œ í™•ëŒ€ ë°©ì§€ (`font-size: 16px`)

#### 2.4 ì„±ëŠ¥ ìµœì í™”
- [ ] ì´ë¯¸ì§€ lazy loading (ìˆì„ ê²½ìš°)
- [ ] ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
- [ ] ëª¨ë°”ì¼ í‚¤ë³´ë“œ ëŒ€ì‘ (ì±„íŒ… ì…ë ¥ ì‹œ ìŠ¤í¬ë¡¤)

**ì°¸ê³  ë¸Œë ˆì´í¬í¬ì¸íŠ¸:**
```css
/* Tailwind ê¸°ë³¸ */
sm: 640px   /* ëª¨ë°”ì¼ ê°€ë¡œ */
md: 768px   /* íƒœë¸”ë¦¿ */
lg: 1024px  /* ë°ìŠ¤í¬í†± */
```

**ì£¼ìš” ìˆ˜ì • ì˜ˆì • íŒŒì¼:**
- `app/globals.css` - ëª¨ë°”ì¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼
- `app/projects/[id]/page.tsx` - ë ˆì´ì•„ì›ƒ ë°˜ì‘í˜•
- `components/episode/EpisodeViewer.tsx` - ëª¨ë°”ì¼ ê°€ë…ì„±
- `components/layout/Header.tsx` - ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜

### 3. ì¶”ê°€ ê³ ë ¤ì‚¬í•­

- **PWA ì§€ì›** (ì„ íƒ): manifest.json, ì„œë¹„ìŠ¤ ì›Œì»¤ ì¶”ê°€í•˜ë©´ í™ˆ í™”ë©´ ì„¤ì¹˜ ê°€ëŠ¥
- **ë‹¤í¬ ëª¨ë“œ** (ì„ íƒ): ì´ë¯¸ Tailwind dark: ì§€ì›, í† ê¸€ UIë§Œ ì¶”ê°€í•˜ë©´ ë¨
- **ì˜¤í”„ë¼ì¸ ì§€ì›** (ì„ íƒ): localStorage ê¸°ë°˜ì´ë¼ ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°ëŠ” ìœ ì§€ë¨

---

## í˜„ì¬ ì‘ë™ ìƒíƒœ ìš”ì•½ (2026-02-11)

| ê¸°ëŠ¥ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| í”„ë¡œì íŠ¸ ìƒì„± | âœ… ì‘ë™ | ì¥ë¥´/í†¤/ì‹œì /ì‘ê°€ ì„ íƒ |
| 7ë ˆì´ì–´ êµ¬ì¶• | âœ… ì‘ë™ | ëŒ€í™”í˜• ë ˆì´ì–´ í™•ì • |
| ì„¸ê³„ ì—­ì‚¬ ìƒì„± | âœ… ì‘ë™ | 4-6ê°œ ì‹œëŒ€ ìë™ ìƒì„± |
| ìºë¦­í„° ì‹œë®¬ë ˆì´ì…˜ | âœ… ì‘ë™ | SSE ìŠ¤íŠ¸ë¦¬ë°, ìœ ë…„ê¸°~ì„±ì¸ê¸° |
| ì—í”¼ì†Œë“œ ì§‘í•„ | âœ… ì‘ë™ | 4ë‹¨ê³„ ì‚¬ê³  ì‹œìŠ¤í…œ |
| í”¼ë“œë°± ëˆ„ì  í•™ìŠµ | âœ… ì‘ë™ | ë¬¸ì²´/í˜ì´ìŠ¤ í”¼ë“œë°± ìë™ ë¶„ë¥˜ |
| ì—í”¼ì†Œë“œ í¸ì§‘ | âœ… ì‘ë™ | ë¶€ë¶„ ìˆ˜ì •/ì „ì²´ í”¼ë“œë°±/ì§ì ‘ í¸ì§‘ |
| ë‚´ë³´ë‚´ê¸° | âœ… ì‘ë™ | TXT/HTML/DOCX |
| í”„ë¡œì íŠ¸ ì €ì¥ | âœ… ì‘ë™ | localStorage + Supabase ë™ì‹œ ì €ì¥ |
| ë°ìŠ¤í¬í†± UI | âœ… ì‘ë™ | - |
| ëª¨ë°”ì¼ UI | âœ… ì‘ë™ | ë°˜ì‘í˜• ê°œì„  ì™„ë£Œ |
| ë°°í¬ | âœ… ì™„ë£Œ | Vercel ë°°í¬ë¨ |
| Supabase DB | âœ… ì‘ë™ | í”„ë¡œì íŠ¸ ìë™ ë™ê¸°í™” |

---

## Supabase DB í†µí•© (2026-02-20 ì™„ë£Œ)

### í•µì‹¬ ê¸°ëŠ¥
- **ë“€ì–¼ ì €ì¥**: localStorage + Supabase ë™ì‹œ ì €ì¥
- **ìë™ ë™ê¸°í™”**: í”„ë¡œì íŠ¸ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ Supabaseì— ì €ì¥
- **ë³‘í•© ë¡œë“œ**: ì•± ì‹œì‘ ì‹œ ë¡œì»¬ê³¼ Supabase ë°ì´í„° ë³‘í•© (ìµœì‹  ë²„ì „ ìš°ì„ )
- **ê³µìœ  í˜ì´ì§€**: `/shared/[projectId]` - ìŠ¤í¬ì¼ëŸ¬ ì œì™¸í•œ ê³µê°œ ë·°

### í™˜ê²½ ë³€ìˆ˜
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
```

### Supabase í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ (projects)
```sql
CREATE TABLE projects (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id TEXT NOT NULL,
  title TEXT NOT NULL,
  genre TEXT NOT NULL,
  tone TEXT NOT NULL,
  viewpoint TEXT NOT NULL,
  direction TEXT,
  author_persona JSONB NOT NULL,
  layers JSONB NOT NULL,
  layer_status JSONB NOT NULL,
  current_layer TEXT NOT NULL,
  current_phase TEXT NOT NULL,
  world_history JSONB,
  episodes JSONB DEFAULT '[]',
  feedback_history JSONB DEFAULT '[]',
  messages JSONB DEFAULT '[]',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ì‚¬ìš©ìë³„ í”„ë¡œì íŠ¸ ì¡°íšŒ ì¸ë±ìŠ¤
CREATE INDEX idx_projects_user_id ON projects(user_id);

-- RLS ì •ì±… (ì„ íƒ)
ALTER TABLE projects ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can CRUD own projects" ON projects
  FOR ALL USING (auth.uid()::text = user_id);
```

### íŒŒì¼ êµ¬ì¡°
```
lib/supabase/
â”œâ”€â”€ index.ts          # ëª¨ë“  export
â”œâ”€â”€ client.ts         # Supabase í´ë¼ì´ì–¸íŠ¸ + getBrowserUserId()
â”œâ”€â”€ db.ts             # CRUD í•¨ìˆ˜ (save/load/delete/getShared)
â””â”€â”€ types.ts          # Database íƒ€ì… ì •ì˜
```

### ìŠ¤í† ì–´ í™•ì¥ (`lib/store/project-store.ts`)
```typescript
// ìƒˆ í•¨ìˆ˜ë“¤
syncCurrentProjectToSupabase: () => Promise<void>;  // í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥
loadFromSupabase: () => Promise<void>;              // í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
mergeSupabaseProjects: (projects: Project[]) => void; // ë¡œì»¬ê³¼ ë³‘í•©
```

### ë™ê¸°í™” ì‹œì 
- `createProject()` â†’ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± ì‹œ
- `deleteProject()` â†’ í”„ë¡œì íŠ¸ ì‚­ì œ ì‹œ
- `updateLayer()` â†’ ë ˆì´ì–´ ìˆ˜ì • ì‹œ
- `confirmLayer()` â†’ ë ˆì´ì–´ í™•ì • ì‹œ
- `addEpisode()` â†’ ì—í”¼ì†Œë“œ ì¶”ê°€ ì‹œ
- `updateEpisode()` â†’ ì—í”¼ì†Œë“œ ìˆ˜ì • ì‹œ
- `addFeedback()` â†’ í”¼ë“œë°± ì¶”ê°€ ì‹œ

### ê³µìœ  í˜ì´ì§€ (`/shared/[projectId]`)
- `final` ìƒíƒœ ì—í”¼ì†Œë“œë§Œ í‘œì‹œ
- ë¹ŒëŸ° ì„œì‚¬, ë–¡ë°¥ ì •ë³´ ì œì™¸ (ìŠ¤í¬ì¼ëŸ¬ ë°©ì§€)
- ì„¸ê³„ê´€, ì£¼ì¸ê³µ ê¸°ë³¸ ì •ë³´ë§Œ ê³µê°œ
- ë³„ë„ ì¸ì¦ ë¶ˆí•„ìš”

### ì‚¬ìš©ì ì‹ë³„
- `getBrowserUserId()`: localStorageì— ê³ ìœ  ID ì €ì¥
- í˜•ì‹: `user_{timestamp}_{random}`
- ë¸Œë¼ìš°ì €ë³„ ë…ë¦½ (ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì ‘ê·¼ ë¶ˆê°€)

### ì˜¤í”„ë¼ì¸ ì§€ì›
- Supabase ì—°ê²° ì‹¤íŒ¨í•´ë„ localStorage ì‚¬ìš© ê°€ëŠ¥
- `isSupabaseEnabled` í”Œë˜ê·¸ë¡œ ì¡°ê±´ë¶€ ë™ê¸°í™”
- ì—ëŸ¬ëŠ” console.warnìœ¼ë¡œ ê¸°ë¡ (ì‚¬ìš©ì ì°¨ë‹¨ ì—†ìŒ)

---

## ë ˆì´ì–´ ì œì•ˆ í‘œì‹œ ë°©ì‹ ìˆ˜ì • (2026-02-20 ì™„ë£Œ)

### ë¬¸ì œ
- ì‘ê°€ê°€ ë ˆì´ì–´ë¥¼ ì œì•ˆí•  ë•Œ JSON ë°ì´í„°ê°€ ëŒ€í™”ì°½ì— ê·¸ëŒ€ë¡œ ë…¸ì¶œë¨
- ë³µì‚¬í•œ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ë¶ˆìì—°ìŠ¤ëŸ¬ìš´ UX

### í•´ê²°

#### 1. message í•„ë“œ ìì—°ì–´ ê·œì¹™ ê°•í™” (`app/api/author-chat/route.ts`)
ëª¨ë“  ë ˆì´ì–´ í”„ë¡¬í”„íŠ¸ì˜ JSON ì‘ë‹µ í˜•ì‹ì— ìì—°ì–´ ì˜ˆì‹œ ì¶”ê°€:

```json
{
  "message": "ìì—°ì–´ë¡œë§Œ 2-3ë¬¸ì¥. ì˜ˆ: 'í™©íí•œ ëŒ€ë¥™ì´ì•¼. ë¶ìª½ì—” ì–¼ì–´ë¶™ì€ ì‚°ë§¥ì´...'",
  "layer": { ... }
}
```

ì ìš©ëœ ë ˆì´ì–´:
- world: "í™©íí•œ ëŒ€ë¥™ì´ì•¼. ë¶ìª½ì—” ì–¼ì–´ë¶™ì€ ì‚°ë§¥ì´..."
- coreRules: "ì´ ì„¸ê³„ì˜ í˜ì€ ë§ˆë‚˜ì•¼. ì“¸ìˆ˜ë¡ ìˆ˜ëª…ì´ ê¹ì—¬..."
- seeds: "ì´ ì„¸ê³„ì—” ì„¸ ì„¸ë ¥ì´ ìˆì–´. ì„œë¡œ ê²¬ì œí•˜ë©´ì„œ..."
- heroArc: "ì£¼ì¸ê³µì€ ë²„ë¦¼ë°›ì€ ì•„ì´ì•¼. ë³µìˆ˜ê°€ ì•„ë‹ˆë¼ ì¸ì •ë°›ê³  ì‹¶ì€ ê±°ì§€..."
- villainArc: "ë¹ŒëŸ°ì€ ë¹„ê·¹ì ì¸ ì¸ë¬¼ì´ì•¼. ì„¸ê³„ê°€ ê·¸ë¥¼ ê´´ë¬¼ë¡œ ë§Œë“¤ì—ˆì–´..."
- ultimateMystery: "ì´ ì´ì•¼ê¸°ì˜ ì§„ì§œ ë¹„ë°€ì€ ë§ì´ì•¼... ë…ìë“¤ ì†Œë¦„ ë¼ì¹  ê±°ì•¼..."

ê° JSON ë¸”ë¡ ì•„ë˜ì— ê²½ê³  ì¶”ê°€:
```
â€» messageì—ëŠ” JSON êµ¬ì¡°ë‚˜ ë°ì´í„° ë‚˜ì—´ ì ˆëŒ€ ê¸ˆì§€. ì¹œêµ¬ì—ê²Œ ë§í•˜ë“¯ ìì—°ìŠ¤ëŸ½ê²Œ.
```

#### 2. ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒŒì‹± ê°œì„ 
Claudeê°€ ì‘ë‹µì„ ` ```json ... ``` `ë¡œ ê°ì‹¸ëŠ” ê²½ìš° ì²˜ë¦¬:

```typescript
// ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±°
let cleanText = text;
const codeBlockMatch = text.match(/```(?:json)?\s*([\s\S]*?)```/);
if (codeBlockMatch) {
  cleanText = codeBlockMatch[1].trim();
}

const jsonMatch = cleanText.match(/\{[\s\S]*\}/);
if (jsonMatch) {
  const parsed = JSON.parse(jsonMatch[0]);
  return NextResponse.json({ ...parsed, isEpisode: false });
}
```

### ê²°ê³¼
- **ëŒ€í™”ì°½**: ì‘ê°€ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ë§ë§Œ í‘œì‹œ ("ì´ ì„¸ê³„ì˜ ì§„ì§œ ë¹„ë°€ì€ ë§ì´ì•¼...")
- **ì‚¬ì´ë“œ íŒ¨ë„**: JSON ë ˆì´ì–´ ë°ì´í„° í‘œì‹œ (ì„¸ê³„ê´€, ìºë¦­í„° ì •ë³´ ë“±)
- **í•˜ë‹¨ ë²„íŠ¼**: [í™•ì •] [ë‹¤ì‹œ ì œì•ˆí•´ì¤˜]

### ìˆ˜ì •ëœ íŒŒì¼
1. `app/api/author-chat/route.ts`
   - ëª¨ë“  ë ˆì´ì–´ í”„ë¡¬í”„íŠ¸ì— message ìì—°ì–´ ì˜ˆì‹œ ì¶”ê°€
   - JSON íŒŒì‹± ë¡œì§ì— ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±° ì¶”ê°€

### ì»¤ë°‹
- `e12e46d`: ë ˆì´ì–´ ì œì•ˆ ì‹œ message í•„ë“œ ìì—°ì–´ ê·œì¹™ ê°•í™”
- `8be2ea1`: ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ JSON íŒŒì‹± ê°œì„ 

---

## ì§‘í•„ ìŠ¤íƒ€ì¼ v2 ê°•í™” (2026-02-20 ì™„ë£Œ)

instruction-writing-style-v2.md ê¸°ë°˜ìœ¼ë¡œ write-episode í”„ë¡¬í”„íŠ¸ ëŒ€í­ ê°•í™”.

### ì¶”ê°€ëœ 6ê°€ì§€ ì‹œìŠ¤í…œ

#### 1. ì–´ê·¸ë¡œ í˜ë¥´ì†Œë‚˜
```
ì²« ë¬¸ì¥ = ì–´ê·¸ë¡œ (3ê°€ì§€ ì¤‘ í•˜ë‚˜)
- ê°ê° ì¶©ê²©: "í”¼ ëƒ„ìƒˆê°€ ë‚¬ë‹¤."
- ìƒí™© ì¶©ê²©: "ì£½ì—ˆë‹¤. ì•„ë‹ˆ, ì£½ì–´ì•¼ í–ˆë‹¤."
- ì˜ë¬¸ ìœ ë°œ: "ì™œ í•˜í•„ ë‚˜ì˜€ì„ê¹Œ."

ë…ë°±ì˜ ì¬ì¹˜
- ìì¡°ì  ìœ ë¨¸: "ìš´ì´ ì¢‹ë‹¤ê³ ? ì´ê²Œ ìš´ì´ë©´ ë‚œ ì‹ ì˜ ì¥ë‚œê°ì´ë‹¤."
- ë‚ ì¹´ë¡œìš´ ê´€ì°°: "ì € ëˆˆ. ê±°ì§“ë§ìŸì´ ëˆˆì´ë‹¤."
- ëƒ‰ì •í•œ ê³„ì‚°: "3ëª…. ë‚´ ì˜¤ë¥¸ìª½ì´ ë¹ ë¥´ë‹¤. ë¨¼ì €."

ì •ë³´ ì „ë‹¬ì˜ ì¬ì¹˜
ë‚˜ìœ ì˜ˆ: "ì´ ì„¸ê³„ëŠ” ë§ˆë‚˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ í˜ì˜ ì²´ê³„ê°€ ìˆì—ˆë‹¤."
ì¢‹ì€ ì˜ˆ: "ê·¸ê°€ ì†ì„ í´ì, í‘¸ë¥¸ ë¹›ì´ ì¼ë ì˜€ë‹¤. ë§ˆë‚˜. ì´ ì„¸ê³„ì˜ ì „ë¶€."
```

#### 2. ë…ë°± í†¤ 5ê°€ì§€ ëŒë ¤ì“°ê¸°
```typescript
type MonologueTone = 'ìì¡°' | 'ê´€ì°°' | 'ëƒ‰ì •' | 'ê°ê°' | 'ë©”íƒ€';
```
- ìì¡°: ìê¸°ë¹„í•˜ ìœ ë¨¸, ì“´ì›ƒìŒ
- ê´€ì°°: íƒ€ì¸/ìƒí™© ë¶„ì„, ë‚ ì¹´ë¡œìš´ ì‹œì„ 
- ëƒ‰ì •: ê°ì • ë°°ì œ, ê³„ì‚°ì  íŒë‹¨
- ê°ê°: ì˜¤ê° ì¤‘ì‹¬, ëª¸ì˜ ë°˜ì‘
- ë©”íƒ€: ìƒí™©ì˜ ì•„ì´ëŸ¬ë‹ˆ ì¸ì‹

**ê·œì¹™**: ê°™ì€ í†¤ 2í™” ì—°ì† ê¸ˆì§€. Episode íƒ€ì…ì— `monologueTone` í•„ë“œ ì¶”ê°€.

#### 3. ë¹Œë“œì—… êµ¬ì¡°
- **í•œ í™” ì™„ê²° ê¸ˆì§€**: ë§¤ í™” "ë¯¸ì™„ì˜ ê¸´ì¥"ìœ¼ë¡œ ëë‚¨
- **ê¸´ì¥ 3ê²¹ ìŒ“ê¸°**:
  - ì¦‰ê° ê¸´ì¥: ì§€ê¸ˆ ë‹¹ì¥ì˜ ìœ„í˜‘/ê¶ê¸ˆì¦
  - ì¤‘ê¸° ê¸´ì¥: ì´ ì•„í¬ì—ì„œ í•´ê²°ë  ë¬¸ì œ
  - ì¥ê¸° ê¸´ì¥: ì‹œë¦¬ì¦ˆ ì „ì²´ ë¯¸ìŠ¤í„°ë¦¬
- **ì •ë³´ í•œ êº¼í’€ì”©**: ìƒˆ ì •ë³´ = ìƒˆ ê¶ê¸ˆì¦

#### 4. êµ¬ê°„ë³„ ì†ë„ ì¡°ì ˆ (100í™” ê¸°ì¤€)
| êµ¬ê°„ | ì†ë„ | ì„¤ëª… |
|------|------|------|
| 1~10í™” | ë¹ ë¥´ê²Œ | í•œ ì¥ë©´ì— ë¨¸ë¬¼ì§€ ë§ˆë¼. ì„¤ëª… ìµœì†Œí™” |
| 11~50í™” | ê¹Šê²Œ | ê°ì •/ê´€ê³„/ê°ˆë“± íŒŒê³ ë“¤ê¸°. ë°€ë„ ë†’ì´ê¸° |
| 51í™”~ | í­í’ | ì‚¬ê±´ ëª°ì•„ì¹¨. ì‰´ í‹ˆ ì—†ì´ |

#### 5. ì—°ë… ì¥ì¹˜
**í´ë¦¬í”„í–‰ì–´ 7ìœ í˜• ëŒë ¤ì“°ê¸°**:
1. ìœ„ê¸° ì§ì „: "ê·¸ ìˆœê°„, ë¬¸ì´ ì—´ë ¸ë‹¤."
2. ë¹„ë°€ í­ë¡œ: "ê·¸ë…€ì˜ ì´ë¦„ì€ ì§„ì§œê°€ ì•„ë‹ˆì—ˆë‹¤."
3. ì„ íƒ ê°•ìš”: "ì£½ì´ê±°ë‚˜, ì£½ê±°ë‚˜."
4. ì˜ˆìƒ ë’¤ì§‘ê¸°: "í•˜ì§€ë§Œ ê·¸ëŠ” ì›ƒê³  ìˆì—ˆë‹¤."
5. ëŠ¥ë ¥ ê°ì„± íŒíŠ¸: "ì†ëì—ì„œ ë­”ê°€ê°€ ì¼ë ì˜€ë‹¤."
6. ê³¼ê±° ì—°ê²°: "10ë…„ ì „, ë°”ë¡œ ì´ ìë¦¬ì˜€ë‹¤."
7. ì¸ë¬¼ ë“±ì¥: "ê·¸ë¦¬ê³  ê·¸ê°€ ë‚˜íƒ€ë‚¬ë‹¤."

**3ì¤‘ í›… ì‹œìŠ¤í…œ**:
- ì˜¤í”„ë‹ í›… (ì²« 3ì¤„): ë…ìë¥¼ ì¡ëŠ”ë‹¤
- ë¯¸ë“œí¬ì¸íŠ¸ í›… (50% ì§€ì ): ìƒˆ ê¸´ì¥/ë°˜ì „
- í´ë¡œì§• í›… (ë§ˆì§€ë§‰ 2ì¤„): ë‹¤ìŒ í™” í´ë¦­

**ê¸°íƒ€**:
- ë–¡ë°¥ ìˆœí™˜: 3~5í™”ë§ˆë‹¤ ê¸°ì¡´ ë–¡ë°¥ ì–¸ê¸‰/ì§„ì „
- 5í™” ë¯¸ë‹ˆ ì•„í¬: ë§¤ 5í™”ë¥¼ ì‘ì€ ì„œì‚¬ë¡œ

#### 6. ì¥ë©´ ì „í™˜ ê·œì¹™
- **ê°ì • ë¸Œë¦¿ì§€**: ë¶„ë…¸ë¡œ ë â†’ ê·¸ ë¶„ë…¸ ì—¬íŒŒë¡œ ì‹œì‘
- **ì‹œì  3ì¤„ ê·œì¹™**: ì²« 3ì¤„ì— (ëˆ„ê°€/ì–´ë””ì„œ/ì–¸ì œ)
- **ì‹œê°„ ì•µì»¤**: "3ì¼ í›„", "ê·¸ë‚  ë°¤" ë“±
- **ë¹ˆë„ ì œí•œ**: í•œ í™” ìµœëŒ€ 4íšŒ ì „í™˜

### ìˆ˜ì •ëœ íŒŒì¼
1. `app/api/write-episode/route.ts`
   - ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì— 6ê°€ì§€ ì‹œìŠ¤í…œ ì¶”ê°€
   - í™”ìˆ˜ ê¸°ë°˜ ë™ì  ê°€ì´ë“œ (ì†ë„/í†¤/í´ë¦¬í”„í–‰ì–´)
   - monologueTone íŒŒì‹± ë° ë°˜í™˜
   - ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±° ë¡œì§ ì¶”ê°€

2. `lib/types/index.ts`
   - `MonologueTone` íƒ€ì… ì¶”ê°€
   - `Episode.monologueTone` í•„ë“œ ì¶”ê°€

### ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒŒì‹± ìˆ˜ì •
Claudeê°€ ì‘ë‹µì„ ` ```json ... ``` `ë¡œ ê°ì‹¸ëŠ” ê²½ìš° ì²˜ë¦¬:
```typescript
// ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±°
let cleanText = text;
const codeBlockMatch = text.match(/```(?:json)?\s*([\s\S]*?)```/);
if (codeBlockMatch) {
  cleanText = codeBlockMatch[1].trim();
}
```
ì´ ë¡œì§ì€ `author-chat`ê³¼ `write-episode` ë‘ APIì— ëª¨ë‘ ì ìš©ë¨.

### ì»¤ë°‹
- `6c66cb1`: write-episode í”„ë¡¬í”„íŠ¸ v2 ê°•í™”
- `3f0fda9`: write-episode ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒŒì‹± ìˆ˜ì •

---

## 100í™” ì¼ê´€ì„± ìœ ì§€ ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ (2026-02-20 ì™„ë£Œ)

100í™” ì´ìƒì˜ ì¥í¸ ì›¹ì†Œì„¤ì—ì„œ ì„¤ì • ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ 3-tier ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ.

### í•µì‹¬ êµ¬ì¡°

#### 3-Tier ë©”ëª¨ë¦¬ ì•„í‚¤í…ì²˜
```
Tier 1: World Bible (~2,000 í† í°)
  â””â”€ ë§¤ í”„ë¡¬í”„íŠ¸ì— í•­ìƒ í¬í•¨
  â””â”€ ì„¸ê³„ê´€ ìš”ì•½, ê·œì¹™, ìºë¦­í„° í•µì‹¬, ì„¸ë ¥, ë–¡ë°¥ ìƒíƒœ

Tier 2: Episode Log (~300 í† í°/í™”)
  â””â”€ ë§¤ í™” ì¢…ë£Œ ì‹œ ìë™ ìƒì„± (Haiku)
  â””â”€ ì¥ë©´, ìºë¦­í„° ë³€í™”, ê´€ê³„ ë³€í™”, ë–¡ë°¥ í™œë™

Tier 3: Active Context (ë™ì  ì¡°í•©)
  â””â”€ ì§‘í•„ ì‹œì ì— ìë™ ì¡°ë¦½
  â””â”€ World Bible + ìµœê·¼ 3í™” Log + ë§ˆì§€ë§‰ 500ì + ë–¡ë°¥ ê²½ê³ 
```

### ìƒˆ íƒ€ì… (`lib/types/index.ts`)

```typescript
// World Bible - ì••ì¶•ëœ ì„¸ê³„ê´€ (~2,000 í† í°)
interface WorldBible {
  worldSummary: string;           // í•œ ì¤„ ì„¸ê³„ê´€
  rules: {
    powerSystem: string;          // í˜ì˜ ì²´ê³„
    magicTypes?: string;          // ë§ˆë²• ìœ í˜•
    socialStructure: string;      // ì‚¬íšŒ êµ¬ì¡°
    keyHistory: string;           // í•µì‹¬ ì—­ì‚¬
    contradiction?: string;       // ì„¸ê³„ ëª¨ìˆœ
  };
  characters: {
    [name: string]: {
      core: string;               // í•µì‹¬ ì •ì²´ì„±
      desire: string;             // ìš•ë§
      deficiency?: string;        // ê²°í•
      weakness: string;           // ì•½ì 
      currentState: string;       // í˜„ì¬ ìƒíƒœ
    };
  };
  factions: string;               // ì„¸ë ¥ ê´€ê³„
  breadcrumbs: {
    [name: string]: {
      truth: string;              // ë–¡ë°¥ì˜ ì§„ì‹¤
      status: 'hidden' | 'hinted' | 'suspected' | 'revealed';
      lastMentionedEp: number;
      plannedRevealEp?: number;
    };
  };
  prophecy?: string;              // ì˜ˆì–¸
  legends?: string[];             // ì „ì„¤
  generatedAt: string;
  lastUpdatedAt: string;
  tokenCount?: number;
}

// Episode Log - í™”ë³„ ìš”ì•½ (~300 í† í°)
interface EpisodeLog {
  episodeNumber: number;
  summary: string;                // í•µì‹¬ ìš”ì•½
  scenes: {
    location: string;
    characters: string[];
    event: string;
  }[];
  characterChanges: { [name: string]: string };
  relationshipChanges: {
    who: string;
    withWhom: string;
    change: string;
  }[];
  breadcrumbActivity: {
    advanced: string[];           // ì§„ì „ëœ ë–¡ë°¥
    newlyPlanted: string[];       // ìƒˆë¡œ ì‹¬ì€ ë–¡ë°¥
    hintGiven: string[];          // íŒíŠ¸ ì¤€ ë–¡ë°¥
  };
  cliffhangerType: CliffhangerType;
  cliffhangerContent: string;
  unresolvedTensions: string[];
  dominantMonologueTone: MonologueTone;
  miniArcPosition: number;        // 5í™” ë¯¸ë‹ˆì•„í¬ ë‚´ ìœ„ì¹˜
  buildupPhase: 'early' | 'middle' | 'late';
  generatedAt: string;
}

// Active Context - ì§‘í•„ ì‹œ ì¡°ë¦½
interface ActiveContext {
  worldBible: WorldBible;
  recentLogs: EpisodeLog[];       // ìµœê·¼ 3í™”
  previousEnding: string;         // ë§ˆì§€ë§‰ 500ì
  activeBreadcrumbs: {
    name: string;
    status: 'hidden' | 'hinted' | 'suspected';
    lastMentioned: number;
    nextAction?: string;
  }[];
  unresolvedTensions: string[];
  characterStates: { [name: string]: string };
  episodeMeta: { ... };
  feedbackGuide: string[];
}

// Fact Check Result - ëª¨ìˆœ ê²€ì¶œ
interface FactCheckResult {
  episodeNumber: number;
  hasContradictions: boolean;
  contradictions: FactCheckContradiction[];
  overallSeverity: 'none' | 'minor' | 'major' | 'critical';
  shouldRewrite: boolean;
  checkedAt: string;
}

// Breadcrumb Warning - ë–¡ë°¥ ê²½ê³ 
interface BreadcrumbWarning {
  breadcrumbName: string;
  warningType: 'forgotten' | 'too_long_hidden' | 'delayed' | 'overdue';
  lastMentionedEp: number;
  currentEp: number;
  plannedRevealEp?: number;
  message: string;
  suggestedAction: string;
}
```

### ìƒˆ API

#### `/api/generate-world-bible` (POST)
- ë ˆì´ì–´ 1~6ì„ World Bibleë¡œ ì••ì¶•
- Haiku ì‚¬ìš©, ~2,000 í† í° ëª©í‘œ
- í”„ë¡œì íŠ¸ ì‹œì‘ ì‹œ 1íšŒ ìƒì„±

#### `/api/generate-episode-log` (POST)
- ì—í”¼ì†Œë“œ ì™„ë£Œ í›„ ìë™ ìƒì„±
- Haiku ì‚¬ìš©, ~300 í† í°
- ì¥ë©´, ë³€í™”, ë–¡ë°¥ í™œë™ ì¶”ì¶œ

#### `/api/fact-check` (POST)
- World Bible vs ìƒˆ ì—í”¼ì†Œë“œ ë¹„êµ
- 5ê°€ì§€ ê²€ì¶œ ëŒ€ìƒ:
  1. ìºë¦­í„° ì„¤ì • ì˜¤ë¥˜
  2. ì„¸ê³„ê´€ ì„¤ì • ì˜¤ë¥˜
  3. ë–¡ë°¥ ëˆ„ì„¤ ì˜¤ë¥˜
  4. ì‚¬ë§ì ë¶€í™œ
  5. ì‹œê°„ì¶• ì˜¤ë¥˜
- ì‹¬ê°ë„: minor / major / critical

### ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

#### `lib/utils/active-context.ts`
```typescript
// Active Context ì¡°ë¦½
buildActiveContext(params): ActiveContext

// í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ë¡œ ë³€í™˜
activeContextToPrompt(context): string

// ìµœê·¼ Ní™” ë¡œê·¸ ê°€ì ¸ì˜¤ê¸°
getRecentLogs(logs, currentEp, count): EpisodeLog[]

// ì´ì „ í™” ë§ˆì§€ë§‰ 500ì
getPreviousEnding(episodes, currentEp): string

// í™œì„± ë–¡ë°¥ (revealed ì œì™¸)
getActiveBreadcrumbs(worldBible, currentEp): ActiveBreadcrumb[]
```

#### `lib/utils/breadcrumb-tracker.ts`
```typescript
// ë–¡ë°¥ ê²½ê³  ìƒì„±
trackBreadcrumbs(breadcrumbs, currentEp): BreadcrumbWarning[]

// ê²½ê³  ê¸°ì¤€:
// - forgotten: 10í™” ì´ìƒ ë°©ì¹˜
// - too_long_hidden: 40í™” ë„˜ë„ë¡ hidden
// - delayed: ì˜ˆì • ì‹œì  5í™” ì´ìƒ ì´ˆê³¼
// - overdue: ì˜ˆì • ì‹œì  ì´ˆê³¼ (delayed ë¯¸ë§Œ)

// ê²½ê³  â†’ ì§€ì‹œë¬¸ ë³€í™˜
generateBreadcrumbInstructions(warnings): string[]

// ë–¡ë°¥ ìƒíƒœ ìš”ì•½
summarizeBreadcrumbStatus(breadcrumbs): Summary

// Episode Logë¡œ World Bible ì—…ë°ì´íŠ¸
updateBreadcrumbsFromLog(worldBible, activity, currentEp): WorldBible

// ëŒ€ì‹œë³´ë“œ ë°ì´í„°
getBreadcrumbDashboardData(worldBible, currentEp): DashboardData
```

### ìŠ¤í† ì–´ í™•ì¥ (`lib/store/project-store.ts`)

```typescript
// ìƒˆ ì•¡ì…˜
setWorldBible: (worldBible: WorldBible) => void;
updateWorldBible: (updates: Partial<WorldBible>) => void;
addEpisodeLog: (log: EpisodeLog) => void;
updateEpisodeLog: (episodeNumber: number, updates: Partial<EpisodeLog>) => void;
```

### Supabase ìŠ¤í‚¤ë§ˆ ë³€ê²½

```sql
ALTER TABLE projects ADD COLUMN world_bible jsonb;
ALTER TABLE projects ADD COLUMN episode_logs jsonb DEFAULT '[]';
```

### ì§‘í•„ API í†µí•© (`app/api/write-episode/route.ts`)

- `activeContext` íŒŒë¼ë¯¸í„° ì¶”ê°€
- `activeContextToPrompt()` í˜¸ì¶œí•˜ì—¬ í”„ë¡¬í”„íŠ¸ì— í¬í•¨
- World Bible + ìµœê·¼ 3í™” + ë–¡ë°¥ ê²½ê³ ê°€ ìë™ ì£¼ì…

### í”„ë¡œì íŠ¸ í˜ì´ì§€ í†µí•© (`app/projects/[id]/page.tsx`)

- ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ ì‹œ World Bible ìë™ ìƒì„±
- `generateWorldBibleAndHistory()` í•¨ìˆ˜ë¡œ í†µí•©

### ë°ì´í„° íë¦„

```
1. í”„ë¡œì íŠ¸ ì‹œì‘ â†’ World Bible ìƒì„± (1íšŒ)
   â””â”€ layers 1-6 â†’ Haiku ì••ì¶• â†’ ~2,000 í† í°

2. ë§¤ í™” ì§‘í•„
   â””â”€ buildActiveContext() í˜¸ì¶œ
   â””â”€ World Bible + ìµœê·¼ 3í™” Log + ë–¡ë°¥ ê²½ê³  ì¡°ë¦½
   â””â”€ activeContextToPrompt() â†’ í”„ë¡¬í”„íŠ¸ì— ì£¼ì…

3. ë§¤ í™” ì™„ë£Œ
   â””â”€ /api/generate-episode-log í˜¸ì¶œ
   â””â”€ Episode Log ì €ì¥ (Supabase + localStorage)
   â””â”€ ë–¡ë°¥ ìƒíƒœ ì—…ë°ì´íŠ¸

4. Fact Check (ì„ íƒ)
   â””â”€ /api/fact-check í˜¸ì¶œ
   â””â”€ ëª¨ìˆœ ë°œê²¬ ì‹œ ê²½ê³  í‘œì‹œ
```

### ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `lib/types/index.ts` | WorldBible, EpisodeLog, ActiveContext, FactCheck íƒ€ì… ì¶”ê°€ |
| `lib/supabase/types.ts` | world_bible, episode_logs í•„ë“œ ì¶”ê°€ |
| `lib/supabase/db.ts` | ìƒˆ í•„ë“œ ì €ì¥/ë¡œë“œ ë¡œì§ |
| `lib/store/project-store.ts` | setWorldBible, addEpisodeLog ë“± ì•¡ì…˜ |
| `lib/utils/active-context.ts` | ì‹ ê·œ - Active Context ì¡°ë¦½ |
| `lib/utils/breadcrumb-tracker.ts` | ì‹ ê·œ - ë–¡ë°¥ ì¶”ì /ê²½ê³  |
| `app/api/generate-world-bible/route.ts` | ì‹ ê·œ - World Bible ìƒì„± |
| `app/api/generate-episode-log/route.ts` | ì‹ ê·œ - Episode Log ìƒì„± |
| `app/api/fact-check/route.ts` | ì‹ ê·œ - ëª¨ìˆœ ê²€ì¶œ |
| `app/api/write-episode/route.ts` | Active Context ì£¼ì… |
| `app/projects/[id]/page.tsx` | World Bible ìë™ ìƒì„± |

### ë¹Œë“œ ì„±ê³µ í™•ì¸ (2026-02-20)

---

## ì¼ê´€ì„± ì—”ì§„ Phase 2 (2026-02-20 ì™„ë£Œ)

Phase 1ì˜ ê¸°ë°˜ ìœ„ì— UI í†µí•© ë° ìë™í™” ê¸°ëŠ¥ ì¶”ê°€.

### êµ¬í˜„ ë‚´ìš©

#### 1. Episode Log ìë™ ìƒì„± í†µí•©
- ì—í”¼ì†Œë“œ ì‘ì„± ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ `/api/generate-episode-log` í˜¸ì¶œ
- `handlePostEpisodeCreation()` í•¨ìˆ˜ë¡œ í†µí•© ê´€ë¦¬
- ë¡œê·¸ ìƒì„± í›„ `addEpisodeLog()` í˜¸ì¶œí•˜ì—¬ ìŠ¤í† ì–´ì— ì €ì¥

#### 2. íŒ©íŠ¸ ì²´ì»¤ UI í†µí•©
- ì—í”¼ì†Œë“œ ì‘ì„± ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ `/api/fact-check` í˜¸ì¶œ
- `critical` ë˜ëŠ” `major` ëª¨ìˆœ ë°œê²¬ ì‹œ ëª¨ë‹¬ í‘œì‹œ
- ëª¨ìˆœ ìƒì„¸ ì •ë³´ (í•„ë“œ, ì„¸ê³„ê´€ ê°’, ì—í”¼ì†Œë“œ ê°’, ìˆ˜ì • ì œì•ˆ)
- [ìˆ˜ì • ìš”ì²­] / [ë¬´ì‹œí•˜ê³  ì§„í–‰] ë²„íŠ¼

#### 3. ë–¡ë°¥ ê²½ê³  UI í†µí•©
- `trackBreadcrumbs()` í˜¸ì¶œí•˜ì—¬ ê²½ê³  ìƒì„±
- í™”ë©´ ìš°í•˜ë‹¨ì— ë–¡ë°¥ ê²½ê³  í† ìŠ¤íŠ¸ í‘œì‹œ
- ê²½ê³  ìœ í˜•: ìŠíŒ ë–¡ë°¥(10í™”+), ë„ˆë¬´ ì˜¤ë˜ ìˆ¨ê¹€(40í™”+), ì§€ì—°ë¨(ì˜ˆì •+5í™”)

#### 4. ë©”íƒ€ ì§€ì‹œ ìë™ ê³„ì‚°
- `calculateEpisodeMeta()` í•¨ìˆ˜ (active-context.tsì— êµ¬í˜„ë¨)
- ê³„ì‚° í•­ëª©:
  - `miniArcPosition`: 5í™” ë¯¸ë‹ˆì•„í¬ ë‚´ ìœ„ì¹˜ (1~5)
  - `buildupPhase`: ë¹Œë“œì—… í˜ì´ì¦ˆ (early/middle/late)
  - `forbiddenCliffhanger/Tone`: ì§ì „ í™”ì—ì„œ ì‚¬ìš©í•œ ìœ í˜• (ë°˜ë³µ ê¸ˆì§€)
  - `suggestedCliffhanger/Tone`: ì¶”ì²œ ìœ í˜•
  - `breadcrumbInstructions`: ë–¡ë°¥ ê´€ë ¨ ì§€ì‹œ

#### 5. Active Context í”„ë¡¬í”„íŠ¸ ì£¼ì…
- write-episode í˜¸ì¶œ ì‹œ `buildActiveContext()` í˜¸ì¶œ
- World Bible + ìµœê·¼ 3í™” ë¡œê·¸ + ë©”íƒ€ ì§€ì‹œê°€ í”„ë¡¬í”„íŠ¸ì— í¬í•¨
- `activeContextToPrompt()` ë¡œ ë¬¸ìì—´ ë³€í™˜

### ìˆ˜ì •ëœ íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `app/projects/[id]/page.tsx` | `handlePostEpisodeCreation()` ì¶”ê°€, íŒ©íŠ¸ì²´í¬ ëª¨ë‹¬, ë–¡ë°¥ ê²½ê³  í† ìŠ¤íŠ¸, Active Context ì „ë‹¬ |
| `lib/utils/active-context.ts` | `calculateEpisodeMeta()` êµ¬í˜„ (Phase 1ì—ì„œ ì™„ë£Œ) |
| `lib/utils/breadcrumb-tracker.ts` | ë–¡ë°¥ ì¶”ì /ê²½ê³  ìœ í‹¸ë¦¬í‹° (Phase 1ì—ì„œ ì™„ë£Œ) |

### ìë™í™” íë¦„

```
ì—í”¼ì†Œë“œ Ní™” ì§‘í•„ ìš”ì²­
  â†“
Active Context ì¡°ë¦½ (buildActiveContext)
  - World Bible ë¡œë“œ
  - ì§ì „ 3í™” ë¡œê·¸
  - ë©”íƒ€ ì§€ì‹œ ê³„ì‚° (í´ë¦¬í”„í–‰ì–´/í†¤ ì¶”ì²œ, ê¸ˆì§€ ìœ í˜•)
  - ë–¡ë°¥ ê²½ê³  ì§€ì‹œ
  â†“
write-episode API í˜¸ì¶œ (activeContext í¬í•¨)
  â†“
ì§‘í•„ ì™„ë£Œ
  â†“
handlePostEpisodeCreation() í˜¸ì¶œ:
  1. Episode Log ìë™ ìƒì„± â†’ addEpisodeLog()
  2. Fact Check ì‹¤í–‰ â†’ ëª¨ìˆœ ìˆìœ¼ë©´ ëª¨ë‹¬ í‘œì‹œ
  3. ë–¡ë°¥ ê²½ê³  ì—…ë°ì´íŠ¸ â†’ í† ìŠ¤íŠ¸ í‘œì‹œ
  â†“
ë‹¤ìŒ í™” ì¤€ë¹„ ì™„ë£Œ
```

### ìƒíƒœ ë³€ìˆ˜ ì¶”ê°€

```typescript
// app/projects/[id]/page.tsx
const [factCheckResult, setFactCheckResult] = useState<FactCheckResult | null>(null);
const [breadcrumbWarnings, setBreadcrumbWarnings] = useState<BreadcrumbWarning[]>([]);
const [showFactCheckModal, setShowFactCheckModal] = useState(false);
```

### ë¹Œë“œ ì„±ê³µ í™•ì¸ (2026-02-20)

---

## ì¼ê´€ì„± ì—”ì§„ Phase 3 (2026-02-20 ì™„ë£Œ)

ê³ ê¸‰ ì¶”ì  ë° ë¶„ì„ ì‹œìŠ¤í…œ êµ¬í˜„.

### 1. ìºë¦­í„° ì¼ê´€ì„± ì¶”ì  (`lib/utils/character-consistency.ts`)

**í•µì‹¬ ê¸°ëŠ¥:**
- ìºë¦­í„°ì˜ core ì„±ê²©ê³¼ ì—í”¼ì†Œë“œ í–‰ë™ ë¹„êµ
- ê¸‰ê²©í•œ ì„±ê²© ë³€í™” ê°ì§€ (ì—°ì† í™”ì—ì„œ ìƒë°˜ëœ ë³€í™”)
- í•µì‹¬ ì„±ê²©ê³¼ì˜ ëª¨ìˆœ ê°ì§€

**íƒ€ì…:**
```typescript
interface CharacterConsistencyWarning {
  characterName: string;
  warningType: 'sudden_change' | 'contradicts_core' | 'out_of_character';
  severity: 'minor' | 'major' | 'critical';
  episodeNumber: number;
  description: string;
  coreValue: string;
  episodeValue: string;
  suggestion: string;
}

interface CharacterTrajectory {
  characterName: string;
  core: string;
  desire: string;
  weakness: string;
  stateHistory: { episodeNumber: number; state: string; change?: string }[];
  currentState: string;
  consistencyScore: number;  // 0-100
  warnings: CharacterConsistencyWarning[];
}
```

**í•¨ìˆ˜:**
- `trackCharacterConsistency()`: ê²½ê³  ìƒì„±
- `buildCharacterTrajectory()`: ìºë¦­í„°ë³„ ê¶¤ì  ìƒì„±
- `getCharacterConsistencyDashboard()`: ëŒ€ì‹œë³´ë“œ ë°ì´í„°

### 2. ê´€ê³„ ë³€í™” ê·¸ë˜í”„ (`lib/utils/relationship-tracker.ts`)

**í•µì‹¬ ê¸°ëŠ¥:**
- EpisodeLogì˜ relationshipChanges ê¸°ë°˜ ê´€ê³„ë§ êµ¬ì¶•
- ê´€ê³„ ìˆ˜ì¹˜í™” (-100 ~ +100)
- íŠ¸ë Œë“œ ë¶„ì„ (improving/declining/stable/volatile)

**íƒ€ì…:**
```typescript
interface RelationshipEdge {
  source: string;
  target: string;
  currentValue: number;  // -100 ~ +100
  history: { episodeNumber: number; change: string; delta: number }[];
  label?: string;  // ì¹œë°€/ì¤‘ë¦½/ê°ˆë“±/ì ëŒ€ ë“±
}

interface RelationshipTrend {
  pair: string;
  trend: 'improving' | 'declining' | 'stable' | 'volatile';
  recentChanges: number[];
  prediction: string;
}
```

**í•¨ìˆ˜:**
- `buildRelationshipGraph()`: ê´€ê³„ ê·¸ë˜í”„ ë¹Œë“œ
- `analyzeRelationshipTrends()`: íŠ¸ë Œë“œ ë¶„ì„
- `getRelationshipSummary()`: ìš”ì•½ ë°ì´í„°
- `getCharacterRelationships()`: íŠ¹ì • ìºë¦­í„°ì˜ ê´€ê³„ë§

### 3. ê°ì • ë¡œë“œë§µ ë¹„êµ (`lib/utils/emotion-roadmap.ts`)

**í•µì‹¬ ê¸°ëŠ¥:**
- 100í™” ê¸°ì¤€ ê°ì • ë¡œë“œë§µ í…œí”Œë¦¿ ìƒì„±
- ì—í”¼ì†Œë“œ ë¡œê·¸ì—ì„œ ì‹¤ì œ ê°ì • ì¶”ë¡ 
- ê³„íš vs ì‹¤ì œ ë¹„êµ ë° ì´íƒˆ ê°ì§€

**íƒ€ì…:**
```typescript
type EmotionType = 'excitement' | 'tension' | 'relief' | 'sadness' | 'anger' | 'joy' | 'fear' | 'curiosity' | 'satisfaction' | 'frustration';

interface EmotionComparison {
  episodeNumber: number;
  planned: { emotion: EmotionType; intensity: number } | null;
  actual: { emotion: EmotionType; intensity: number } | null;
  deviation: number;
  status: 'on_track' | 'minor_deviation' | 'major_deviation' | 'off_track';
  suggestion?: string;
}
```

**í•¨ìˆ˜:**
- `generateDefaultEmotionRoadmap()`: 100í™” ê¸°ë³¸ ë¡œë“œë§µ ìƒì„±
- `extractActualEmotionProgress()`: ì‹¤ì œ ê°ì • ì§„í–‰ ì¶”ì¶œ
- `compareEmotionProgress()`: ê³„íš vs ì‹¤ì œ ë¹„êµ
- `getEmotionRoadmapDashboard()`: ëŒ€ì‹œë³´ë“œ ë°ì´í„°
- `getEmotionCurveData()`: ì‹œê°í™”ìš© ë°ì´í„°

### íƒ€ì… ì¶”ê°€ (`lib/types/index.ts`)

```typescript
export type CliffhangerType = 'crisis' | 'revelation' | 'choice' | 'reversal' | 'awakening' | 'past_connection' | 'character_entrance';
```

### ìˆ˜ì •ëœ íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `lib/utils/character-consistency.ts` | ì‹ ê·œ - ìºë¦­í„° ì¼ê´€ì„± ì¶”ì  |
| `lib/utils/relationship-tracker.ts` | ì‹ ê·œ - ê´€ê³„ ë³€í™” ê·¸ë˜í”„ |
| `lib/utils/emotion-roadmap.ts` | ì‹ ê·œ - ê°ì • ë¡œë“œë§µ ë¹„êµ |
| `lib/types/index.ts` | CliffhangerType íƒ€ì… ì¶”ê°€ |

### ì¼ê´€ì„± ì—”ì§„ ì „ì²´ ì™„ë£Œ (Phase 1-3)

---

## ìê°€ì§„í™” í”¼ë“œë°± ë£¨í”„ ì‹œìŠ¤í…œ (2026-02-20 ì™„ë£Œ)

í™˜ë‹˜ì˜ í”¼ë“œë°±ê³¼ ì§ì ‘ í¸ì§‘ì„ ë¶„ì„í•˜ì—¬ ë¬¸ì²´ ê·œì¹™ì„ í•™ìŠµí•˜ê³ , ë‹¤ìŒ í™” ì§‘í•„ ì‹œ ìë™ìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜í•˜ëŠ” ì‹œìŠ¤í…œ.

### í•µì‹¬ êµ¬ì¡°

#### 5ê°€ì§€ í•µì‹¬ ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  |
|---------|------|
| í”¼ë“œë°± ë¶„ì„ ì—”ì§„ | í”¼ë“œë°± ìë™ ë¶„ë¥˜ (style/character/pacing/tone/structure/dialogue/description) |
| ì§ì ‘ í¸ì§‘ ë¹„êµ ë¶„ì„ | AI ì›ë³¸ vs í™˜ë‹˜ ìˆ˜ì •ë³¸ diff â†’ íŒ¨í„´ ì¶”ì¶œ |
| Writing Memory | ìŠ¤íƒ€ì¼ ê·œì¹™, í¸ì§‘ íŒ¨í„´, í’ˆì§ˆ ì¶”ì , ê³µí†µ ì‹¤ìˆ˜ ì €ì¥ |
| í”„ë¡¬í”„íŠ¸ ìë™ ì£¼ì… | í•™ìŠµëœ ê·œì¹™ì„ ì§‘í•„ í”„ë¡¬í”„íŠ¸ì— í¬í•¨ (500 í† í° ì œí•œ) |
| í’ˆì§ˆ ì¶”ì  | ì—í”¼ì†Œë“œë³„ ì±„íƒë¥ , ìˆ˜ì •ëŸ‰ í‘œì‹œ |

### íƒ€ì… ì •ì˜ (`lib/types/index.ts`)

```typescript
export type FeedbackCategory = 'style' | 'character' | 'pacing' | 'tone' | 'structure' | 'dialogue' | 'description';

export interface StyleRule {
  id: string;
  category: FeedbackCategory;
  rule: string;
  source: 'feedback' | 'edit_analysis';
  confidence: number;  // 0-100 (ë°˜ë³µë ìˆ˜ë¡ ì¦ê°€)
  examples?: string[];
  counterExamples?: string[];
  createdAt: string;
  lastAppliedAt?: string;
}

export interface EditPattern {
  id: string;
  patternType: 'shorten' | 'expand' | 'replace' | 'delete' | 'restructure';
  description: string;
  originalPattern: string;
  correctedPattern: string;
  frequency: number;
  examples: { original: string; edited: string; episodeNumber: number }[];
  createdAt: string;
}

export interface EpisodeQuality {
  episodeNumber: number;
  originalCharCount: number;
  finalCharCount: number;
  editAmount: number;  // 0-100 (ë ˆë²¤ìŠˆíƒ€ì¸ ê±°ë¦¬ ê¸°ë°˜)
  adoptedDirectly: boolean;  // ìˆ˜ì • ì—†ì´ ì±„íƒ
  feedbackCount: number;
  revisionCount: number;
  status: 'draft' | 'revised' | 'final';
  createdAt: string;
}

export interface CommonMistake {
  id: string;
  category: FeedbackCategory;
  description: string;
  frequency: number;
  lastOccurred: number;  // ì—í”¼ì†Œë“œ ë²ˆí˜¸
  severity: 'minor' | 'major' | 'critical';
  avoidanceRule: string;
  createdAt: string;
}

export interface WritingMemory {
  styleRules: StyleRule[];
  editPatterns: EditPattern[];
  qualityTracker: EpisodeQuality[];
  commonMistakes: CommonMistake[];
  lastUpdatedAt: string;
  totalEpisodes: number;
  averageEditAmount: number;  // 0-100
  directAdoptionRate: number;  // 0-100
}
```

### ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (`lib/utils/writing-memory.ts`)

```typescript
// ë¹ˆ Writing Memory ìƒì„±
createEmptyWritingMemory(): WritingMemory

// í”¼ë“œë°± ì²˜ë¦¬ â†’ ìŠ¤íƒ€ì¼ ê·œì¹™ ì¶”ì¶œ
processFeedback(memory, feedback): WritingMemory

// í”¼ë“œë°± ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ (í‚¤ì›Œë“œ ê¸°ë°˜)
classifyFeedbackCategory(content): FeedbackCategory

// ì§ì ‘ í¸ì§‘ ë¶„ì„ â†’ íŒ¨í„´ ì¶”ì¶œ
analyzeEdit(original, edited, episodeNumber): { patterns: EditPattern[], similarity: number }

// í¸ì§‘ íŒ¨í„´ì„ Writing Memoryì— í†µí•©
integrateEditPatterns(memory, patterns): WritingMemory

// í’ˆì§ˆ ì¶”ì  ì—…ë°ì´íŠ¸
updateQualityTracker(memory, quality): WritingMemory

// ì§‘í•„ í”„ë¡¬í”„íŠ¸ ìƒì„± (500í† í° ì œí•œ)
buildWritingMemoryPrompt(memory): string

// í†µê³„ ìš”ì•½
getWritingMemoryStats(memory): Stats
```

### í”¼ë“œë°± ë¶„ë¥˜ ê·œì¹™

| ì¹´í…Œê³ ë¦¬ | í‚¤ì›Œë“œ ì˜ˆì‹œ |
|---------|------------|
| style | ë¬¸ì²´, í‘œí˜„, ë¬˜ì‚¬, ì„œìˆ , ë¬¸ì¥ |
| tone | í†¤, ë¶„ìœ„ê¸°, ë¬´ë“œ, ë°ë‹¤, ì–´ë‘¡ë‹¤ |
| pacing | ì†ë„, ë¹ ë¥´ë‹¤, ëŠë¦¬ë‹¤, í˜ì´ìŠ¤, í…œí¬ |
| character | ìºë¦­í„°, ì¸ë¬¼, ì„±ê²©, í–‰ë™, ë§íˆ¬ |
| dialogue | ëŒ€ì‚¬, ëŒ€í™”, ë§, ë°˜ë§, ì¡´ëŒ“ë§ |
| structure | êµ¬ì¡°, ì „ê°œ, íë¦„, ìˆœì„œ, ë°°ì¹˜ |
| description | ì„¤ëª…, ì§€ë¬¸, ë°°ê²½, ì¥ë©´ |

### ì‹ ë¢°ë„ ì‹œìŠ¤í…œ

- **ì´ˆê¸° ì‹ ë¢°ë„**: 25%
- **2íšŒ ë°˜ë³µ**: 50%
- **3íšŒ ë°˜ë³µ**: 75%
- **4íšŒ ì´ìƒ**: 100%
- **í”„ë¡¬í”„íŠ¸ í¬í•¨ ê¸°ì¤€**: ì‹ ë¢°ë„ 50% ì´ìƒ

### í”„ë¡¬í”„íŠ¸ ì£¼ì… í˜•ì‹

```
=== í•™ìŠµëœ ë¬¸ì²´ ê·œì¹™ ===

[í•„ìˆ˜ ê·œì¹™ - ë°˜ë“œì‹œ ì§€í‚¬ ê²ƒ]
- (style) ëŒ€ì‚¬ë¥¼ ë” ì§§ê²Œ ì“¸ ê²ƒ [ì‹ ë¢°ë„: 75%]
- (tone) ì–´ë‘ìš´ ë¶„ìœ„ê¸° ìœ ì§€ [ì‹ ë¢°ë„: 100%]

[ê¶Œì¥ ê·œì¹™]
- (pacing) ì¥ë©´ ì „í™˜ì„ ë” ë¹ ë¥´ê²Œ [ì‹ ë¢°ë„: 50%]

[í”¼í•´ì•¼ í•  ì‹¤ìˆ˜]
- (dialogue) í•‘í ëŒ€í™” íŒ¨í„´: "A í•œì¤„ B í•œì¤„ ë°˜ë³µ"ì€ í”¼í•˜ì„¸ìš”

[í¸ì§‘ íŒ¨í„´ í•™ìŠµ]
- ê¸´ ì„¤ëª… â†’ ì§§ì€ ê°ê° ë¬˜ì‚¬ë¡œ êµì²´í•˜ëŠ” ê²½í–¥ (ë¹ˆë„: 5íšŒ)

[í’ˆì§ˆ í†µê³„]
- ì§ì ‘ ì±„íƒë¥ : 60%
- í‰ê·  ìˆ˜ì •ëŸ‰: 15%
- ìµœê·¼ ì¶”ì„¸: ê°œì„  ì¤‘

=== í•™ìŠµëœ ë¬¸ì²´ ê·œì¹™ ë ===
```

### ìŠ¤í† ì–´ í™•ì¥ (`lib/store/project-store.ts`)

```typescript
// ìƒˆ ì•¡ì…˜
setWritingMemory: (memory: WritingMemory) => void;
updateWritingMemory: (updates: Partial<WritingMemory>) => void;
getWritingMemory: () => WritingMemory | undefined;
```

### ì§‘í•„ API í†µí•© (`app/api/write-episode/route.ts`)

- `writingMemory` íŒŒë¼ë¯¸í„° ì¶”ê°€
- `buildWritingMemoryPrompt()` í˜¸ì¶œ
- ê²°ê³¼ë¥¼ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì— ì£¼ì…

### í”„ë¡œì íŠ¸ í˜ì´ì§€ í†µí•© (`app/projects/[id]/page.tsx`)

- **ì—í”¼ì†Œë“œ ì±„íƒ ì‹œ (`handleAdopt`)**:
  - í’ˆì§ˆ ì¶”ì  ë°ì´í„° ì €ì¥
  - ì§ì ‘ í¸ì§‘ì´ ìˆìœ¼ë©´ íŒ¨í„´ ë¶„ì„
  - Writing Memory ì—…ë°ì´íŠ¸

- **ì „ì²´ í”¼ë“œë°± ì‹œ (`handleFullFeedback`)**:
  - í”¼ë“œë°± ë¶„ì„ ë° ë¶„ë¥˜
  - ìŠ¤íƒ€ì¼ ê·œì¹™ ì¶”ì¶œ
  - Writing Memory ì—…ë°ì´íŠ¸

### í’ˆì§ˆ ì¶”ì  UI (ì‚¬ì´ë“œ íŒ¨ë„ ì›ê³  íƒ­)

```
[í’ˆì§ˆ í†µê³„]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì§ì ‘ ì±„íƒë¥     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 60%
í‰ê·  ìˆ˜ì •ëŸ‰    â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15%
í•™ìŠµëœ ê·œì¹™    5ê°œ (3ê°œ ê³ ì‹ ë¢°ë„)
ìµœê·¼ ì¶”ì„¸      ğŸ“ˆ ê°œì„  ì¤‘
```

### Supabase ìŠ¤í‚¤ë§ˆ ë³€ê²½

```sql
ALTER TABLE projects ADD COLUMN writing_memory jsonb;
```

### ë°ì´í„° íë¦„

```
1. ì—í”¼ì†Œë“œ ì§‘í•„
   â””â”€ writingMemoryë¥¼ write-episode APIì— ì „ë‹¬
   â””â”€ buildWritingMemoryPrompt() â†’ í”„ë¡¬í”„íŠ¸ì— ì£¼ì…

2. í™˜ë‹˜ í”¼ë“œë°±/í¸ì§‘
   â””â”€ processFeedback() â†’ ìŠ¤íƒ€ì¼ ê·œì¹™ ì¶”ì¶œ
   â””â”€ analyzeEdit() â†’ í¸ì§‘ íŒ¨í„´ ì¶”ì¶œ
   â””â”€ updateWritingMemory() â†’ ìŠ¤í† ì–´ + Supabase ì €ì¥

3. ì—í”¼ì†Œë“œ ì±„íƒ
   â””â”€ updateQualityTracker() â†’ í’ˆì§ˆ ë°ì´í„° ê¸°ë¡
   â””â”€ ì§ì ‘ ì±„íƒ / ìˆ˜ì • í›„ ì±„íƒ êµ¬ë¶„

4. ë‹¤ìŒ í™” ì§‘í•„
   â””â”€ ì—…ë°ì´íŠ¸ëœ Writing Memory ìë™ ë°˜ì˜
   â””â”€ ê³ ì‹ ë¢°ë„ ê·œì¹™ ìš°ì„  ì ìš©
```

### ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `lib/types/index.ts` | WritingMemory ê´€ë ¨ íƒ€ì… ì¶”ê°€ |
| `lib/utils/writing-memory.ts` | ì‹ ê·œ - í•µì‹¬ ìœ í‹¸ë¦¬í‹° |
| `lib/supabase/types.ts` | writing_memory í•„ë“œ ì¶”ê°€ |
| `lib/supabase/db.ts` | writing_memory ì €ì¥/ë¡œë“œ |
| `lib/store/project-store.ts` | WritingMemory ì•¡ì…˜ ì¶”ê°€ |
| `app/api/write-episode/route.ts` | í”„ë¡¬í”„íŠ¸ ì£¼ì… í†µí•© |
| `app/projects/[id]/page.tsx` | handleAdopt, handleFullFeedback ìˆ˜ì • |

### ë¹Œë“œ ì„±ê³µ í™•ì¸ (2026-02-20)
